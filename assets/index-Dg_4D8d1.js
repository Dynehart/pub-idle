var e,t,s,i,n,r,a,o,h,c,l,d,u,p,m,f,g,y,v,b,w,x,k,_,P,S,z,I,M,T,E,A,C,O,R,$,D,N,j,F,G,W,V,Z,B=Object.defineProperty,U=e=>{throw TypeError(e)},K=(e,t,s)=>((e,t,s)=>t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s),H=(e,t,s)=>t.has(e)||U("Cannot "+s),L=(e,t,s)=>(H(e,t,"read from private field"),s?s.call(e):t.get(e)),X=(e,t,s)=>t.has(e)?U("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),Y=(e,t,s,i)=>(H(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),q=(e,t,s)=>(H(e,t,"access private method"),s);import{r as J,g as Q}from"./phaser-BUlrDfUd.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var ee=J();const te=e=>{if("object"==typeof e&&null!==e){if("function"==typeof Object.getPrototypeOf){const t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}return"[object Object]"===Object.prototype.toString.call(e)}return!1},se=(...e)=>e.reduce((e,t)=>{if(void 0===t)return e;if(Array.isArray(t))throw new TypeError("Arguments provided to ts-deepmerge must be objects, not arrays.");return Object.keys(t).forEach(s=>{["__proto__","constructor","prototype"].includes(s)||(Array.isArray(e[s])&&Array.isArray(t[s])?e[s]=se.options.mergeArrays?se.options.uniqueArrayItems?Array.from(new Set(e[s].concat(t[s]))):[...e[s],...t[s]]:t[s]:te(e[s])&&te(t[s])?e[s]=se(e[s],t[s]):!te(e[s])&&te(t[s])?e[s]=se(t[s],void 0):e[s]=void 0===t[s]?se.options.allowUndefinedOverrides?t[s]:e[s]:t[s])}),e},{}),ie={allowUndefinedOverrides:!0,mergeArrays:!0,uniqueArrayItems:!0};se.options=ie,se.withOptions=(e,...t)=>{se.options=Object.assign(Object.assign({},ie),e);const s=se(...t);return se.options=ie,s};class ne extends Error{constructor(){super("function param was incorrectly typed")}}class re extends Error{constructor(e){super(e=void 0!==e?`missing player object in class: ${e}`:"missing player object in class")}}const ae=()=>{const e=new WeakMap;return(t,s,i)=>{const n=i.value;if(!1===((e,t)=>"update"!==t?(console.error(new Error("must be used on update")),!1):"function"==typeof e&&2===e.length)(n,s))throw new Error("you fucked up a decorator dawg");return i.value=function(t,s){const i=e.get(this)??0;t>3e4*i&&(e.set(this,i+1),this.constructor.name),n.call(this,t,s)},i}};function oe(e,t,s){function i(s,i){var n;Object.defineProperty(s,"_zod",{value:s._zod??{},enumerable:!1}),(n=s._zod).traits??(n.traits=new Set),s._zod.traits.add(e),t(s,i);for(const e in a.prototype)e in s||Object.defineProperty(s,e,{value:a.prototype[e].bind(s)});s._zod.constr=a,s._zod.def=i}const n=(null==s?void 0:s.Parent)??Object;class r extends n{}function a(e){var t;const n=(null==s?void 0:s.Parent)?new r:this;i(n,e),(t=n._zod).deferred??(t.deferred=[]);for(const s of n._zod.deferred)s();return n}return Object.defineProperty(r,"name",{value:e}),Object.defineProperty(a,"init",{value:i}),Object.defineProperty(a,Symbol.hasInstance,{value:t=>{var i,n;return!!((null==s?void 0:s.Parent)&&t instanceof s.Parent)||(null==(n=null==(i=null==t?void 0:t._zod)?void 0:i.traits)?void 0:n.has(e))}}),Object.defineProperty(a,"name",{value:e}),a}class he extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class ce extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}const le={};function de(e){return le}function ue(e,t){return"bigint"==typeof t?t.toString():t}function pe(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function me(e){return null==e}function fe(e){const t=e.startsWith("^")?1:0,s=e.endsWith("$")?e.length-1:e.length;return e.slice(t,s)}const ge=Symbol("evaluating");function ye(e,t,s){let i;Object.defineProperty(e,t,{get(){if(i!==ge)return void 0===i&&(i=ge,i=s()),i},set(s){Object.defineProperty(e,t,{value:s})},configurable:!0})}function ve(e,t,s){Object.defineProperty(e,t,{value:s,writable:!0,enumerable:!0,configurable:!0})}function be(...e){const t={};for(const s of e){const e=Object.getOwnPropertyDescriptors(s);Object.assign(t,e)}return Object.defineProperties({},t)}function we(e){return JSON.stringify(e)}const xe="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function ke(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}const _e=pe(()=>{var e;if("undefined"!=typeof navigator&&(null==(e=null==navigator?void 0:navigator.userAgent)?void 0:e.includes("Cloudflare")))return!1;try{return new Function(""),!0}catch(t){return!1}});function Pe(e){if(!1===ke(e))return!1;const t=e.constructor;if(void 0===t)return!0;const s=t.prototype;return!1!==ke(s)&&!1!==Object.prototype.hasOwnProperty.call(s,"isPrototypeOf")}function Se(e){return Pe(e)?{...e}:Array.isArray(e)?[...e]:e}const ze=new Set(["string","number","symbol"]);function Ie(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Me(e,t,s){const i=new e._zod.constr(t??e._zod.def);return t&&!(null==s?void 0:s.parent)||(i._zod.parent=e),i}function Te(e){const t=e;if(!t)return{};if("string"==typeof t)return{error:()=>t};if(void 0!==(null==t?void 0:t.message)){if(void 0!==(null==t?void 0:t.error))throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,"string"==typeof t.error?{...t,error:()=>t.error}:t}const Ee={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Ae(e,t=0){var s;if(!0===e.aborted)return!0;for(let i=t;i<e.issues.length;i++)if(!0!==(null==(s=e.issues[i])?void 0:s.continue))return!0;return!1}function Ce(e,t){return t.map(t=>{var s;return(s=t).path??(s.path=[]),t.path.unshift(e),t})}function Oe(e){return"string"==typeof e?e:null==e?void 0:e.message}function Re(e,t,s){var i,n,r,a,o,h;const c={...e,path:e.path??[]};if(!e.message){const l=Oe(null==(r=null==(n=null==(i=e.inst)?void 0:i._zod.def)?void 0:n.error)?void 0:r.call(n,e))??Oe(null==(a=null==t?void 0:t.error)?void 0:a.call(t,e))??Oe(null==(o=s.customError)?void 0:o.call(s,e))??Oe(null==(h=s.localeError)?void 0:h.call(s,e))??"Invalid input";c.message=l}return delete c.inst,delete c.continue,(null==t?void 0:t.reportInput)||delete c.input,c}function $e(e){return Array.isArray(e)?"array":"string"==typeof e?"string":"unknown"}function De(...e){const[t,s,i]=e;return"string"==typeof t?{message:t,code:"custom",input:s,inst:i}:{...t}}const Ne=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,ue,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},je=oe("$ZodError",Ne),Fe=oe("$ZodError",Ne,{Parent:Error}),Ge=e=>(t,s,i,n)=>{const r=i?Object.assign(i,{async:!1}):{async:!1},a=t._zod.run({value:s,issues:[]},r);if(a instanceof Promise)throw new he;if(a.issues.length){const t=new((null==n?void 0:n.Err)??e)(a.issues.map(e=>Re(e,r,de())));throw xe(t,null==n?void 0:n.callee),t}return a.value},We=e=>async(t,s,i,n)=>{const r=i?Object.assign(i,{async:!0}):{async:!0};let a=t._zod.run({value:s,issues:[]},r);if(a instanceof Promise&&(a=await a),a.issues.length){const t=new((null==n?void 0:n.Err)??e)(a.issues.map(e=>Re(e,r,de())));throw xe(t,null==n?void 0:n.callee),t}return a.value},Ve=e=>(t,s,i)=>{const n=i?{...i,async:!1}:{async:!1},r=t._zod.run({value:s,issues:[]},n);if(r instanceof Promise)throw new he;return r.issues.length?{success:!1,error:new(e??je)(r.issues.map(e=>Re(e,n,de())))}:{success:!0,data:r.value}},Ze=Ve(Fe),Be=e=>async(t,s,i)=>{const n=i?Object.assign(i,{async:!0}):{async:!0};let r=t._zod.run({value:s,issues:[]},n);return r instanceof Promise&&(r=await r),r.issues.length?{success:!1,error:new e(r.issues.map(e=>Re(e,n,de())))}:{success:!0,data:r.value}},Ue=Be(Fe),Ke=e=>(t,s,i)=>{const n=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Ge(e)(t,s,n)},He=e=>(t,s,i)=>Ge(e)(t,s,i),Le=e=>async(t,s,i)=>{const n=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return We(e)(t,s,n)},Xe=e=>async(t,s,i)=>We(e)(t,s,i),Ye=e=>(t,s,i)=>{const n=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Ve(e)(t,s,n)},qe=e=>(t,s,i)=>Ve(e)(t,s,i),Je=e=>async(t,s,i)=>{const n=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Be(e)(t,s,n)},Qe=e=>async(t,s,i)=>Be(e)(t,s,i),et=/^[cC][^\s-]{8,}$/,tt=/^[0-9a-z]+$/,st=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,it=/^[0-9a-vA-V]{20}$/,nt=/^[A-Za-z0-9]{27}$/,rt=/^[a-zA-Z0-9_-]{21}$/,at=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,ot=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,ht=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,ct=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,lt=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,dt=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,ut=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,pt=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,mt=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,ft=/^[A-Za-z0-9_-]*$/,gt=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,yt=/^\+(?:[0-9]){6,14}[0-9]$/,vt="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",bt=new RegExp(`^${vt}$`);function wt(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof e.precision?-1===e.precision?`${t}`:0===e.precision?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}const xt=/^-?\d+$/,kt=/^-?\d+(?:\.\d+)?/,_t=/^(?:true|false)$/i,Pt=/^[^A-Z]*$/,St=/^[^a-z]*$/,zt=oe("$ZodCheck",(e,t)=>{var s;e._zod??(e._zod={}),e._zod.def=t,(s=e._zod).onattach??(s.onattach=[])}),It={number:"number",bigint:"bigint",object:"date"},Mt=oe("$ZodCheckLessThan",(e,t)=>{zt.init(e,t);const s=It[typeof t.value];e._zod.onattach.push(e=>{const s=e._zod.bag,i=(t.inclusive?s.maximum:s.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<i&&(t.inclusive?s.maximum=t.value:s.exclusiveMaximum=t.value)}),e._zod.check=i=>{(t.inclusive?i.value<=t.value:i.value<t.value)||i.issues.push({origin:s,code:"too_big",maximum:t.value,input:i.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Tt=oe("$ZodCheckGreaterThan",(e,t)=>{zt.init(e,t);const s=It[typeof t.value];e._zod.onattach.push(e=>{const s=e._zod.bag,i=(t.inclusive?s.minimum:s.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>i&&(t.inclusive?s.minimum=t.value:s.exclusiveMinimum=t.value)}),e._zod.check=i=>{(t.inclusive?i.value>=t.value:i.value>t.value)||i.issues.push({origin:s,code:"too_small",minimum:t.value,input:i.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Et=oe("$ZodCheckMultipleOf",(e,t)=>{zt.init(e,t),e._zod.onattach.push(e=>{var s;(s=e._zod.bag).multipleOf??(s.multipleOf=t.value)}),e._zod.check=s=>{if(typeof s.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof s.value?s.value%t.value===BigInt(0):0===function(e,t){const s=(e.toString().split(".")[1]||"").length,i=t.toString();let n=(i.split(".")[1]||"").length;if(0===n&&/\d?e-\d?/.test(i)){const e=i.match(/\d?e-(\d?)/);(null==e?void 0:e[1])&&(n=Number.parseInt(e[1]))}const r=s>n?s:n;return Number.parseInt(e.toFixed(r).replace(".",""))%Number.parseInt(t.toFixed(r).replace(".",""))/10**r}(s.value,t.value))||s.issues.push({origin:typeof s.value,code:"not_multiple_of",divisor:t.value,input:s.value,inst:e,continue:!t.abort})}}),At=oe("$ZodCheckNumberFormat",(e,t)=>{var s;zt.init(e,t),t.format=t.format||"float64";const i=null==(s=t.format)?void 0:s.includes("int"),n=i?"int":"number",[r,a]=Ee[t.format];e._zod.onattach.push(e=>{const s=e._zod.bag;s.format=t.format,s.minimum=r,s.maximum=a,i&&(s.pattern=xt)}),e._zod.check=s=>{const o=s.value;if(i){if(!Number.isInteger(o))return void s.issues.push({expected:n,format:t.format,code:"invalid_type",continue:!1,input:o,inst:e});if(!Number.isSafeInteger(o))return void(o>0?s.issues.push({input:o,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort}):s.issues.push({input:o,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort}))}o<r&&s.issues.push({origin:"number",input:o,code:"too_small",minimum:r,inclusive:!0,inst:e,continue:!t.abort}),o>a&&s.issues.push({origin:"number",input:o,code:"too_big",maximum:a,inst:e})}}),Ct=oe("$ZodCheckMaxLength",(e,t)=>{var s;zt.init(e,t),(s=e._zod.def).when??(s.when=e=>{const t=e.value;return!me(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{const s=e._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<s&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=s=>{const i=s.value;if(i.length<=t.maximum)return;const n=$e(i);s.issues.push({origin:n,code:"too_big",maximum:t.maximum,inclusive:!0,input:i,inst:e,continue:!t.abort})}}),Ot=oe("$ZodCheckMinLength",(e,t)=>{var s;zt.init(e,t),(s=e._zod.def).when??(s.when=e=>{const t=e.value;return!me(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{const s=e._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>s&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=s=>{const i=s.value;if(i.length>=t.minimum)return;const n=$e(i);s.issues.push({origin:n,code:"too_small",minimum:t.minimum,inclusive:!0,input:i,inst:e,continue:!t.abort})}}),Rt=oe("$ZodCheckLengthEquals",(e,t)=>{var s;zt.init(e,t),(s=e._zod.def).when??(s.when=e=>{const t=e.value;return!me(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{const s=e._zod.bag;s.minimum=t.length,s.maximum=t.length,s.length=t.length}),e._zod.check=s=>{const i=s.value,n=i.length;if(n===t.length)return;const r=$e(i),a=n>t.length;s.issues.push({origin:r,...a?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:s.value,inst:e,continue:!t.abort})}}),$t=oe("$ZodCheckStringFormat",(e,t)=>{var s,i;zt.init(e,t),e._zod.onattach.push(e=>{const s=e._zod.bag;s.format=t.format,t.pattern&&(s.patterns??(s.patterns=new Set),s.patterns.add(t.pattern))}),t.pattern?(s=e._zod).check??(s.check=s=>{t.pattern.lastIndex=0,t.pattern.test(s.value)||s.issues.push({origin:"string",code:"invalid_format",format:t.format,input:s.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(i=e._zod).check??(i.check=()=>{})}),Dt=oe("$ZodCheckRegex",(e,t)=>{$t.init(e,t),e._zod.check=s=>{t.pattern.lastIndex=0,t.pattern.test(s.value)||s.issues.push({origin:"string",code:"invalid_format",format:"regex",input:s.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),Nt=oe("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=Pt),$t.init(e,t)}),jt=oe("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=St),$t.init(e,t)}),Ft=oe("$ZodCheckIncludes",(e,t)=>{zt.init(e,t);const s=Ie(t.includes),i=new RegExp("number"==typeof t.position?`^.{${t.position}}${s}`:s);t.pattern=i,e._zod.onattach.push(e=>{const t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(i)}),e._zod.check=s=>{s.value.includes(t.includes,t.position)||s.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:s.value,inst:e,continue:!t.abort})}}),Gt=oe("$ZodCheckStartsWith",(e,t)=>{zt.init(e,t);const s=new RegExp(`^${Ie(t.prefix)}.*`);t.pattern??(t.pattern=s),e._zod.onattach.push(e=>{const t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(s)}),e._zod.check=s=>{s.value.startsWith(t.prefix)||s.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:s.value,inst:e,continue:!t.abort})}}),Wt=oe("$ZodCheckEndsWith",(e,t)=>{zt.init(e,t);const s=new RegExp(`.*${Ie(t.suffix)}$`);t.pattern??(t.pattern=s),e._zod.onattach.push(e=>{const t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(s)}),e._zod.check=s=>{s.value.endsWith(t.suffix)||s.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:s.value,inst:e,continue:!t.abort})}}),Vt=oe("$ZodCheckOverwrite",(e,t)=>{zt.init(e,t),e._zod.check=e=>{e.value=t.tx(e.value)}});class Zt{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if("function"==typeof e)return e(this,{execution:"sync"}),void e(this,{execution:"async"});const t=e.split("\n").filter(e=>e),s=Math.min(...t.map(e=>e.length-e.trimStart().length)),i=t.map(e=>e.slice(s)).map(e=>" ".repeat(2*this.indent)+e);for(const n of i)this.content.push(n)}compile(){return new Function(...null==this?void 0:this.args,[...((null==this?void 0:this.content)??[""]).map(e=>`  ${e}`)].join("\n"))}}const Bt={major:4,minor:1,patch:11},Ut=oe("$ZodType",(e,t)=>{var s,i;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Bt;const n=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&n.unshift(e);for(const r of n)for(const t of r._zod.onattach)t(e);if(0===n.length)(i=e._zod).deferred??(i.deferred=[]),null==(s=e._zod.deferred)||s.push(()=>{e._zod.run=e._zod.parse});else{const t=(e,t,s)=>{let i,n=Ae(e);for(const r of t){if(r._zod.def.when){if(!r._zod.def.when(e))continue}else if(n)continue;const t=e.issues.length,a=r._zod.check(e);if(a instanceof Promise&&!1===(null==s?void 0:s.async))throw new he;if(i||a instanceof Promise)i=(i??Promise.resolve()).then(async()=>{await a,e.issues.length!==t&&(n||(n=Ae(e,t)))});else{if(e.issues.length===t)continue;n||(n=Ae(e,t))}}return i?i.then(()=>e):e},s=(s,i,r)=>{if(Ae(s))return s.aborted=!0,s;const a=t(i,n,r);if(a instanceof Promise){if(!1===r.async)throw new he;return a.then(t=>e._zod.parse(t,r))}return e._zod.parse(a,r)};e._zod.run=(i,r)=>{if(r.skipChecks)return e._zod.parse(i,r);if("backward"===r.direction){const t=e._zod.parse({value:i.value,issues:[]},{...r,skipChecks:!0});return t instanceof Promise?t.then(e=>s(e,i,r)):s(t,i,r)}const a=e._zod.parse(i,r);if(a instanceof Promise){if(!1===r.async)throw new he;return a.then(e=>t(e,n,r))}return t(a,n,r)}}e["~standard"]={validate:t=>{var s;try{const i=Ze(e,t);return i.success?{value:i.data}:{issues:null==(s=i.error)?void 0:s.issues}}catch(i){return Ue(e,t).then(e=>{var t;return e.success?{value:e.data}:{issues:null==(t=e.error)?void 0:t.issues}})}},vendor:"zod",version:1}}),Kt=oe("$ZodString",(e,t)=>{var s;Ut.init(e,t),e._zod.pattern=[...(null==(s=null==e?void 0:e._zod.bag)?void 0:s.patterns)??[]].pop()??(e=>{const t=e?`[\\s\\S]{${(null==e?void 0:e.minimum)??0},${(null==e?void 0:e.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)})(e._zod.bag),e._zod.parse=(s,i)=>{if(t.coerce)try{s.value=String(s.value)}catch(n){}return"string"==typeof s.value||s.issues.push({expected:"string",code:"invalid_type",input:s.value,inst:e}),s}}),Ht=oe("$ZodStringFormat",(e,t)=>{$t.init(e,t),Kt.init(e,t)}),Lt=oe("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=ot),Ht.init(e,t)}),Xt=oe("$ZodUUID",(e,t)=>{if(t.version){const e={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(void 0===e)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=ht(e))}else t.pattern??(t.pattern=ht());Ht.init(e,t)}),Yt=oe("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=ct),Ht.init(e,t)}),qt=oe("$ZodURL",(e,t)=>{Ht.init(e,t),e._zod.check=s=>{try{const i=s.value.trim(),n=new URL(i);return t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(n.hostname)||s.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:gt.source,input:s.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(n.protocol.endsWith(":")?n.protocol.slice(0,-1):n.protocol)||s.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:s.value,inst:e,continue:!t.abort})),void(t.normalize?s.value=n.href:s.value=i)}catch(i){s.issues.push({code:"invalid_format",format:"url",input:s.value,inst:e,continue:!t.abort})}}}),Jt=oe("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Ht.init(e,t)}),Qt=oe("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=rt),Ht.init(e,t)}),es=oe("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=et),Ht.init(e,t)}),ts=oe("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=tt),Ht.init(e,t)}),ss=oe("$ZodULID",(e,t)=>{t.pattern??(t.pattern=st),Ht.init(e,t)}),is=oe("$ZodXID",(e,t)=>{t.pattern??(t.pattern=it),Ht.init(e,t)}),ns=oe("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=nt),Ht.init(e,t)}),rs=oe("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=function(e){const t=wt({precision:e.precision}),s=["Z"];e.local&&s.push(""),e.offset&&s.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const i=`${t}(?:${s.join("|")})`;return new RegExp(`^${vt}T(?:${i})$`)}(t)),Ht.init(e,t)}),as=oe("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=bt),Ht.init(e,t)}),os=oe("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=new RegExp(`^${wt(t)}$`)),Ht.init(e,t)}),hs=oe("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=at),Ht.init(e,t)}),cs=oe("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=lt),Ht.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.format="ipv4"})}),ls=oe("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=dt),Ht.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.format="ipv6"}),e._zod.check=s=>{try{new URL(`http://[${s.value}]`)}catch{s.issues.push({code:"invalid_format",format:"ipv6",input:s.value,inst:e,continue:!t.abort})}}}),ds=oe("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=ut),Ht.init(e,t)}),us=oe("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=pt),Ht.init(e,t),e._zod.check=s=>{const i=s.value.split("/");try{if(2!==i.length)throw new Error;const[e,t]=i;if(!t)throw new Error;const s=Number(t);if(`${s}`!==t)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${e}]`)}catch{s.issues.push({code:"invalid_format",format:"cidrv6",input:s.value,inst:e,continue:!t.abort})}}});function ps(e){if(""===e)return!0;if(e.length%4!=0)return!1;try{return atob(e),!0}catch{return!1}}const ms=oe("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=mt),Ht.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.contentEncoding="base64"}),e._zod.check=s=>{ps(s.value)||s.issues.push({code:"invalid_format",format:"base64",input:s.value,inst:e,continue:!t.abort})}}),fs=oe("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=ft),Ht.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.contentEncoding="base64url"}),e._zod.check=s=>{(function(e){if(!ft.test(e))return!1;const t=e.replace(/[-_]/g,e=>"-"===e?"+":"/");return ps(t.padEnd(4*Math.ceil(t.length/4),"="))})(s.value)||s.issues.push({code:"invalid_format",format:"base64url",input:s.value,inst:e,continue:!t.abort})}}),gs=oe("$ZodE164",(e,t)=>{t.pattern??(t.pattern=yt),Ht.init(e,t)}),ys=oe("$ZodJWT",(e,t)=>{Ht.init(e,t),e._zod.check=s=>{(function(e,t=null){try{const s=e.split(".");if(3!==s.length)return!1;const[i]=s;if(!i)return!1;const n=JSON.parse(atob(i));return!("typ"in n&&"JWT"!==(null==n?void 0:n.typ)||!n.alg||t&&(!("alg"in n)||n.alg!==t))}catch{return!1}})(s.value,t.alg)||s.issues.push({code:"invalid_format",format:"jwt",input:s.value,inst:e,continue:!t.abort})}}),vs=oe("$ZodNumber",(e,t)=>{Ut.init(e,t),e._zod.pattern=e._zod.bag.pattern??kt,e._zod.parse=(s,i)=>{if(t.coerce)try{s.value=Number(s.value)}catch(a){}const n=s.value;if("number"==typeof n&&!Number.isNaN(n)&&Number.isFinite(n))return s;const r="number"==typeof n?Number.isNaN(n)?"NaN":Number.isFinite(n)?void 0:"Infinity":void 0;return s.issues.push({expected:"number",code:"invalid_type",input:n,inst:e,...r?{received:r}:{}}),s}}),bs=oe("$ZodNumber",(e,t)=>{At.init(e,t),vs.init(e,t)}),ws=oe("$ZodBoolean",(e,t)=>{Ut.init(e,t),e._zod.pattern=_t,e._zod.parse=(s,i)=>{if(t.coerce)try{s.value=Boolean(s.value)}catch(r){}const n=s.value;return"boolean"==typeof n||s.issues.push({expected:"boolean",code:"invalid_type",input:n,inst:e}),s}}),xs=oe("$ZodUnknown",(e,t)=>{Ut.init(e,t),e._zod.parse=e=>e}),ks=oe("$ZodNever",(e,t)=>{Ut.init(e,t),e._zod.parse=(t,s)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:e}),t)});function _s(e,t,s){e.issues.length&&t.issues.push(...Ce(s,e.issues)),t.value[s]=e.value}const Ps=oe("$ZodArray",(e,t)=>{Ut.init(e,t),e._zod.parse=(s,i)=>{const n=s.value;if(!Array.isArray(n))return s.issues.push({expected:"array",code:"invalid_type",input:n,inst:e}),s;s.value=Array(n.length);const r=[];for(let e=0;e<n.length;e++){const a=n[e],o=t.element._zod.run({value:a,issues:[]},i);o instanceof Promise?r.push(o.then(t=>_s(t,s,e))):_s(o,s,e)}return r.length?Promise.all(r).then(()=>s):s}});function Ss(e,t,s,i){e.issues.length&&t.issues.push(...Ce(s,e.issues)),void 0===e.value?s in i&&(t.value[s]=void 0):t.value[s]=e.value}function zs(e){var t,s,i,n;const r=Object.keys(e.shape);for(const h of r)if(!(null==(n=null==(i=null==(s=null==(t=e.shape)?void 0:t[h])?void 0:s._zod)?void 0:i.traits)?void 0:n.has("$ZodType")))throw new Error(`Invalid element at key "${h}": expected a Zod schema`);const a=(o=e.shape,Object.keys(o).filter(e=>"optional"===o[e]._zod.optin&&"optional"===o[e]._zod.optout));var o;return{...e,keys:r,keySet:new Set(r),numKeys:r.length,optionalKeys:new Set(a)}}function Is(e,t,s,i,n,r){const a=[],o=n.keySet,h=n.catchall._zod,c=h.def.type;for(const l of Object.keys(t)){if(o.has(l))continue;if("never"===c){a.push(l);continue}const n=h.run({value:t[l],issues:[]},i);n instanceof Promise?e.push(n.then(e=>Ss(e,s,l,t))):Ss(n,s,l,t)}return a.length&&s.issues.push({code:"unrecognized_keys",keys:a,input:t,inst:r}),e.length?Promise.all(e).then(()=>s):s}const Ms=oe("$ZodObject",(e,t)=>{Ut.init(e,t);const s=Object.getOwnPropertyDescriptor(t,"shape");if(!(null==s?void 0:s.get)){const e=t.shape;Object.defineProperty(t,"shape",{get:()=>{const s={...e};return Object.defineProperty(t,"shape",{value:s}),s}})}const i=pe(()=>zs(t));ye(e._zod,"propValues",()=>{const e=t.shape,s={};for(const t in e){const i=e[t]._zod;if(i.values){s[t]??(s[t]=new Set);for(const e of i.values)s[t].add(e)}}return s});const n=ke,r=t.catchall;let a;e._zod.parse=(t,s)=>{a??(a=i.value);const o=t.value;if(!n(o))return t.issues.push({expected:"object",code:"invalid_type",input:o,inst:e}),t;t.value={};const h=[],c=a.shape;for(const e of a.keys){const i=c[e]._zod.run({value:o[e],issues:[]},s);i instanceof Promise?h.push(i.then(s=>Ss(s,t,e,o))):Ss(i,t,e,o)}return r?Is(h,o,t,s,i.value,e):h.length?Promise.all(h).then(()=>t):t}}),Ts=oe("$ZodObjectJIT",(e,t)=>{Ms.init(e,t);const s=e._zod.parse,i=pe(()=>zs(t));let n;const r=ke,a=!le.jitless,o=a&&_e.value,h=t.catchall;let c;e._zod.parse=(l,d)=>{c??(c=i.value);const u=l.value;return r(u)?a&&o&&!1===(null==d?void 0:d.async)&&!0!==d.jitless?(n||(n=(e=>{const t=new Zt(["shape","payload","ctx"]),s=i.value,n=e=>{const t=we(e);return`shape[${t}]._zod.run({ value: input[${t}], issues: [] }, ctx)`};t.write("const input = payload.value;");const r=Object.create(null);let a=0;for(const i of s.keys)r[i]="key_"+a++;t.write("const newResult = {};");for(const i of s.keys){const e=r[i],s=we(i);t.write(`const ${e} = ${n(i)};`),t.write(`\n        if (${e}.issues.length) {\n          payload.issues = payload.issues.concat(${e}.issues.map(iss => ({\n            ...iss,\n            path: iss.path ? [${s}, ...iss.path] : [${s}]\n          })));\n        }\n        \n        \n        if (${e}.value === undefined) {\n          if (${s} in input) {\n            newResult[${s}] = undefined;\n          }\n        } else {\n          newResult[${s}] = ${e}.value;\n        }\n        \n      `)}t.write("payload.value = newResult;"),t.write("return payload;");const o=t.compile();return(t,s)=>o(e,t,s)})(t.shape)),l=n(l,d),h?Is([],u,l,d,c,e):l):s(l,d):(l.issues.push({expected:"object",code:"invalid_type",input:u,inst:e}),l)}});function Es(e,t,s,i){for(const r of e)if(0===r.issues.length)return t.value=r.value,t;const n=e.filter(e=>!Ae(e));return 1===n.length?(t.value=n[0].value,n[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:s,errors:e.map(e=>e.issues.map(e=>Re(e,i,de())))}),t)}const As=oe("$ZodUnion",(e,t)=>{Ut.init(e,t),ye(e._zod,"optin",()=>t.options.some(e=>"optional"===e._zod.optin)?"optional":void 0),ye(e._zod,"optout",()=>t.options.some(e=>"optional"===e._zod.optout)?"optional":void 0),ye(e._zod,"values",()=>{if(t.options.every(e=>e._zod.values))return new Set(t.options.flatMap(e=>Array.from(e._zod.values)))}),ye(e._zod,"pattern",()=>{if(t.options.every(e=>e._zod.pattern)){const e=t.options.map(e=>e._zod.pattern);return new RegExp(`^(${e.map(e=>fe(e.source)).join("|")})$`)}});const s=1===t.options.length,i=t.options[0]._zod.run;e._zod.parse=(n,r)=>{if(s)return i(n,r);let a=!1;const o=[];for(const e of t.options){const t=e._zod.run({value:n.value,issues:[]},r);if(t instanceof Promise)o.push(t),a=!0;else{if(0===t.issues.length)return t;o.push(t)}}return a?Promise.all(o).then(t=>Es(t,n,e,r)):Es(o,n,e,r)}}),Cs=oe("$ZodIntersection",(e,t)=>{Ut.init(e,t),e._zod.parse=(e,s)=>{const i=e.value,n=t.left._zod.run({value:i,issues:[]},s),r=t.right._zod.run({value:i,issues:[]},s);return n instanceof Promise||r instanceof Promise?Promise.all([n,r]).then(([t,s])=>Rs(e,t,s)):Rs(e,n,r)}});function Os(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e===+t)return{valid:!0,data:e};if(Pe(e)&&Pe(t)){const s=Object.keys(t),i=Object.keys(e).filter(e=>-1!==s.indexOf(e)),n={...e,...t};for(const r of i){const s=Os(e[r],t[r]);if(!s.valid)return{valid:!1,mergeErrorPath:[r,...s.mergeErrorPath]};n[r]=s.data}return{valid:!0,data:n}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const s=[];for(let i=0;i<e.length;i++){const n=Os(e[i],t[i]);if(!n.valid)return{valid:!1,mergeErrorPath:[i,...n.mergeErrorPath]};s.push(n.data)}return{valid:!0,data:s}}return{valid:!1,mergeErrorPath:[]}}function Rs(e,t,s){if(t.issues.length&&e.issues.push(...t.issues),s.issues.length&&e.issues.push(...s.issues),Ae(e))return e;const i=Os(t.value,s.value);if(!i.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(i.mergeErrorPath)}`);return e.value=i.data,e}const $s=oe("$ZodRecord",(e,t)=>{Ut.init(e,t),e._zod.parse=(s,i)=>{const n=s.value;if(!Pe(n))return s.issues.push({expected:"record",code:"invalid_type",input:n,inst:e}),s;const r=[];if(t.keyType._zod.values){const a=t.keyType._zod.values;s.value={};for(const e of a)if("string"==typeof e||"number"==typeof e||"symbol"==typeof e){const a=t.valueType._zod.run({value:n[e],issues:[]},i);a instanceof Promise?r.push(a.then(t=>{t.issues.length&&s.issues.push(...Ce(e,t.issues)),s.value[e]=t.value})):(a.issues.length&&s.issues.push(...Ce(e,a.issues)),s.value[e]=a.value)}let o;for(const e in n)a.has(e)||(o=o??[],o.push(e));o&&o.length>0&&s.issues.push({code:"unrecognized_keys",input:n,inst:e,keys:o})}else{s.value={};for(const a of Reflect.ownKeys(n)){if("__proto__"===a)continue;const o=t.keyType._zod.run({value:a,issues:[]},i);if(o instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(o.issues.length){s.issues.push({code:"invalid_key",origin:"record",issues:o.issues.map(e=>Re(e,i,de())),input:a,path:[a],inst:e}),s.value[o.value]=o.value;continue}const h=t.valueType._zod.run({value:n[a],issues:[]},i);h instanceof Promise?r.push(h.then(e=>{e.issues.length&&s.issues.push(...Ce(a,e.issues)),s.value[o.value]=e.value})):(h.issues.length&&s.issues.push(...Ce(a,h.issues)),s.value[o.value]=h.value)}}return r.length?Promise.all(r).then(()=>s):s}}),Ds=oe("$ZodEnum",(e,t)=>{Ut.init(e,t);const s=function(e){const t=Object.values(e).filter(e=>"number"==typeof e);return Object.entries(e).filter(([e,s])=>-1===t.indexOf(+e)).map(([e,t])=>t)}(t.entries),i=new Set(s);e._zod.values=i,e._zod.pattern=new RegExp(`^(${s.filter(e=>ze.has(typeof e)).map(e=>"string"==typeof e?Ie(e):e.toString()).join("|")})$`),e._zod.parse=(t,n)=>{const r=t.value;return i.has(r)||t.issues.push({code:"invalid_value",values:s,input:r,inst:e}),t}}),Ns=oe("$ZodTransform",(e,t)=>{Ut.init(e,t),e._zod.parse=(s,i)=>{if("backward"===i.direction)throw new ce(e.constructor.name);const n=t.transform(s.value,s);if(i.async)return(n instanceof Promise?n:Promise.resolve(n)).then(e=>(s.value=e,s));if(n instanceof Promise)throw new he;return s.value=n,s}});function js(e,t){return e.issues.length&&void 0===t?{issues:[],value:void 0}:e}const Fs=oe("$ZodOptional",(e,t)=>{Ut.init(e,t),e._zod.optin="optional",e._zod.optout="optional",ye(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),ye(e._zod,"pattern",()=>{const e=t.innerType._zod.pattern;return e?new RegExp(`^(${fe(e.source)})?$`):void 0}),e._zod.parse=(e,s)=>{if("optional"===t.innerType._zod.optin){const i=t.innerType._zod.run(e,s);return i instanceof Promise?i.then(t=>js(t,e.value)):js(i,e.value)}return void 0===e.value?e:t.innerType._zod.run(e,s)}}),Gs=oe("$ZodNullable",(e,t)=>{Ut.init(e,t),ye(e._zod,"optin",()=>t.innerType._zod.optin),ye(e._zod,"optout",()=>t.innerType._zod.optout),ye(e._zod,"pattern",()=>{const e=t.innerType._zod.pattern;return e?new RegExp(`^(${fe(e.source)}|null)$`):void 0}),ye(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(e,s)=>null===e.value?e:t.innerType._zod.run(e,s)}),Ws=oe("$ZodDefault",(e,t)=>{Ut.init(e,t),e._zod.optin="optional",ye(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,s)=>{if("backward"===s.direction)return t.innerType._zod.run(e,s);if(void 0===e.value)return e.value=t.defaultValue,e;const i=t.innerType._zod.run(e,s);return i instanceof Promise?i.then(e=>Vs(e,t)):Vs(i,t)}});function Vs(e,t){return void 0===e.value&&(e.value=t.defaultValue),e}const Zs=oe("$ZodPrefault",(e,t)=>{Ut.init(e,t),e._zod.optin="optional",ye(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,s)=>("backward"===s.direction||void 0===e.value&&(e.value=t.defaultValue),t.innerType._zod.run(e,s))}),Bs=oe("$ZodNonOptional",(e,t)=>{Ut.init(e,t),ye(e._zod,"values",()=>{const e=t.innerType._zod.values;return e?new Set([...e].filter(e=>void 0!==e)):void 0}),e._zod.parse=(s,i)=>{const n=t.innerType._zod.run(s,i);return n instanceof Promise?n.then(t=>Us(t,e)):Us(n,e)}});function Us(e,t){return e.issues.length||void 0!==e.value||e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const Ks=oe("$ZodCatch",(e,t)=>{Ut.init(e,t),ye(e._zod,"optin",()=>t.innerType._zod.optin),ye(e._zod,"optout",()=>t.innerType._zod.optout),ye(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,s)=>{if("backward"===s.direction)return t.innerType._zod.run(e,s);const i=t.innerType._zod.run(e,s);return i instanceof Promise?i.then(i=>(e.value=i.value,i.issues.length&&(e.value=t.catchValue({...e,error:{issues:i.issues.map(e=>Re(e,s,de()))},input:e.value}),e.issues=[]),e)):(e.value=i.value,i.issues.length&&(e.value=t.catchValue({...e,error:{issues:i.issues.map(e=>Re(e,s,de()))},input:e.value}),e.issues=[]),e)}}),Hs=oe("$ZodPipe",(e,t)=>{Ut.init(e,t),ye(e._zod,"values",()=>t.in._zod.values),ye(e._zod,"optin",()=>t.in._zod.optin),ye(e._zod,"optout",()=>t.out._zod.optout),ye(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(e,s)=>{if("backward"===s.direction){const i=t.out._zod.run(e,s);return i instanceof Promise?i.then(e=>Ls(e,t.in,s)):Ls(i,t.in,s)}const i=t.in._zod.run(e,s);return i instanceof Promise?i.then(e=>Ls(e,t.out,s)):Ls(i,t.out,s)}});function Ls(e,t,s){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},s)}const Xs=oe("$ZodReadonly",(e,t)=>{Ut.init(e,t),ye(e._zod,"propValues",()=>t.innerType._zod.propValues),ye(e._zod,"values",()=>t.innerType._zod.values),ye(e._zod,"optin",()=>t.innerType._zod.optin),ye(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(e,s)=>{if("backward"===s.direction)return t.innerType._zod.run(e,s);const i=t.innerType._zod.run(e,s);return i instanceof Promise?i.then(Ys):Ys(i)}});function Ys(e){return e.value=Object.freeze(e.value),e}const qs=oe("$ZodCustom",(e,t)=>{zt.init(e,t),Ut.init(e,t),e._zod.parse=(e,t)=>e,e._zod.check=s=>{const i=s.value,n=t.fn(i);if(n instanceof Promise)return n.then(t=>Js(t,s,i,e));Js(n,s,i,e)}});function Js(e,t,s,i){if(!e){const e={code:"custom",input:s,inst:i,path:[...i._zod.def.path??[]],continue:!i._zod.def.abort};i._zod.def.params&&(e.params=i._zod.def.params),t.issues.push(De(e))}}class Qs{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...t){const s=t[0];if(this._map.set(e,s),s&&"object"==typeof s&&"id"in s){if(this._idmap.has(s.id))throw new Error(`ID ${s.id} already exists in the registry`);this._idmap.set(s.id,e)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){const t=this._map.get(e);return t&&"object"==typeof t&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){const t=e._zod.parent;if(t){const s={...this.get(t)??{}};delete s.id;const i={...s,...this._map.get(e)};return Object.keys(i).length?i:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function ei(){return new Qs}const ti=ei();function si(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...Te(t)})}function ii(e,t){return new Mt({check:"less_than",...Te(t),value:e,inclusive:!1})}function ni(e,t){return new Mt({check:"less_than",...Te(t),value:e,inclusive:!0})}function ri(e,t){return new Tt({check:"greater_than",...Te(t),value:e,inclusive:!1})}function ai(e,t){return new Tt({check:"greater_than",...Te(t),value:e,inclusive:!0})}function oi(e,t){return new Et({check:"multiple_of",...Te(t),value:e})}function hi(e,t){return new Ct({check:"max_length",...Te(t),maximum:e})}function ci(e,t){return new Ot({check:"min_length",...Te(t),minimum:e})}function li(e,t){return new Rt({check:"length_equals",...Te(t),length:e})}function di(e){return new Vt({check:"overwrite",tx:e})}const ui=oe("ZodISODateTime",(e,t)=>{rs.init(e,t),Oi.init(e,t)});const pi=oe("ZodISODate",(e,t)=>{as.init(e,t),Oi.init(e,t)});const mi=oe("ZodISOTime",(e,t)=>{os.init(e,t),Oi.init(e,t)});const fi=oe("ZodISODuration",(e,t)=>{hs.init(e,t),Oi.init(e,t)});const gi=oe("ZodError",(e,t)=>{je.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:t=>function(e,t){const s=t||function(e){return e.message},i={_errors:[]},n=e=>{for(const t of e.issues)if("invalid_union"===t.code&&t.errors.length)t.errors.map(e=>n({issues:e}));else if("invalid_key"===t.code)n({issues:t.issues});else if("invalid_element"===t.code)n({issues:t.issues});else if(0===t.path.length)i._errors.push(s(t));else{let e=i,n=0;for(;n<t.path.length;){const i=t.path[n];n===t.path.length-1?(e[i]=e[i]||{_errors:[]},e[i]._errors.push(s(t))):e[i]=e[i]||{_errors:[]},e=e[i],n++}}};return n(e),i}(e,t)},flatten:{value:t=>function(e,t=e=>e.message){const s={},i=[];for(const n of e.issues)n.path.length>0?(s[n.path[0]]=s[n.path[0]]||[],s[n.path[0]].push(t(n))):i.push(t(n));return{formErrors:i,fieldErrors:s}}(e,t)},addIssue:{value:t=>{e.issues.push(t),e.message=JSON.stringify(e.issues,ue,2)}},addIssues:{value:t=>{e.issues.push(...t),e.message=JSON.stringify(e.issues,ue,2)}},isEmpty:{get:()=>0===e.issues.length}})},{Parent:Error}),yi=Ge(gi),vi=We(gi),bi=Ve(gi),wi=Be(gi),xi=Ke(gi),ki=He(gi),_i=Le(gi),Pi=Xe(gi),Si=Ye(gi),zi=qe(gi),Ii=Je(gi),Mi=Qe(gi),Ti=oe("ZodType",(e,t)=>(Ut.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...s)=>e.clone(be(t,{checks:[...t.checks??[],...s.map(e=>"function"==typeof e?{_zod:{check:e,def:{check:"custom"},onattach:[]}}:e)]})),e.clone=(t,s)=>Me(e,t,s),e.brand=()=>e,e.register=(t,s)=>(t.add(e,s),e),e.parse=(t,s)=>yi(e,t,s,{callee:e.parse}),e.safeParse=(t,s)=>bi(e,t,s),e.parseAsync=async(t,s)=>vi(e,t,s,{callee:e.parseAsync}),e.safeParseAsync=async(t,s)=>wi(e,t,s),e.spa=e.safeParseAsync,e.encode=(t,s)=>xi(e,t,s),e.decode=(t,s)=>ki(e,t,s),e.encodeAsync=async(t,s)=>_i(e,t,s),e.decodeAsync=async(t,s)=>Pi(e,t,s),e.safeEncode=(t,s)=>Si(e,t,s),e.safeDecode=(t,s)=>zi(e,t,s),e.safeEncodeAsync=async(t,s)=>Ii(e,t,s),e.safeDecodeAsync=async(t,s)=>Mi(e,t,s),e.refine=(t,s)=>e.check(function(e,t={}){return function(e,t,s){return new An({type:"custom",check:"custom",fn:t,...Te(s)})}(0,e,t)}(t,s)),e.superRefine=t=>e.check(function(e){const t=function(e){const t=new zt({check:"custom",...Te(void 0)});return t._zod.check=e,t}(s=>(s.addIssue=e=>{if("string"==typeof e)s.issues.push(De(e,s.value,t._zod.def));else{const i=e;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=s.value),i.inst??(i.inst=t),i.continue??(i.continue=!t._zod.def.abort),s.issues.push(De(i))}},e(s.value,s)));return t}(t)),e.overwrite=t=>e.check(di(t)),e.optional=()=>xn(e),e.nullable=()=>_n(e),e.nullish=()=>xn(_n(e)),e.nonoptional=t=>function(e,t){return new zn({type:"nonoptional",innerType:e,...Te(t)})}(e,t),e.array=()=>dn(e),e.or=t=>new mn({type:"union",options:[e,t],...Te(undefined)}),e.and=t=>new fn({type:"intersection",left:e,right:t}),e.transform=t=>Tn(e,new bn({type:"transform",transform:t})),e.default=t=>{return s=t,new Pn({type:"default",innerType:e,get defaultValue(){return"function"==typeof s?s():Se(s)}});var s},e.prefault=t=>{return s=t,new Sn({type:"prefault",innerType:e,get defaultValue(){return"function"==typeof s?s():Se(s)}});var s},e.catch=t=>{return new In({type:"catch",innerType:e,catchValue:"function"==typeof(s=t)?s:()=>s});var s},e.pipe=t=>Tn(e,t),e.readonly=()=>new En({type:"readonly",innerType:e}),e.describe=t=>{const s=e.clone();return ti.add(s,{description:t}),s},Object.defineProperty(e,"description",{get(){var t;return null==(t=ti.get(e))?void 0:t.description},configurable:!0}),e.meta=(...t)=>{if(0===t.length)return ti.get(e);const s=e.clone();return ti.add(s,t[0]),s},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),Ei=oe("_ZodString",(e,t)=>{Kt.init(e,t),Ti.init(e,t);const s=e._zod.bag;e.format=s.format??null,e.minLength=s.minimum??null,e.maxLength=s.maximum??null,e.regex=(...t)=>e.check(function(e,t){return new Dt({check:"string_format",format:"regex",...Te(t),pattern:e})}(...t)),e.includes=(...t)=>e.check(function(e,t){return new Ft({check:"string_format",format:"includes",...Te(t),includes:e})}(...t)),e.startsWith=(...t)=>e.check(function(e,t){return new Gt({check:"string_format",format:"starts_with",...Te(t),prefix:e})}(...t)),e.endsWith=(...t)=>e.check(function(e,t){return new Wt({check:"string_format",format:"ends_with",...Te(t),suffix:e})}(...t)),e.min=(...t)=>e.check(ci(...t)),e.max=(...t)=>e.check(hi(...t)),e.length=(...t)=>e.check(li(...t)),e.nonempty=(...t)=>e.check(ci(1,...t)),e.lowercase=t=>e.check(function(e){return new Nt({check:"string_format",format:"lowercase",...Te(e)})}(t)),e.uppercase=t=>e.check(function(e){return new jt({check:"string_format",format:"uppercase",...Te(e)})}(t)),e.trim=()=>e.check(di(e=>e.trim())),e.normalize=(...t)=>e.check(function(e){return di(t=>t.normalize(e))}(...t)),e.toLowerCase=()=>e.check(di(e=>e.toLowerCase())),e.toUpperCase=()=>e.check(di(e=>e.toUpperCase()))}),Ai=oe("ZodString",(e,t)=>{Kt.init(e,t),Ei.init(e,t),e.email=t=>e.check(function(e,t){return new Ri({type:"string",format:"email",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.url=t=>e.check(function(e,t){return new Ni({type:"string",format:"url",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.jwt=t=>e.check(function(e,t){return new Ji({type:"string",format:"jwt",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.emoji=t=>e.check(function(e,t){return new ji({type:"string",format:"emoji",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.guid=t=>e.check(si($i,t)),e.uuid=t=>e.check(function(e,t){return new Di({type:"string",format:"uuid",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.uuidv4=t=>e.check(function(e,t){return new Di({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...Te(t)})}(0,t)),e.uuidv6=t=>e.check(function(e,t){return new Di({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...Te(t)})}(0,t)),e.uuidv7=t=>e.check(function(e,t){return new Di({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...Te(t)})}(0,t)),e.nanoid=t=>e.check(function(e,t){return new Fi({type:"string",format:"nanoid",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.guid=t=>e.check(si($i,t)),e.cuid=t=>e.check(function(e,t){return new Gi({type:"string",format:"cuid",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.cuid2=t=>e.check(function(e,t){return new Wi({type:"string",format:"cuid2",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.ulid=t=>e.check(function(e,t){return new Vi({type:"string",format:"ulid",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.base64=t=>e.check(function(e,t){return new Xi({type:"string",format:"base64",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.base64url=t=>e.check(function(e,t){return new Yi({type:"string",format:"base64url",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.xid=t=>e.check(function(e,t){return new Zi({type:"string",format:"xid",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.ksuid=t=>e.check(function(e,t){return new Bi({type:"string",format:"ksuid",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.ipv4=t=>e.check(function(e,t){return new Ui({type:"string",format:"ipv4",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.ipv6=t=>e.check(function(e,t){return new Ki({type:"string",format:"ipv6",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.cidrv4=t=>e.check(function(e,t){return new Hi({type:"string",format:"cidrv4",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.cidrv6=t=>e.check(function(e,t){return new Li({type:"string",format:"cidrv6",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.e164=t=>e.check(function(e,t){return new qi({type:"string",format:"e164",check:"string_format",abort:!1,...Te(t)})}(0,t)),e.datetime=t=>e.check(function(e){return function(e,t){return new ui({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...Te(t)})}(0,e)}(t)),e.date=t=>e.check(function(e){return function(e,t){return new pi({type:"string",format:"date",check:"string_format",...Te(t)})}(0,e)}(t)),e.time=t=>e.check(function(e){return function(e,t){return new mi({type:"string",format:"time",check:"string_format",precision:null,...Te(t)})}(0,e)}(t)),e.duration=t=>e.check(function(e){return function(e,t){return new fi({type:"string",format:"duration",check:"string_format",...Te(t)})}(0,e)}(t))});function Ci(e){return function(e,t){return new Ai({type:"string",...Te(t)})}(0,e)}const Oi=oe("ZodStringFormat",(e,t)=>{Ht.init(e,t),Ei.init(e,t)}),Ri=oe("ZodEmail",(e,t)=>{Yt.init(e,t),Oi.init(e,t)}),$i=oe("ZodGUID",(e,t)=>{Lt.init(e,t),Oi.init(e,t)}),Di=oe("ZodUUID",(e,t)=>{Xt.init(e,t),Oi.init(e,t)}),Ni=oe("ZodURL",(e,t)=>{qt.init(e,t),Oi.init(e,t)}),ji=oe("ZodEmoji",(e,t)=>{Jt.init(e,t),Oi.init(e,t)}),Fi=oe("ZodNanoID",(e,t)=>{Qt.init(e,t),Oi.init(e,t)}),Gi=oe("ZodCUID",(e,t)=>{es.init(e,t),Oi.init(e,t)}),Wi=oe("ZodCUID2",(e,t)=>{ts.init(e,t),Oi.init(e,t)}),Vi=oe("ZodULID",(e,t)=>{ss.init(e,t),Oi.init(e,t)}),Zi=oe("ZodXID",(e,t)=>{is.init(e,t),Oi.init(e,t)}),Bi=oe("ZodKSUID",(e,t)=>{ns.init(e,t),Oi.init(e,t)}),Ui=oe("ZodIPv4",(e,t)=>{cs.init(e,t),Oi.init(e,t)}),Ki=oe("ZodIPv6",(e,t)=>{ls.init(e,t),Oi.init(e,t)}),Hi=oe("ZodCIDRv4",(e,t)=>{ds.init(e,t),Oi.init(e,t)}),Li=oe("ZodCIDRv6",(e,t)=>{us.init(e,t),Oi.init(e,t)}),Xi=oe("ZodBase64",(e,t)=>{ms.init(e,t),Oi.init(e,t)}),Yi=oe("ZodBase64URL",(e,t)=>{fs.init(e,t),Oi.init(e,t)}),qi=oe("ZodE164",(e,t)=>{gs.init(e,t),Oi.init(e,t)}),Ji=oe("ZodJWT",(e,t)=>{ys.init(e,t),Oi.init(e,t)}),Qi=oe("ZodNumber",(e,t)=>{vs.init(e,t),Ti.init(e,t),e.gt=(t,s)=>e.check(ri(t,s)),e.gte=(t,s)=>e.check(ai(t,s)),e.min=(t,s)=>e.check(ai(t,s)),e.lt=(t,s)=>e.check(ii(t,s)),e.lte=(t,s)=>e.check(ni(t,s)),e.max=(t,s)=>e.check(ni(t,s)),e.int=t=>e.check(sn(t)),e.safe=t=>e.check(sn(t)),e.positive=t=>e.check(ri(0,t)),e.nonnegative=t=>e.check(ai(0,t)),e.negative=t=>e.check(ii(0,t)),e.nonpositive=t=>e.check(ni(0,t)),e.multipleOf=(t,s)=>e.check(oi(t,s)),e.step=(t,s)=>e.check(oi(t,s)),e.finite=()=>e;const s=e._zod.bag;e.minValue=Math.max(s.minimum??Number.NEGATIVE_INFINITY,s.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(s.maximum??Number.POSITIVE_INFINITY,s.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(s.format??"").includes("int")||Number.isSafeInteger(s.multipleOf??.5),e.isFinite=!0,e.format=s.format??null});function en(e){return function(e,t){return new Qi({type:"number",checks:[],...Te(t)})}(0,e)}const tn=oe("ZodNumberFormat",(e,t)=>{bs.init(e,t),Qi.init(e,t)});function sn(e){return function(e,t){return new tn({type:"number",check:"number_format",abort:!1,format:"safeint",...Te(t)})}(0,e)}const nn=oe("ZodBoolean",(e,t)=>{ws.init(e,t),Ti.init(e,t)});function rn(e){return function(e,t){return new nn({type:"boolean",...Te(t)})}(0,e)}const an=oe("ZodUnknown",(e,t)=>{xs.init(e,t),Ti.init(e,t)});function on(){return new an({type:"unknown"})}const hn=oe("ZodNever",(e,t)=>{ks.init(e,t),Ti.init(e,t)});function cn(e){return function(e,t){return new hn({type:"never",...Te(t)})}(0,e)}const ln=oe("ZodArray",(e,t)=>{Ps.init(e,t),Ti.init(e,t),e.element=t.element,e.min=(t,s)=>e.check(ci(t,s)),e.nonempty=t=>e.check(ci(1,t)),e.max=(t,s)=>e.check(hi(t,s)),e.length=(t,s)=>e.check(li(t,s)),e.unwrap=()=>e.element});function dn(e,t){return function(e,t,s){return new ln({type:"array",element:t,...Te(s)})}(0,e,t)}const un=oe("ZodObject",(e,t)=>{Ts.init(e,t),Ti.init(e,t),ye(e,"shape",()=>t.shape),e.keyof=()=>vn(Object.keys(e._zod.def.shape)),e.catchall=t=>e.clone({...e._zod.def,catchall:t}),e.passthrough=()=>e.clone({...e._zod.def,catchall:on()}),e.loose=()=>e.clone({...e._zod.def,catchall:on()}),e.strict=()=>e.clone({...e._zod.def,catchall:cn()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=t=>function(e,t){if(!Pe(t))throw new Error("Invalid input to extend: expected a plain object");const s=e._zod.def.checks;if(s&&s.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const i=be(e._zod.def,{get shape(){const s={...e._zod.def.shape,...t};return ve(this,"shape",s),s},checks:[]});return Me(e,i)}(e,t),e.safeExtend=t=>function(e,t){if(!Pe(t))throw new Error("Invalid input to safeExtend: expected a plain object");const s={...e._zod.def,get shape(){const s={...e._zod.def.shape,...t};return ve(this,"shape",s),s},checks:e._zod.def.checks};return Me(e,s)}(e,t),e.merge=t=>function(e,t){const s=be(e._zod.def,{get shape(){const s={...e._zod.def.shape,...t._zod.def.shape};return ve(this,"shape",s),s},get catchall(){return t._zod.def.catchall},checks:[]});return Me(e,s)}(e,t),e.pick=t=>function(e,t){const s=e._zod.def;return Me(e,be(e._zod.def,{get shape(){const e={};for(const i in t){if(!(i in s.shape))throw new Error(`Unrecognized key: "${i}"`);t[i]&&(e[i]=s.shape[i])}return ve(this,"shape",e),e},checks:[]}))}(e,t),e.omit=t=>function(e,t){const s=e._zod.def,i=be(e._zod.def,{get shape(){const i={...e._zod.def.shape};for(const e in t){if(!(e in s.shape))throw new Error(`Unrecognized key: "${e}"`);t[e]&&delete i[e]}return ve(this,"shape",i),i},checks:[]});return Me(e,i)}(e,t),e.partial=(...t)=>function(e,t,s){const i=be(t._zod.def,{get shape(){const i=t._zod.def.shape,n={...i};if(s)for(const t in s){if(!(t in i))throw new Error(`Unrecognized key: "${t}"`);s[t]&&(n[t]=e?new e({type:"optional",innerType:i[t]}):i[t])}else for(const t in i)n[t]=e?new e({type:"optional",innerType:i[t]}):i[t];return ve(this,"shape",n),n},checks:[]});return Me(t,i)}(wn,e,t[0]),e.required=(...t)=>function(e,t,s){const i=be(t._zod.def,{get shape(){const i=t._zod.def.shape,n={...i};if(s)for(const t in s){if(!(t in n))throw new Error(`Unrecognized key: "${t}"`);s[t]&&(n[t]=new e({type:"nonoptional",innerType:i[t]}))}else for(const t in i)n[t]=new e({type:"nonoptional",innerType:i[t]});return ve(this,"shape",n),n},checks:[]});return Me(t,i)}(zn,e,t[0])});function pn(e,t){const s={type:"object",shape:e??{},...Te(t)};return new un(s)}const mn=oe("ZodUnion",(e,t)=>{As.init(e,t),Ti.init(e,t),e.options=t.options}),fn=oe("ZodIntersection",(e,t)=>{Cs.init(e,t),Ti.init(e,t)}),gn=oe("ZodRecord",(e,t)=>{$s.init(e,t),Ti.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType}),yn=oe("ZodEnum",(e,t)=>{Ds.init(e,t),Ti.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const s=new Set(Object.keys(t.entries));e.extract=(e,i)=>{const n={};for(const r of e){if(!s.has(r))throw new Error(`Key ${r} not found in enum`);n[r]=t.entries[r]}return new yn({...t,checks:[],...Te(i),entries:n})},e.exclude=(e,i)=>{const n={...t.entries};for(const t of e){if(!s.has(t))throw new Error(`Key ${t} not found in enum`);delete n[t]}return new yn({...t,checks:[],...Te(i),entries:n})}});function vn(e,t){const s=Array.isArray(e)?Object.fromEntries(e.map(e=>[e,e])):e;return new yn({type:"enum",entries:s,...Te(t)})}const bn=oe("ZodTransform",(e,t)=>{Ns.init(e,t),Ti.init(e,t),e._zod.parse=(s,i)=>{if("backward"===i.direction)throw new ce(e.constructor.name);s.addIssue=i=>{if("string"==typeof i)s.issues.push(De(i,s.value,t));else{const t=i;t.fatal&&(t.continue=!1),t.code??(t.code="custom"),t.input??(t.input=s.value),t.inst??(t.inst=e),s.issues.push(De(t))}};const n=t.transform(s.value,s);return n instanceof Promise?n.then(e=>(s.value=e,s)):(s.value=n,s)}}),wn=oe("ZodOptional",(e,t)=>{Fs.init(e,t),Ti.init(e,t),e.unwrap=()=>e._zod.def.innerType});function xn(e){return new wn({type:"optional",innerType:e})}const kn=oe("ZodNullable",(e,t)=>{Gs.init(e,t),Ti.init(e,t),e.unwrap=()=>e._zod.def.innerType});function _n(e){return new kn({type:"nullable",innerType:e})}const Pn=oe("ZodDefault",(e,t)=>{Ws.init(e,t),Ti.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap}),Sn=oe("ZodPrefault",(e,t)=>{Zs.init(e,t),Ti.init(e,t),e.unwrap=()=>e._zod.def.innerType}),zn=oe("ZodNonOptional",(e,t)=>{Bs.init(e,t),Ti.init(e,t),e.unwrap=()=>e._zod.def.innerType}),In=oe("ZodCatch",(e,t)=>{Ks.init(e,t),Ti.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap}),Mn=oe("ZodPipe",(e,t)=>{Hs.init(e,t),Ti.init(e,t),e.in=t.in,e.out=t.out});function Tn(e,t){return new Mn({type:"pipe",in:e,out:t})}const En=oe("ZodReadonly",(e,t)=>{Xs.init(e,t),Ti.init(e,t),e.unwrap=()=>e._zod.def.innerType}),An=oe("ZodCustom",(e,t)=>{qs.init(e,t),Ti.init(e,t)}),Cn="ActionScene",On="AnimationManager",Rn="IdleScene",$n="MainScene",Dn="MainMenu",Nn="Preloader";class jn{constructor(e,t,s){K(this,"tween"),K(this,"target"),this.tween=e.tweens.addCounter({duration:200,from:t,onUpdate:e=>{if(!this.target)return;let t=e.getValue();if(null===t)throw new Error("invalid tween");t=Math.floor(t),this.target.setTint(Phaser.Display.Color.GetColor(t,t,t))},paused:!0,persist:!0,to:s})}restart(e){this.target=e,this.tween.resume()}pause(){this.target=void 0,this.tween.pause().seek(0)}}let Fn=(e=class extends Phaser.GameObjects.Image{constructor(e,t,s,i){var n,r;super(e.scene,t,s,"menu-item"),K(this,"text"),K(this,"tween"),K(this,"onClick",()=>{}),K(this,"focused",!1),this.container=e,this.idx=i,e.scene.add.existing(this),this.setInteractive(),this.tween=new jn(this.scene,255,204),this.text=e.scene.add.text(this.width/2+t,this.height/2+s,"",{align:"center",color:"#ffffff",fontSize:40,stroke:"#000000",strokeThickness:8}).setOrigin(.5,.5).setShadow(5,5,"#5588EE",0,!0,!0),e.add(this.text),this.on("pointerup",e=>{if(!(e instanceof Phaser.Input.Pointer))throw new ne;this.onClick(e)}),this.on("pointerover",()=>{this.container.idx=void 0,this.pointerover()}),this.on("pointerout",()=>{this.container.idx=void 0,this.pointerout()}),null==(n=this.preFX)||n.setPadding(16),null==(r=this.preFX)||r.addShadow()}pointerout(){this.focused&&(this.tween.pause(),this.setRotation(0).setTint(16777215),this.focused=!1)}pointerover(){this.focused||(this.tween.restart(this),this.setRotation(Math.PI/32),setTimeout(()=>{this.setRotation(0)},50),this.focused=!0)}update(e,t){void 0!==this.container.idx&&(this.container.idx===this.idx?this.pointerover():this.pointerout())}},K(e,"texture","menu-item"),e);const Gn=class e extends Phaser.GameObjects.Container{constructor(t,s){var i,n,r;super(t,s.x,s.y),K(this,"idx",0),K(this,"promptKey","menu"),K(this,"prompts",[{kbm:{color:16711935,frame:"mouse_move"},text:"navigate",xbox:{color:16777215,frame:"xbox_dpad_vertical"}},{kbm:{color:16711935,frame:"mouse_left"},text:"select",xbox:{color:16777215,frame:"xbox_button_color_a"}},{kbm:{color:16711935,frame:"keyboard_escape"},text:"exit",xbox:{color:16777215,frame:"xbox_button_color_b"}}]),K(this,"tween"),K(this,"width"),K(this,"bg"),K(this,"buttonHeight"),K(this,"buttons",[]),K(this,"buttonWidth"),this.scene=t,this.scene.add.existing(this),this.setVisible(!1);const a=this.scene.textures.get(Fn.texture).getFrameBounds();this.buttonHeight=a.height,this.buttonWidth=a.width,this.width=this.buttonWidth+e.PADDING.left+e.PADDING.right,this.bg=this.scene.add.tileSprite(0,0,this.menuWidth(1),this.menuHeight(2),"repeating-background").setOrigin(0,0),this.add(this.bg),null==(i=this.bg.preFX)||i.setPadding(32),null==(n=this.bg.preFX)||n.addGlow(16777215,100),null==(r=this.bg.preFX)||r.addShadow(),this.tween=new jn(this.scene,255,204)}close(e){this.setVisible(!1)}onCancel(e){this.close(e)}onInteract(e){this.idx=0}onMovement(e,t){0!==t&&(this.idx=(this.idx??0)+t,-1===this.idx?this.idx=this.buttons.length-1:this.idx=this.idx%this.buttons.length)}onSelect(e){var t;null==(t=this.buttons[this.idx??0])||t.onClick()}open(t,s,i){if(!Ir.instance)throw new re;this.idx=0;const n=Ir.instance.cameras.main.width-this.width-e.MARGIN;i.x>n?this.setPosition(0+e.MARGIN,s+e.MARGIN):this.setPosition(n,s+e.MARGIN),this.setVisible(!0),i.inputProvider.setOnInteract(this)}setButtons(e){for(let t=0;t<e.length;t++){const s=e[t];if(!s)throw new Error("invalid type");const i=this.buttons[t]??this.createButton(t);i.onClick=s.onClick,i.text.text=s.text}this.bg.setSize(this.menuWidth(1),this.menuHeight(e.length));for(let t=e.length;t<this.buttons.length;t++){const e=this.buttons[t];if(!e)return;e.setVisible(!1).text.setVisible(!1)}}update(e,t){for(const s of this.buttons)s.update(e,t)}createButton(t){const s=new Fn(this,e.PADDING.right,e.GAP+(this.buttonHeight+e.GAP)*t+e.PADDING.top,t);return s.setPosition(s.width/2+e.PADDING.right,s.height/2+(this.buttonHeight+e.GAP)*t+e.PADDING.top),this.buttons.push(s),this.add(s),s.text.setAbove(s),s}menuHeight(t){const s=Math.max(t-1,0)*e.GAP,i=t*this.buttonHeight,n=e.PADDING.top;return i+s+e.PADDING.bottom+e.PADDING.bottom+n}menuWidth(t){return this.width=this.buttonWidth+e.PADDING.left+e.PADDING.right,this.width}};K(Gn,"GAP",10),K(Gn,"MARGIN",100),K(Gn,"PADDING",{bottom:10,left:10,right:10,top:10});let Wn=Gn;const Vn=()=>{},Zn={align:"center",color:"#ffffff",fontFamily:"MarcellusSC",fontSize:40,stroke:"#000000",strokeThickness:8};class Bn{constructor(e=[],t){var s,i;K(this,"player"),K(this,"background"),K(this,"kbm",[]),K(this,"key"),K(this,"last"),K(this,"scene"),K(this,"text",[]),K(this,"width",0),K(this,"xbox",[]),this.player=t,this.scene=t.scene;const n=this.scene.scale.width/4*(2*t.num+1),r=this.scene.scale.height-200;this.background=this.scene.add.rectangle(n,r,256,128,0,.75).setVisible(!1).setOrigin(.5).setScrollFactor(0);for(const a of e){const e=this.scene.add.image(n,r,"kbm",a.kbm.frame).setVisible(!1).setScale(.75).setOrigin(0,.5).setScrollFactor(0);null==(s=e.preFX)||s.addShadow(-.25,-.25,.1,1,a.kbm.color),this.kbm.push(e);const t=this.scene.add.image(n,r,"xbox",a.xbox.frame).setVisible(!1).setScale(.75).setOrigin(0,.5).setScrollFactor(0);null==(i=t.preFX)||i.addShadow(-.5,-.5,.1,1,a.xbox.color),this.xbox.push(t);const o=this.scene.add.text(n,r,a.text,Zn).setVisible(!1).setOrigin(0,.5).setScrollFactor(0);if(this.text.push(o),e.displayWidth!==t.displayWidth)throw new Error("invalid assumption");this.width+=10+e.displayWidth+20+o.displayWidth+10}this.width+=20}destroy(){this.background.destroy();for(let e=0;e<this.kbm.length;e++){const t=this.kbm[e],s=this.text[e],i=this.xbox[e];if(!t||!s||!i)throw new Error;t.destroy(),s.destroy(),i.destroy()}}disable(){this.key=void 0,this.setVisible(!1)}enable(e,t){if(this.last===t&&this.key===e)return;this.key=e,this.last=t;const s=this.button(t);this.background.setSize(this.width,128).setVisible(!0);const{left:i}=this.background.getBounds();let n=i+10;for(let r=0;r<s.length;r++){const e=s[r],t=this.text[r];if(!e||!t)throw new Error;n+=10,e.x=n,n+=e.displayWidth,n+=20,t.x=n,n+=t.displayWidth,n+=10,e.setVisible(!0),t.setVisible(!0)}}refresh(){this.setVisible(!1).setVisible(!0)}button(e){return"xbox"===e||"ps4"===e?this.xbox:this.kbm}setVisible(e){this.background.setVisible(e);for(let t=0;t<this.kbm.length;t++){const s=this.kbm[t],i=this.text[t],n=this.xbox[t];if(!s||!i||!n)throw new Error;s.setVisible(e),i.setVisible(e),n.setVisible(e)}return this}}const Un=e=>Phaser.Input.Keyboard.KeyCodes[e],Kn=class e{constructor(e,i,n={interactionKeys:{dash:"SPACE",interact:"E"},movementKeys:{down:"S",left:"A",right:"D",up:"W"}}){if(K(this,"active",!1),X(this,t,[!1,!1,!1,!1]),K(this,"connected",!1),K(this,"dashing",!1),K(this,"last","kbm"),K(this,"player"),K(this,"prompt"),K(this,"scene"),K(this,"targets",{}),K(this,"config"),K(this,"framesMoved",0),K(this,"framesUnmoved",0),K(this,"gamepad"),K(this,"interactTarget",[]),K(this,"isSetup",!1),K(this,"lastPos",[[0,0]]),K(this,"moved",!1),K(this,"onCancel",()=>{const e=this.targets.curr;e&&this.player&&e.onCancel(this.player)}),K(this,"onInteract",()=>{const e=this.targets.curr;e&&this.player&&e.onInteract(this.player)}),K(this,"onPause",Vn),K(this,"onTab",Vn),K(this,"prompts",new Map),K(this,"setup",!1),K(this,"_gamepadPlugin"),K(this,"_keyboardPlugin"),K(this,"_keys"),K(this,"_movement"),K(this,"_systemKeys"),X(this,s),this.scene=e,this.player=i,this.config=n,this.player){const e=[{kbm:{color:16777215,frame:"keyboard_wasd"},text:"move",xbox:{color:16711935,frame:"xbox_stick_l"}}];this.prompt=new Bn(e,this.player),this.prompts.set("move",this.prompt)}}get aiming(){let e=this.keys.aim.kbm.isDown;return this.gamepad&&(e=e||this.gamepad.L2>.5),e}get gamepadPlugin(){if(null===this.scene.input.gamepad)throw new Error("missing gamepad plugin");return this._gamepadPlugin??(this._gamepadPlugin=this.scene.input.gamepad),this._gamepadPlugin}get keyboardPlugin(){if(null===this.scene.input.keyboard)throw new Error("missing keyboard plugin");return this._keyboardPlugin??(this._keyboardPlugin=this.scene.input.keyboard),this._keyboardPlugin}get keys(){return this._keys??(this._keys={aim:{button:6,kbm:this.keyboardPlugin.addKey(Phaser.Input.Keyboard.KeyCodes.SHIFT),onInteract:Vn},cancel:{button:1,kbm:this.keyboardPlugin.addKey(Phaser.Input.Keyboard.KeyCodes.Q),onInteract:()=>{this.onCancel()}},dash:{button:0,kbm:this.keyboardPlugin.addKey(Un(this.config.interactionKeys.dash)),onInteract:()=>{this.dashing=!0}},interact:{button:2,kbm:this.keyboardPlugin.addKey(Un(this.config.interactionKeys.interact)),onInteract:()=>{const e=this.interactTarget[this.interactTarget.length-1];this.focus instanceof Wn&&e&&this.player?e.onSelect(this.player):this.onInteract()}},select:{button:0,kbm:null,onInteract:()=>{const e=this.interactTarget[this.interactTarget.length-1];e&&this.player&&e.onSelect(this.player)}},toggle:{button:3,kbm:this.keyboardPlugin.addKey(Phaser.Input.Keyboard.KeyCodes.F),onInteract:()=>{this.player&&(L(this,t)[this.player.num]=!L(this,t)[this.player.num])}}}),this._keys}get movement(){return this._movement??(this._movement={down:{button:-1,kbm:this.keyboardPlugin.addKey(Un(this.config.movementKeys.down)),onInteract:this.onMenu(0,1)},left:{button:-1,kbm:this.keyboardPlugin.addKey(Un(this.config.movementKeys.left)),onInteract:this.onMenu(-1,0)},right:{button:-1,kbm:this.keyboardPlugin.addKey(Un(this.config.movementKeys.right)),onInteract:this.onMenu(1,0)},up:{button:-1,kbm:this.keyboardPlugin.addKey(Un(this.config.movementKeys.up)),onInteract:this.onMenu(0,-1)}}),this._movement}get systemKeys(){return this._systemKeys??(this._systemKeys={pause:{button:9,kbm:this.keyboardPlugin.addKey(Phaser.Input.Keyboard.KeyCodes.ESC),onInteract:()=>{const e=this.interactTarget[this.interactTarget.length-1];e&&this.player?e.onCancel(this.player):this.onPause()}},upgrade:{button:16,kbm:this.keyboardPlugin.addKey(Phaser.Input.Keyboard.KeyCodes.TAB),onInteract:this.onTab}}),this._systemKeys}destroy(){this.prompts.forEach(e=>{e.destroy()}),this.prompt=void 0,this.prompts=new Map}position(){let{x:e,y:t}=this.axes("left");const s=e**2+t**2;s>1&&(e/=Math.sqrt(s),t/=Math.sqrt(s));const i=this.movement.left.kbm.isDown,n=this.movement.right.kbm.isDown;i&&(e-=1),n&&(e+=1);const r=this.movement.up.kbm.isDown,a=this.movement.down.kbm.isDown;return r&&(t-=1),a&&(t+=1),(r||i||a||n)&&(this.last="kbm"),this.focus instanceof ur?(Math.abs(e)+Math.abs(t)>1&&(e*=Math.SQRT1_2,t*=Math.SQRT1_2),0===e&&0===t||(this.moved=!0,this.active=!0,this.lastPos.push([e,t]),this.lastPos.length>30&&this.lastPos.shift()),[e,t]):[0,0]}refresh(){this.setupKBM(),this.updateConnection()}refreshPrompt(e){var t;e===this.targets.curr&&(null==(t=this.prompt)||t.destroy(),this.prompts.delete(e.promptKey))}removeAllInteract(){var e;this.interactTarget=[],this.targets.next=void 0,this.targets.curr=void 0,this.prompt!==this.prompts.get("move")&&(null==(e=this.prompt)||e.disable())}removeOnInteract(e){var t;if(0===this.interactTarget.length)return;const s=this.interactTarget.findIndex(t=>t===e);-1!==s&&(this.interactTarget.splice(s),void 0===this.interactTarget[this.interactTarget.length-1]&&(null==(t=this.prompt)||t.disable()),0===this.interactTarget.length&&(this.scene instanceof ur?this.focus=this.scene:this.focus=null))}setOnInteract(e){e instanceof Wn&&(this.focus=e),this.targets.next=e;let t=this.prompts.get(e.promptKey);this.player&&!t&&e.prompts.length>0&&(t=new Bn(e.prompts,this.player),this.prompts.set(e.promptKey,t)),this.prompt=t}setOnPause(e){this.onPause=e}setOnTab(e){this.onTab=e}target(e,s){var i;if(this.player&&L(this,t)[this.player.num]&&null!==s){const t=this.scene.physics.closest(e,s.getMatching("visible",!0));if(t instanceof Jr)return{angle:Phaser.Math.Angle.Between(e.x,e.y,t.x,t.y),x:e.x,y:e.y}}const n=e.scene.input.activePointer,r=e.x-e.scene.cameras.main.scrollX,a=e.y-e.scene.cameras.main.scrollY;let o=n.x,h=n.y,c=Phaser.Math.Angle.Between(r,a,n.worldX,n.worldY);3!==(null==(i=this.player)?void 0:i.num)&&([o,h]=this.lastPosition(),c=Phaser.Math.Angle.Between(0,0,o,h));const{x:l,y:d}=this.axes("right");return 0===l&&0===d||(c=Phaser.Math.Angle.Between(0,0,l,d),o=e.x,h=e.y),{angle:c,x:o,y:h}}update(e,t){var s,i,n;if(this.setupKBM(),null===this.player)return;this.targets.prev=this.targets.curr,this.targets.curr=this.targets.next,this.targets.next=void 0;const r=this.targets.curr;r&&this.prompt&&(r!==this.targets.prev&&(this.targets.prev&&(null==(s=this.prompts.get(this.targets.prev.promptKey))||s.disable()),this.targets.prev=r),this.prompt.enable(r.promptKey,this.last)),void 0===r&&this.removeAllInteract(),this.framesUnmoved<60?this.framesUnmoved++:this.moved&&this.framesMoved<100?this.framesMoved++:this.framesMoved<100?(this.prompt=this.prompts.get("move"),null==(i=this.prompt)||i.enable("move",this.last)):100===this.framesMoved&&(null==(n=this.prompts.get("move"))||n.disable()),this.updateConnection()}updateConnection(){this.connected||this.player&&(this.gamepad=this.gamepadPlugin.gamepads[this.player.num],this.gamepad&&this.setupController()&&(this.connected=!0))}axes(e){if(!this.gamepad)return{x:0,y:0};const t="left"===e?0:2,s=this.gamepad.axes[0+t],i=this.gamepad.axes[1+t];let n=0,r=0;return void 0!==s&&void 0!==i&&(s.threshold=.15,i.threshold=.15,n=s.getValue(),r=i.getValue()),0===n&&0===r||(this.last="xbox"),{x:n,y:r}}get focus(){return L(this,s)||(this.scene instanceof Wn||this.scene instanceof ur?Y(this,s,this.scene):Y(this,s,null)),L(this,s)}set focus(e){Y(this,s,e)}lastPosition(){let t=[];this.lastPos.reduce((s,i)=>(e.allowedTransitions(s,i)?t.push(i):t=[i],i));const s=[0,0],i=t.length;return t.forEach(e=>{s[0]+=e[0]/i,s[1]+=e[1]/i}),s}onMenu(e,t){return()=>{var s;const i=this.interactTarget[this.interactTarget.length-1];i&&(null==(s=i.onMovement)||s.call(i,e,t))}}setupController(){return!!this.setup||!!this.gamepad&&(this.gamepad.on("down",(e,t,s)=>{if("number"!=typeof e)throw new ne;if("number"!=typeof t)throw new ne;if(!(s instanceof Phaser.Input.Gamepad.Button))throw new ne;s.pad.id.toLowerCase().includes("xbox")?this.last="xbox":this.last="ps4";for(const[,i]of Object.entries(this.keys))s.index===i.button&&i.onInteract();s.index!==Phaser.Input.Gamepad.Configs.XBOX_360.START&&s.index!==Phaser.Input.Gamepad.Configs.XBOX_360.A||(this.active=!0),s.index,Phaser.Input.Gamepad.Configs.XBOX_360.BACK,s.index,Phaser.Input.Gamepad.Configs.XBOX_360.START,s.index,Phaser.Input.Gamepad.Configs.XBOX_360.X}),this.gamepadPlugin.on("down",(e,t)=>{if(!(e instanceof Phaser.Input.Gamepad.Gamepad))throw new ne;if(!(t instanceof Phaser.Input.Gamepad.Button))throw new ne;e.id.toLowerCase().includes("xbox")?this.last="xbox":this.last="ps4",t.index===Phaser.Input.Gamepad.Configs.XBOX_360.BACK&&this.onTab(),t.index===Phaser.Input.Gamepad.Configs.XBOX_360.START&&this.onPause(),t.index===Phaser.Input.Gamepad.Configs.XBOX_360.X&&this.onInteract()}),this.setup=!0,!0)}setupKBM(){var e,t;if(!this.isSetup){for(const[,e]of Object.entries(this.systemKeys))e.kbm.on("up",()=>{this.last="kbm",e.onInteract()});if(0===(null==(e=this.player)?void 0:e.num))for(const[,e]of Object.entries(this.systemKeys))e.kbm.on("up",()=>{this.last="kbm",e.onInteract()});for(const[,e]of Object.entries(this.keys))null==(t=e.kbm)||t.on("up",()=>{this.last="kbm",e.onInteract()});for(const[,e]of Object.entries(this.movement))e.kbm.on("up",()=>{this.last="kbm",e.onInteract()});this.isSetup=!0}}};t=new WeakMap,s=new WeakMap,K(Kn,"allowedTransitions",(e,t)=>{const[s,i]=e,[n,r]=t;return s===n&&i===r||(Kn.isCardinal(s,i)&&Kn.isDiagonal(n,r)||!(!Kn.isDiagonal(s,i)||!Kn.isCardinal(n,r)))&&(Math.sign(s)===Math.sign(n)||Math.sign(i)===Math.sign(r))}),K(Kn,"isCardinal",(e,t)=>0===e&&1===Math.abs(t)||0===t&&1===Math.abs(e)),K(Kn,"isDiagonal",(e,t)=>Math.abs(e)===Math.SQRT1_2&&Math.abs(t)===Math.SQRT1_2);let Hn=Kn;class Ln extends Phaser.Physics.Arcade.Sprite{constructor(){super(...arguments),K(this,"promptKey",this.constructor.name),K(this,"prompts",[])}onCancel(e){}onCollision(){}onInteract(e){}onMovement(e,t){}onSelect(e){}}Phaser.Physics.Arcade.Sprite;Phaser.Physics.Arcade.Sprite;Phaser.Physics.Arcade.Sprite;Phaser.Physics.Arcade.Sprite;Math.max(20,0);const Xn=e=>{const t=[];for(let i=0;i<e;i++){const s=Math.random()*((i+1)/e),n=160+80*Math.random();t.push({position:s,speed:n})}let s=1;return t.reduce((e,t)=>(s=Math.min(s,Math.abs(e.position-t.position)),t)),s<.1?(console.log("retrying"),Xn(e)):t},Yn=class e{constructor(){for(let t=0;t<240;t++){if(t%2!=0){e.table.push([]);continue}const s=Math.ceil(2+2*Math.random());e.table.push(Xn(s))}}static next(){e.instance||(e.instance=new e),e.idx>=e.table.length&&(console.warn("random numbers exhausted"),e.idx=0);const t=e.table[e.idx++];if(void 0===t)throw new Error;return t}};K(Yn,"idx",0),K(Yn,"table",[]),K(Yn,"instance");Phaser.Scene;const qn=["bat.png","blob.png","blob_1.png","blobie-walk copy.png","blobie-walk.png","brawler48x48.png","char.png","drone.png","portal-particles_240_340.png","portal_240_340.png","rat.png","stick-head.png","stick.png","thickius.png"],Jn=[1,5,25,125,625],Qn="xp",er=["grid","castle","pebble","menu-item","border","border-wide","close-icon","pickaxe","sword","bow","arrow","reticle","menu","menu-border","drop-agility","drop-strength","drop-endurance","static-void-gem"],tr=new Map([["grid","grid-ps2.png"],["castle","castle.png"],["pebble","pebble.gif"],["menu-item","border-wide.png"],["close-icon","close-icon.png"]]),sr=[{config:{end:23,start:0},delay:0,frameRate:24,key:"float",repeat:-1,repeatDelay:0,yoyo:!0}],ir=[];for(const Fa of Jn){const e="animations/xp",t=`${Qn}${Fa}`;ir.push({animations:sr,frameConfig:{frameHeight:128,frameWidth:80},key:t,url:`${e}/${t}.png`})}const nr=[{config:{end:23,start:0},delay:0,frameRate:24,key:"float",repeat:-1,repeatDelay:100,yoyo:!0}],rr=[{animations:nr,frameConfig:{frameHeight:128,frameWidth:80},key:"void-gem",url:"animations/void-gem.png"},{animations:nr,frameConfig:{frameHeight:128,frameWidth:80},key:"stat-drop",url:"animations/stat-drop.png"},{animations:nr,frameConfig:{frameHeight:128,frameWidth:80},key:"sword-pickup",url:"animations/items/sword-pickup.png"},{animations:nr,frameConfig:{frameHeight:128,frameWidth:80},key:"arrow-pickup",url:"animations/items/arrow-pickup.png"},...ir];class ar extends ee.Scene{constructor(){super({key:Nn,plugins:Phaser.Plugins.DefaultPlugins.DefaultScene})}create(){this.scene.start(On),this.scene.start($n)}init(){this.add.rectangle(1920,1824,3072,128).setOrigin(.5).setStrokeStyle(1,16777215);const e=this.add.rectangle(384,1824,4,124,16777215).setOrigin(.5);let t;this.load.on("progress",s=>{if("number"!=typeof s)throw new Error("");0===s&&(t=performance.now()),1===s&&performance.now(),e.width=4+3072*s})}preload(){this.load.setPath("assets"),this.load.image("logo","logo.png"),this.load.font("Roboto","fonts/Roboto/Roboto-VariableFont_wdth,wght.ttf"),this.load.font("MarcellusSC","fonts/Marcellus_SC/MarcellusSC-Regular.ttf"),this.load.bitmapFont("MarcellusSCBitmap","fonts/Marcellus_SC/MarcellusSC-Regular.png","fonts/Marcellus_SC/MarcellusSC-Regular.xml"),this.load.spritesheet("brawler","animations/brawler48x48.png",{frameHeight:48,frameWidth:48}),this.preloadTexture(),this.load.spritesheet("fullscreen","ui/fullscreen.png",{frameHeight:64,frameWidth:64}),this.load.atlas("xbox","ui/xbox.png","ui/xbox.json"),this.load.atlas("kbm","ui/kbm.png","ui/kbm.json"),this.load.image("cursor-attack","ui/cursor-attack.png"),this.load.image("cursor-default","ui/cursor-default.png"),this.load.atlas("flares","particles/flares.png","particles/flares.json"),this.load.spritesheet("stick","animations/stick.png",{frameHeight:339.375,frameWidth:180}),this.load.spritesheet("stick-head","animations/stick-head.png",{frameHeight:18,frameWidth:18}),this.load.spritesheet("drone","animations/drone.png",{frameHeight:34,frameWidth:34}),this.load.spritesheet("blobie-walk","animations/blobie-walk.png",{frameHeight:34,frameWidth:34}),this.load.spritesheet("char","animations/char.png",{frameHeight:34,frameWidth:34}),this.load.spritesheet("rat","animations/rat.png",{frameHeight:34,frameWidth:34}),this.load.spritesheet("blob","animations/blob.png",{frameHeight:34,frameWidth:34}),this.load.spritesheet("bat","animations/bat.png",{frameHeight:34,frameWidth:34}),this.load.spritesheet("torch","animations/torch.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("barrel","animations/barrel.png",{frameHeight:128,frameWidth:128}),this.load.spritesheet("tnt","animations/tnt.png",{frameHeight:192,frameWidth:192}),rr.forEach(({frameConfig:e,key:t,url:s})=>{this.load.spritesheet(t,s,e)}),this.load.spritesheet("player1","animations/warrior.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("player2","animations/warrior2.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("red_archer_idle","Tiny Swords/Units/Red Units/Archer/Archer_Idle.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("red_archer_run","Tiny Swords/Units/Red Units/Archer/Archer_Run.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("red_archer_shoot","Tiny Swords/Units/Red Units/Archer/Archer_Shoot.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("red_warrior_idle","Tiny Swords/Units/Red Units/Warrior/Warrior_Idle.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("red_warrior_run","Tiny Swords/Units/Red Units/Warrior/Warrior_Run.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("red_warrior_attack1","Tiny Swords/Units/Red Units/Warrior/Warrior_Attack1.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("red_warrior_attack2","Tiny Swords/Units/Red Units/Warrior/Warrior_Attack2.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("blue_archer_idle","Tiny Swords/Units/Blue Units/Archer/Archer_Idle.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("blue_archer_run","Tiny Swords/Units/Blue Units/Archer/Archer_Run.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("blue_archer_shoot","Tiny Swords/Units/Blue Units/Archer/Archer_Shoot.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("blue_warrior_idle","Tiny Swords/Units/Blue Units/Warrior/Warrior_Idle.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("blue_warrior_run","Tiny Swords/Units/Blue Units/Warrior/Warrior_Run.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("blue_warrior_attack1","Tiny Swords/Units/Blue Units/Warrior/Warrior_Attack1.png",{frameHeight:192,frameWidth:192}),this.load.spritesheet("blue_warrior_attack2","Tiny Swords/Units/Blue Units/Warrior/Warrior_Attack2.png",{frameHeight:192,frameWidth:192}),this.load.atlas("crops","textures/crops.png","textures/crops.json"),this.load.atlas("drops","textures/drops.png","textures/drops.json"),qn.forEach(e=>{const[t,s,i]=e.replace(".png","").split("_");void 0!==t&&void 0!==s&&void 0!==i&&this.load.spritesheet(t,`animations/${e}`,{frameHeight:parseInt(i),frameWidth:parseInt(s)})}),this.load.glsl("fire","shaders/fire.glsl"),this.load.glsl("lightshaft","shaders/lightshaft.glsl.js"),this.load.image("repeating-background","textures/tile.png"),this.load.image("tileset-grass","textures/tileset-grass.png")}preloadTexture(){const e="textures";for(const t of er){const s=tr.get(t);void 0===s?this.load.image(t,`${e}/${t}.png`):this.load.image(t,`${e}/${s}`)}this.load.atlas("ores","textures/ores.png","textures/ores.json")}preloadXP(){for(const e of Jn)this.load.image(`${Qn}${e}`,`textures/xp/${e}.png`)}}var or,hr;const cr=Q(hr?or:(hr=1,or=function e(t,s){if(t===s)return!0;if(t&&s&&"object"==typeof t&&"object"==typeof s){if(t.constructor!==s.constructor)return!1;var i,n,r;if(Array.isArray(t)){if((i=t.length)!=s.length)return!1;for(n=i;0!==n--;)if(!e(t[n],s[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===s.source&&t.flags===s.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===s.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===s.toString();if((i=(r=Object.keys(t)).length)!==Object.keys(s).length)return!1;for(n=i;0!==n--;)if(!Object.prototype.hasOwnProperty.call(s,r[n]))return!1;for(n=i;0!==n--;){var a=r[n];if(!e(t[a],s[a]))return!1}return!0}return t!=t&&s!=s}));class lr extends Phaser.Scene{}class dr extends lr{constructor(){super(...arguments),K(this,"debugging",!1),K(this,"_inputPlugin",null),X(this,i,null),K(this,"_layers"),X(this,n),K(this,"_playerPlugin",null)}get config(){if(!L(this,i)){const e=this.game.plugins.get(Ia.key);if(!(e instanceof Ia))throw new Error("misconfigured plugin");Y(this,i,e)}return L(this,i)}get layers(){var e;if(!this._layers){const t=this.scale.height/2,s=this.scale.width/2,i=Math.max(t,s)/2,n=((e,t)=>{const s=e/96,i=t/96,n=Math.max(s,i);return{data:((e,t,s)=>{var i,n,r;const a=[];for(let o=-s;o<=s;o+=1){a[i=o+e]??(a[i]=new Array(t));const h=a[o+e];if(!h)throw new Error;for(let e=-s;e<=s;e+=1)Math.round(Math.sqrt(o*o+e*e))<=s?h[n=e+t]??(h[n]=Math.floor(64*Math.random())):h[r=e+t]??(h[r]=void 0)}return a})(n,n,n),height:i,tileHeight:32,tileWidth:32,width:s}})(t,s),r=this.make.tilemap(n),a=r.addTilesetImage("tileset-grass");if(null===a)throw new Error("tileset problems");this._layers={map:r.createLayer(0,a,0,-i),resource:this.add.layer().setDepth(1),game:this.add.layer().setDepth(5),player:this.add.layer().setDepth(6),ui:this.add.layer().setDepth(10),menu:this.add.layer().setVisible(!1).setDepth(15)},null==(e=this._layers.map)||e.setScale(3)}return this._layers}get inputProvider(){return L(this,n)??Y(this,n,new Hn(this,null)),L(this,n)}get inputv2(){if(!this._inputPlugin)throw this.load.scenePlugin(Ra.key,Ra,Ra.mapping),new Error("misconfigured scene plugin");return this._inputPlugin}get playerPlugin(){if(!this._playerPlugin){const e=this.game.plugins.get(Aa.key);if(!(e instanceof Aa))throw new Error("misconfigured plugin");this._playerPlugin=e}return this._playerPlugin}init(){this.physics.world.drawDebug=!1,this.events.on("update",(e,t)=>{if("number"!=typeof e||"number"!=typeof t)throw new ne;this.inputProvider.update(e,t)})}shutdown(){Y(this,n,void 0),this._layers=void 0}}i=new WeakMap,n=new WeakMap;class ur extends dr{constructor(){super(...arguments),X(this,r),X(this,a),X(this,o),X(this,h),X(this,c)}get buildings(){return L(this,r)||(Y(this,r,this.physics.add.group()),L(this,r).runChildUpdate=!0,this.physics.add.collider(L(this,r),[this.player1,this.player2],(e,t)=>{e instanceof Gr&&t instanceof Ln&&e.inputProvider.setOnInteract(t)})),L(this,r)}get debugGraphics(){var e;return this.debugging?(L(this,a)??Y(this,a,this.add.graphics()),L(this,a)):(null==(e=L(this,a))||e.clear(),null)}get drops(){return L(this,o)||(Y(this,o,this.physics.add.group()),L(this,o).runChildUpdate=!0),L(this,o)}get player1(){return L(this,h)??Y(this,h,new Gr(this,"blue",void 0,0)),L(this,h)}get player2(){return L(this,c)??Y(this,c,new Gr(this,"red",{interactionKeys:{dash:"FORWARD_SLASH",interact:"P"},movementKeys:{down:"DOWN",left:"LEFT",right:"RIGHT",up:"UP"}},1).setVisible(!1)),L(this,c)}init(){super.init()}shutdown(){var e,t,s,i;null==(e=L(this,h))||e.destroy(),Y(this,h,void 0),null==(t=L(this,c))||t.destroy(),Y(this,c,void 0),null==(s=L(this,o))||s.destroy(),Y(this,o,void 0),null==(i=L(this,r))||i.destroy(),Y(this,r,void 0),super.shutdown()}}r=new WeakMap,a=new WeakMap,o=new WeakMap,h=new WeakMap,c=new WeakMap;class pr{constructor(e){K(this,"lastDeps",[]),K(this,"lastValue"),this.fn=e}run(e){return void 0!==this.lastValue&&cr(this.lastDeps,e)||(this.lastValue=this.fn(),this.lastDeps=structuredClone(e)),this.lastValue}}class mr extends ur{constructor(){super(...arguments),K(this,"border",{curr:0,prev:0}),K(this,"graphics"),K(this,"split",!1),K(this,"_cameraMasks"),K(this,"_maskShapes"),K(this,"_playercams"),K(this,"_centers")}get cameraMasks(){if(!this._cameraMasks){const e=this.maskShapes.p1.createGeometryMask(),t=this.maskShapes.p2.createGeometryMask();this._cameraMasks={p1:e,p2:t}}return this._cameraMasks}get maskShapes(){if(!this._maskShapes){const e=this.add.graphics({x:0,y:0}),t=this.add.graphics({x:0,y:0});this.layers.ui.add(e),this.layers.ui.add(t),this._maskShapes={p1:e,p2:t}}return this._maskShapes}get playercams(){if(!this._playercams){const e=this.cameras.add(0,0,this.scale.width,this.scale.height,!1).setVisible(!1),t=this.cameras.add(0,0,this.scale.width,this.scale.height,!1).setVisible(!1);this._playercams={p1:e,p2:t}}return this._playercams}get centers(){return this._centers??(this._centers=new pr(()=>{const e=(this.player1.x+this.player2.x)/2,t=(this.player1.y+this.player2.y)/2,s=new Phaser.Math.Vector2(e,t),i=this.player2.x-this.player1.x,n=this.player2.y-this.player1.y,r=new Phaser.Math.Vector2(i,n),a=new Phaser.Math.Vector2(this.player1.x,this.player1.y),o=new Phaser.Math.Vector2(this.player2.x,this.player2.y),h=r.angle(),c=Math.sin(h)*this.scale.height/4,l=Math.cos(h)*this.scale.width/4,d=Math.sqrt(c**2+l**2);return{center1:r.clone().normalize().multiply({x:d,y:d}).add(this.player1),center2:r.clone().normalize().multiply({x:-d,y:-d}).add(this.player2),d:r,midpoint:s,p1:a,p2:o}})),this._centers.run([this.player1.x,this.player1.y,this.player2.x,this.player2.y])}init(){super.init(),this.cameras.main.startFollow(this.player1),this.events.on("update",()=>{this.updateScreen()})}shutdown(){var e,t,s,i;null==(e=this._cameraMasks)||e.p1.destroy(),null==(t=this._cameraMasks)||t.p2.destroy(),this._cameraMasks=void 0,null==(s=this._maskShapes)||s.p1.destroy(),null==(i=this._maskShapes)||i.p2.destroy(),this._maskShapes=void 0,super.shutdown()}draw(e,t){e.clear();const s=this.centers.d.clone();0===s.length()&&s.set(1,0);const i=s.clone().normalize(),n=new Phaser.Math.Vector2(-i.y,i.x),r=2*Math.max(this.scale.width,this.scale.height),a=4*Math.max(this.scale.width,this.scale.height);let o,h;1===t?(o=this.centers.center1.clone().add(n.clone().scale(r)),h=this.centers.center1.clone().add(n.clone().scale(-r))):(o=this.centers.center2.clone().add(n.clone().scale(r)),h=this.centers.center2.clone().add(n.clone().scale(-r)));const c=i.clone().scale(1===t?-a:a),l=o.clone().add(c),d=h.clone().add(c);this.debugging&&e.lineStyle(5*this.border.curr,0,1),e.lineStyle(this.border.curr,986895,1),e.beginPath(),e.moveTo(o.x,o.y),e.lineTo(l.x,l.y),e.lineTo(d.x,d.y),e.lineTo(h.x,h.y),e.closePath();const u=this.debugging?.5:0;this.maskShapes.p1.fillStyle(16711935,u),this.maskShapes.p2.fillStyle(16776960,u),e.fillPath(),e.strokePath()}drawDebug(){this.debugging&&(this.graphics??(this.graphics={center1:this.add.graphics({}),center2:this.add.graphics({}),d:this.add.graphics({}),midpoint:this.add.graphics({}),p1:this.add.graphics({}),p2:this.add.graphics({})}),this.graphics.p1.clear(),this.graphics.p1.fillStyle(16711680,1),this.graphics.p1.fillCircle(this.centers.p1.x,this.centers.p1.y,15),this.graphics.center1.clear(),this.graphics.center1.fillStyle(16711935,1),this.graphics.center1.fillCircle(this.centers.center1.x,this.centers.center1.y,5),this.graphics.p2.clear(),this.graphics.p2.fillStyle(65280,1),this.graphics.p2.fillCircle(this.centers.p2.x,this.centers.p2.y,15),this.graphics.center2.clear(),this.graphics.center2.fillStyle(16776960,1),this.graphics.center2.fillCircle(this.centers.center2.x,this.centers.center2.y,5),this.graphics.midpoint.clear(),this.graphics.midpoint.fillStyle(255,1),this.graphics.midpoint.fillCircle(this.centers.midpoint.x,this.centers.midpoint.y,5),this.graphics.d.clear(),this.graphics.d.fillStyle(65535,1),this.graphics.d.fillCircle(this.centers.d.x,this.centers.d.y,5))}onConnect(){this.player2.visible||(this.cameras.main.stopFollow(),this.player2.setVisible(!0))}onDisconnect(){this.player2.visible&&(this.cameras.main.startFollow(this.player1),this.player2.setVisible(!1))}onJoin(){!1!==this.split&&(this.cameras.main.setVisible(!0),this.playercams.p1.setVisible(!1),this.playercams.p2.setVisible(!1),this.split=!1)}onSplit(){this.split||(this.debugging||(this.cameras.main.stopFollow(),this.playercams.p1.setVisible(!0),this.playercams.p2.setVisible(!0)),this.split=!0)}updateScreen(){if(this.drawDebug(),this.player2.inputProvider.active&&!this.player2.visible&&this.onConnect(),!this.player2.inputProvider.active&&this.player2.visible&&this.onDisconnect(),!this.player2.visible)return;const e=this.centers.p1.distance(this.centers.center2)-this.centers.p1.distance(this.centers.center1);this.border.curr=e>2e3?20:e>0?.01*e:0,this.maskShapes.p1.clear(),this.maskShapes.p2.clear(),this.border.curr!==this.border.prev&&this.border.curr>0&&(this.border.prev=this.border.curr,this.maskShapes.p1.lineStyle(this.border.curr,16777215),this.maskShapes.p2.lineStyle(this.border.curr,16777215),this.playercams.p1.setZoom(40/(40+this.border.curr)),this.playercams.p2.setZoom(40/(40+this.border.curr)),this.debugging&&(this.maskShapes.p1.lineStyle(this.border.curr,16711935),this.maskShapes.p2.lineStyle(this.border.curr,16776960))),this.border.curr>0?this.onSplit():e<0&&this.onJoin(),this.split?(this.debugging?(this.cameras.main.setVisible(!0),this.playercams.p1.clearMask(),this.playercams.p2.clearMask(),this.cameras.main.centerOn(this.centers.midpoint.x,this.centers.midpoint.y)):(this.cameras.main.setVisible(!1),this.playercams.p1.setMask(this.cameraMasks.p2,!1),this.playercams.p2.setMask(this.cameraMasks.p1,!1)),this.playercams.p1.centerOn(this.centers.center2.x,this.centers.center2.y),this.playercams.p2.centerOn(this.centers.center1.x,this.centers.center1.y),this.draw(this.maskShapes.p1,1),this.draw(this.maskShapes.p2,2)):this.cameras.main.centerOn(this.centers.midpoint.x,this.centers.midpoint.y)}}const fr=320,gr=(e,t,s=1)=>{if(t&&("strength"===t&&(e.stats.attack=e.stats.attack+.05*s),"agility"===t&&(e.stats.attackspeed=e.stats.attackspeed+.05*s),"charisma"===t&&(e.health.max=e.health.max+20*s),"endurance"===t&&(e.stats.regen=e.stats.regen+.2*s),"speed"===t&&(e.stats.speed=Math.min(e.stats.speed+.1*s,2)),"critchance"===t&&void 0!==e.hitbox.magnet&&e.scene instanceof aa)){const t={height:1.1*e.hitbox.magnet.height*s,width:1.1*e.hitbox.magnet.width*s};e.hitbox.magnet.destroy(),e.hitbox.magnet=e.scene.physics.add.body(e.x-t.width/2,e.y-t.height/2,t.width,t.height),console.log(e.hitbox.magnet,e.scene.drops),e.scene.physics.add.overlap(e.hitbox.magnet,e.scene.drops,(t,s)=>{!1!==e.visible&&s instanceof Zr&&s.moveTo(e)})}for(const[,i]of e.weapons)i.levelUp(e.stats)};Phaser.Renderer.WebGL.Pipelines.MultiPipeline;class yr extends Phaser.Renderer.WebGL.Pipelines.SinglePipeline{constructor(e,t="lightshaft"){const s=e.cache.shader.get(t);if(!(s instanceof Phaser.Display.BaseShader))throw new Error(`${t} shader missing from cache`);super({fragShader:s.fragmentSrc,game:e,name:t})}onBind(e){if(super.onBind(),console.log(e),e instanceof Phaser.GameObjects.Sprite){const t=2*e.width,s=10*e.height;this.set2f("spriteDimensions",t,s),console.log(`Sprite width: ${t}, Height: ${s}`)}this.set3f("glowColor",1,.8,.3)}}class vr extends Phaser.GameObjects.Text{constructor(e,t,s,i){super(e,e.scale.width/2,e.scale.height/3,s,{...Zn,fontSize:60}),K(this,"defaultText"),K(this,"timer"),this.setOrigin(.5),this.scene.add.existing(this),this.setPosition(e.scale.width/2,e.scale.height/3+t*this.height*1.5),this.defaultText=s,i&&this.setInteraction(i)}show(){this.setVisible(!0),this.setActive(!0)}hide(){this.setVisible(!1),this.setActive(!1)}setInteraction(e){this.setInteractive().on("pointerdown",e).on("pointerover",e=>{var t;if(!(e instanceof Phaser.Input.Pointer))throw new ne;null==(t=this.timer)||t.destroy(),this.setColor("rgba(68,192,141,128)")}).on("pointerout",e=>{if(!(e instanceof Phaser.Input.Pointer))throw new ne;this.setColor("rgba(255,255,255,128)"),this.timer=this.scene.time.addEvent({callback:()=>this.text=this.defaultText,delay:1e3})})}}const br=class e{constructor(e){var t,s;K(this,"items",[]),K(this,"wipeMenu"),K(this,"wipeBorder"),K(this,"bounds"),K(this,"menu"),K(this,"border"),this.scene=e,this.border=this.scene.add.image(0,0,"menu-border",void 0).setVisible(!0),this.menu=this.scene.add.image(0,0,"menu",void 0).setVisible(!0),this.wipeBorder=null==(t=this.border.preFX)?void 0:t.addReveal(.1,0,0),this.wipeMenu=null==(s=this.menu.preFX)?void 0:s.addReveal(.1,0,0),this.bounds={bottom:0,left:this.scene.scale.baseSize.width,right:0,top:this.scene.scale.baseSize.height}}add(e,t,s){var i;(i=this.items)[t]??(i[t]=[]);let n=this.items[t].length;for(let o=0;o<t;o++){const e=this.items[o];if(!e)throw new Error;n+=e.length+1}const r=new vr(this.scene,n,e,s),a=r.getBounds();return this.bounds.top=Math.min(a.top,this.bounds.top),this.bounds.left=Math.min(a.left,this.bounds.left),this.bounds.right=Math.max(a.right,this.bounds.right),this.bounds.bottom=Math.max(a.bottom,this.bounds.bottom),this.items[t].push(r),this.upsize(),r}resize(){let t=0,s=this.scene.scale.baseSize.width,i=0,n=this.scene.scale.baseSize.height;for(const e of this.items)for(const r of e){const e=r.getBounds();n=Math.min(e.top,n),s=Math.min(e.left,s),i=Math.max(e.right,i),t=Math.max(e.bottom,t)}n-=e.MARGIN.y,s-=e.MARGIN.x,i+=e.MARGIN.x,t+=e.MARGIN.y;const r=t-n,a=i-s;this.menu.setDisplaySize(a-10,r-10),this.menu.setPosition(s+5,n+5).setOrigin(0),this.border.setDisplaySize(a,r),this.border.setPosition(s,n).setOrigin(0),this.menu.setVisible(!0),this.border.setVisible(!0)}setVisible(e){this.menu.setVisible(e),this.border.setVisible(e)}upsize(){const t=this.bounds.top-e.MARGIN.y,s=this.bounds.left-e.MARGIN.x,i=this.bounds.right+e.MARGIN.x,n=this.bounds.bottom+e.MARGIN.y-t,r=i-s;this.menu.setDisplaySize(r-10,n-10),this.menu.setPosition(s+5,t+5).setOrigin(0),this.border.setDisplaySize(r,n),this.border.setPosition(s,t).setOrigin(0),this.menu.setVisible(!0),this.border.setVisible(!0)}};K(br,"MARGIN",{x:400,y:200});let wr=br;const xr=class e{constructor(e){K(this,"background"),K(this,"_buttons"),this.scene=e,this.background=new wr(this.scene),console.log(this.buttons)}get buttons(){if(!this._buttons){const e=this.background.add("Resume",0,e=>{if(!(e instanceof Phaser.Input.Pointer))throw new ne;this.close(()=>{const e=this.scene.scene.get($n);e instanceof Ir&&e.resume()})}),t=this.background.add("Options",1,()=>{t.text="I don't have any right now\ntry the full screen button "}),s=this.background.add("Fullscreen",1,()=>{"Fullscreen"===s.defaultText?(this.scene.scale.startFullscreen(),s.defaultText="Windowed"):(this.scene.scale.stopFullscreen(),s.defaultText="Fullscreen")}),i=this.background.add("Restart",2,()=>{const e=this.scene.scene.get($n);e instanceof Ir&&e.launch(Cn)}),n=this.background.add("Switch",2);n.setInteraction(e=>{if(!(e instanceof Phaser.Input.Pointer))throw new ne;const t=this.scene.scene.get($n);t instanceof Ir&&(console.log(t.activeScene),t.activeScene===Cn?"to the useless page?"===n.text?(t.launch(Rn),n.text="Switch"):n.text="to the useless page?":"to the action?"===n.text?(t.launch(Cn),n.text="Switch"):n.text="to the action?")});const r="I was hoping you wouldn't click this one.",a="Are you sure?\nthis only works on the electron app",o=this.background.add("Exit",3);o.setInteraction(()=>{o.text===r||o.text===a?o.text===a?window.electronAPI.exit():o.text=a:o.text=r}),this._buttons={change:n,exit:o,fullscreen:s,options:t,restart:i,resume:e}}return this._buttons}open(){this.background.wipeMenu&&this.background.wipeBorder&&(this.background.wipeMenu.direction=0,this.background.wipeBorder.direction=0,this.background.wipeMenu.progress=0,this.background.wipeBorder.progress=0,this.scene.tweens.add({duration:e.WIPE_DURATION-50,hold:0,onComplete:()=>{for(const[,e]of Object.entries(this.buttons))e.setVisible(!0)},progress:1,repeat:0,repeatDelay:0,targets:this.background.wipeMenu,yoyo:!1}),this.scene.tweens.add({duration:e.WIPE_DURATION,hold:0,progress:1,repeat:0,repeatDelay:0,targets:this.background.wipeBorder,yoyo:!1}))}close(t){for(const[,e]of Object.entries(this.buttons))e.setVisible(!1);this.background.wipeMenu&&this.background.wipeBorder&&(this.background.wipeMenu.direction=1,this.background.wipeBorder.direction=1,this.background.wipeMenu.progress=1,this.background.wipeBorder.progress=1,this.scene.tweens.add({duration:e.WIPE_DURATION,hold:0,onComplete:t,progress:0,repeat:0,repeatDelay:0,targets:this.background.wipeMenu,yoyo:!1}),this.scene.tweens.add({duration:e.WIPE_DURATION-50,hold:0,progress:0,repeat:0,repeatDelay:0,targets:this.background.wipeBorder,yoyo:!1}))}};K(xr,"WIPE_DURATION",200);let kr=xr;class _r extends Phaser.Scene{constructor(){super({active:!1,key:Dn,plugins:Phaser.Plugins.DefaultPlugins.DefaultScene,visible:!1}),K(this,"background"),K(this,"logo"),K(this,"title"),K(this,"shine"),K(this,"switcher",()=>{}),K(this,"switchers",[]),K(this,"weapon",()=>{this.scene.get(Cn),this.scene.getStatus(Cn)}),K(this,"_menu")}close(){this.menu.close(()=>{const e=this.scene.get($n);e instanceof Ir&&e.resume()})}create(){this.weapon(),this.switcher(),this.menu.open(),this.events.on(Phaser.Scenes.Events.CREATE,e=>{}),this.events.on(Phaser.Scenes.Events.RESUME,(e,t)=>{e instanceof Phaser.Scenes.Systems&&e.scene instanceof _r&&(console.log("resuming main menu"),console.log(t)),this.menu.open()},this),this.events.on(Phaser.Scenes.Events.PAUSE,(e,t)=>{e instanceof Phaser.Scenes.Systems&&e.scene},this),this.cameras.main.setBackgroundColor("rgba(0,0,0,128)")}get menu(){return this._menu??(this._menu=new kr(this)),this._menu}shimmer(){this.time.addEvent({callback:()=>{if(!this.shine)return;const e=.25+.5*Math.random();this.shine.speed=e,this.menuBorder.postFX.add(this.shine),this.time.addEvent({callback:()=>{console.trace("stack"),this.shine&&this.menuBorder.postFX.remove(this.shine)},delay:2e3/e})},delay:1e3,loop:!0})}}var Pr=Object.defineProperty,Sr=Object.getOwnPropertyDescriptor;const zr=(l=class extends dr{constructor(){if(super({key:$n,plugins:Phaser.Plugins.DefaultPlugins.DefaultScene}),K(this,"activeScene",Cn),K(this,"enemies",null),K(this,"GameLayer",null),K(this,"MenuLayer",null),K(this,"shouldDrawCursor",!0),K(this,"UILayer",null),K(this,"cursors",{}),K(this,"fpses",[]),K(this,"fpsGraphic"),K(this,"fpsHistory",[[]]),K(this,"_debugGraphics"),K(this,"menuInit",!1),K(this,"menuOpen",!1),l.instance)return l.instance;l.instance=this}create(){var e;if(this.GameLayer=this.add.layer(),this.UILayer=this.add.layer(),this.MenuLayer=this.add.layer().setVisible(!1).setDepth(10),this.input.setDefaultCursor("none"),null==(e=this.input.mouse)||e.disableContextMenu(),this.game.events.on(Phaser.Core.Events.FOCUS,()=>{this.input.setDefaultCursor("none"),this.shouldDrawCursor=!0}),this.game.events.on(Phaser.Core.Events.BLUR,()=>{this.shouldDrawCursor=!1}),!this.input.keyboard)throw new Error("why no keyboard?");if(this.renderer instanceof Phaser.Renderer.WebGL.WebGLRenderer){const e=new yr(this.game);this.renderer.pipelines.add("lightshaft",e)}const{inventory:t}=this.config.load();t.player.voidGems<10&&(this.activeScene=Cn),this.scene.launch(this.activeScene),this.inputProvider.setOnPause(()=>{this.onMenu()})}get debugGraphics(){var e;return this.debugging?(this._debugGraphics??(this._debugGraphics=this.add.graphics()),this._debugGraphics):(null==(e=this._debugGraphics)||e.clear(),null)}drawCursor(){var e,t;(e=this.cursors).attack??(e.attack=this.add.sprite(0,0,"cursor-attack").setOrigin(0).setScale(.5).setVisible(!1)),(t=this.cursors).default??(t.default=this.add.sprite(0,0,"cursor-default").setOrigin(0).setScale(.5).setVisible(!1)),5===this.scene.getStatus(Dn)||this.activeScene!==Cn?(this.cursors.attack.setVisible(!1),this.cursors.default.setVisible(this.shouldDrawCursor)):(this.cursors.attack.setVisible(this.shouldDrawCursor),this.cursors.default.setVisible(!1)),this.cursors.default.setPosition(this.input.activePointer.x,this.input.activePointer.y),this.cursors.attack.setPosition(this.input.activePointer.x,this.input.activePointer.y)}follow(e){this.cameras.main.setBounds(-1e3,-1e3,this.scale.width+2e3,this.scale.height+2e3)}launch(e){this.menuOpen&&this.onResume(),this.scene.key===$n?(this.scene.stop(this.activeScene),this.scene.launch(e)):this.scene.start(e),this.activeScene=e}onPause(){this.menuInit||(this.scene.launch(Dn),this.menuInit=!0),this.scene.setActive(!0,Dn),this.scene.setVisible(!0,Dn),this.scene.setActive(!1,this.activeScene),this.menuOpen=!0}resume(){this.onResume()}update(e,t){this.drawCursor(),this.fpses.push(this.game.loop.actualFps),this.fpses.length>61&&this.fpses.shift(),this.fpsGraphic??(this.fpsGraphic=this.add.graphics().lineStyle(2,16711680,1)),this.fpsGraphic.clear().lineStyle(2,16711680,1),this.fpsGraphic.lineStyle(1,16777215,1).strokeRect(20,120,300,150),this.fpsGraphic.lineStyle(2,16711680,1).strokePoints(this.fpses.map((e,t)=>new Phaser.Geom.Point(20+5*t,120+5*(60-e))))}onMenu(){if(this.menuOpen){const e=this.scene.get(Dn);if(!(e instanceof _r))throw new Error;e.close()}else this.onPause()}onResume(){this.scene.setActive(!1,Dn),this.scene.setVisible(!1,Dn),this.scene.setActive(!0,this.activeScene),this.menuOpen=!1}},K(l,"instance"),l);((e,t,s)=>{for(var i,n=Sr(t,s),r=e.length-1;r>=0;r--)(i=e[r])&&(n=i(t,s,n)||n);n&&Pr(t,s,n)})([ae()],zr.prototype,"update");let Ir=zr;const Mr={attached:!1,bgColor:2236962,color:65280,maxValue:100,percision:0,text:!0,value:100};class Tr{constructor(e,t={}){var s;K(this,"bar"),K(this,"config"),K(this,"percision"),K(this,"player"),K(this,"text"),this.player=e;const i=.025*e.scene.scale.height,n=e.scene.scale.width/3.5-i;this.config={...Mr,height:i,width:n,x:i,y:e.scene.scale.height-i,...t,lineStyle:{alpha:.5,color:0,lineWidth:6}},this.config.lineStyle.lineWidth=Math.min(this.config.lineStyle.lineWidth,this.config.height/4),this.bar=e.scene.add.graphics(),this.config.text&&(this.text=e.scene.add.text(0,0,"",Zn).setOrigin(.5),this.text.x=this.config.x+this.config.width/2,this.text.y=this.config.y+this.config.height/2),this.config.attached?this.player.add(this.bar):(this.bar.setScrollFactor(0),null==(s=this.text)||s.setScrollFactor(0)),this.percision=10**this.config.percision,this.draw()}destroy(){var e;this.bar.destroy(),null==(e=this.text)||e.destroy()}setVisible(e){var t;this.bar.setVisible(e),null==(t=this.text)||t.setVisible(e)}update(e,t){(this.config.value!==e||this.config.maxValue!==t)&&(this.config.maxValue=t,this.config.value=Phaser.Math.Clamp(e,0,this.config.maxValue),this.draw())}draw(){this.bar.clear();const{alpha:e,color:t,lineWidth:s}=this.config.lineStyle;this.bar.lineStyle(s,t,e),this.bar.strokeRect(this.config.x-s/2,this.config.y-s/2,this.config.width+s,this.config.height+s),this.bar.fillStyle(this.config.bgColor),this.bar.fillRect(this.config.x,this.config.y,this.config.width,this.config.height);const i=this.config.value/this.config.maxValue*this.config.width;this.bar.fillStyle(this.config.color),this.bar.fillRect(this.config.x,this.config.y,i,this.config.height),this.text&&(this.text.text=`${Math.round(this.config.value*this.percision)/this.percision} / ${this.config.maxValue}`)}}class Er extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i,n,r,a){super(e,t,s,r.key),K(this,"hitbox"),K(this,"created",!1),K(this,"size"),K(this,"enemiesDamaged",new Set),K(this,"pierce",0),this.scene=e,this.direction=n,this.stats=r,this.player=a,this.size=Math.min(this.width,this.height),this.setRotation(i).setScale(1.5),e.add.existing(this),e.physics.add.existing(this),this.setCollideWorldBounds(!0)}create(){throw new Error}destroy(){var e;null==(e=this.hitbox)||e.destroy(),super.destroy()}update(e,t){var s;if(this.pierce>=this.stats.attack.projectile.pierce)return void this.destroy();this.create(),this.updateHitbox();const{height:i,left:n,top:r,width:a}=this.getBounds(),o=this.scene.physics.overlapRect(n,r,a,i);for(const h of o){const e=h.gameObject;if(e instanceof Jr&&!1!==(null==(s=e.body)?void 0:s.enable)&&!this.enemiesDamaged.has(e)){if(this.enemiesDamaged.size>=this.stats.attack.projectile.pierce)return;if(this.pierce>=this.stats.attack.projectile.pierce)break;e.dealDamage(Math.trunc(this.stats.attack.projectile.damage*this.player.stats.attack)),this.enemiesDamaged.add(e),this.pierce++}}}updateHitbox(){this.hitbox??(this.hitbox=this.scene.physics.add.body(this.x,this.y,this.size,this.size));const e=Math.cos(this.rotation)*(this.width/2),t=Math.sin(this.rotation)*(this.width/2);this.hitbox.x=this.x+e-this.hitbox.width/2,this.hitbox.y=this.y+t-this.hitbox.height/2}}const Ar={attack:{cooldown:2e3,damage:{max:40,min:30},delta:0,deviation:Math.PI/64,projectile:{damage:40,delay:400,fired:0,lifetime:2e6/1920,offsetAngle:0,pierce:2,range:{arc:Math.PI/32,distance:2e3},speed:1920,total:2,vangular:0,vx:0,vy:0}},key:"arrow"};class Cr extends Er{create(){if(this.created)return;const e=Math.cos(this.rotation),t=Math.sin(this.rotation),s=e*this.stats.attack.projectile.speed,i=t*this.stats.attack.projectile.speed;this.setVelocity(s,i),this.scene.time.addEvent({callback:()=>{this.destroy()},delay:this.stats.attack.projectile.lifetime}),this.created=!0}}const Or={attack:{cooldown:2e3,damage:{max:40,min:30},delta:0,deviation:0,projectile:{damage:40,delay:400,fired:0,lifetime:150,offsetAngle:800*Phaser.Math.DEG_TO_RAD*.15/2,pierce:Number.POSITIVE_INFINITY,range:{arc:2/3*Math.PI,distance:200},speed:3840,total:2,vangular:800,vx:0,vy:0}},key:"sword"};class Rr extends Er{create(){if(this.created)return;this.setOrigin(-.5,.5),this.setPosition(this.x-this.player.x,this.y-this.player.y),this.player.add(this),this.setVelocityX(this.stats.attack.projectile.vx),this.setVelocityY(this.stats.attack.projectile.vy),this.body instanceof Phaser.Physics.Arcade.Body&&(this.body.maxAngular=2160);const e=this.stats.attack.projectile.vangular*this.direction,t=e*(this.stats.attack.projectile.lifetime/1e3),s=Phaser.Math.DEG_TO_RAD*(t/2);this.setRotation(this.rotation-s),this.setAngularVelocity(e),this.scene.time.addEvent({callback:()=>{this.destroy()},delay:this.stats.attack.projectile.lifetime}),this.created=!0}}class $r{constructor(e){switch(K(this,"stats"),K(this,"defaultStats"),e){case"arrow":this.defaultStats=Ar,this.stats=structuredClone(Ar);break;case"sword":this.defaultStats=Or,this.stats=structuredClone(Or);break;default:throw new Error("invalid projectile")}}levelUp(e){this.stats.attack.projectile.offsetAngle=this.defaultStats.attack.projectile.offsetAngle/e.accuracy,this.stats.attack.projectile.delay=this.defaultStats.attack.projectile.delay/e.attackspeed,this.stats.attack.cooldown=this.defaultStats.attack.cooldown/e.attackspeed;const t=1e3*this.stats.attack.projectile.range.arc/(this.stats.attack.projectile.vangular*Phaser.Math.DEG_TO_RAD),s=1e3*this.stats.attack.projectile.range.distance/this.stats.attack.projectile.speed;this.stats.attack.projectile.lifetime=Math.max(t,s)}}class Dr extends $r{constructor(e,t,s){super(t),K(this,"arc"),K(this,"cone"),K(this,"projectiles"),this.scene=e,this.projectile=t,this.player=s,this.projectiles=this.scene.physics.add.group(),this.projectiles.runChildUpdate=!0,this.cone=this.scene.add.graphics({fillStyle:{alpha:.05,color:0},lineStyle:{alpha:.1,color:16711935,width:4}}),this.arc=this.scene.add.graphics({fillStyle:{alpha:0,color:0},lineStyle:{alpha:.5,color:16777215,width:4}})}cooldown({targetX:e,targetY:t}){if(this.arc.clear(),!this.player.inputProvider.aiming)return;const{attack:s}=this.stats,i=s.cooldown,n=1-Math.min(s.delta/i,1),r=2*Math.PI*n;this.arc.arc(e,t,50,0,r,!1).strokePath().fillPath()}update(e,t){const{attack:s}=this.stats,{projectile:i}=s;s.delta+=t;const n=i.fired%2==0?-1:1,r=this.position(n*this.stats.attack.projectile.offsetAngle,e);if(this.aim(r),s.delta>=s.cooldown+i.delay*i.fired){i.fired++,this.attack(r);let e="";e=i.fired%2==0?`${this.player.textureKey}_${"arrow"===this.player.active_weapon?"archer":"warrior"}_attack1`:`${this.player.textureKey}_${"arrow"===this.player.active_weapon?"archer":"warrior"}_attack2`,this.player.player.play(e),i.fired>=i.total&&(s.delta=0,i.fired=0)}this.cooldown(r)}aim({angles:{target:e}}){if(this.cone.clear(),!this.player.inputProvider.aiming)return;const{arc:t,distance:s}=this.stats.attack.projectile.range;this.cone.beginPath(),this.cone.arc(this.player.x,this.player.y,s,e-t/2,e+t/2,!1).strokePath().lineTo(this.player.x,this.player.y).fillPath()}attack({angles:{actual:e},x:t,y:s}){const{projectile:i}=this.stats.attack,n=i.fired%2==0?-1:1;if("sword"===this.projectile){const i=new Rr(this.scene,t,s,e,n,this.stats,this.player);this.projectiles.add(i)}else{const i=new Cr(this.scene,t,s,e,0,this.stats,this.player);this.projectiles.add(i)}}position(e,t){const{angle:s,x:i,y:n}=this.player.target(t),r=e+s,a=Math.random()*this.stats.attack.deviation*2-this.stats.attack.deviation,o=s+a,h=Math.cos(o),c=Math.sin(o);return{angles:{actual:o,deviation:a,offset:r,target:s},targetX:i,targetY:n,vx:h*this.stats.attack.projectile.speed,vy:c*this.stats.attack.projectile.speed,x:this.player.x+40*h,y:this.player.y+40*c}}}class Nr{constructor(e){K(this,"items",new Set),X(this,d),X(this,u),this.player=e,this.player.scene.time.addEvent({callback:()=>{var e,t;null==(e=L(this,d))||e.clear(),null==(t=L(this,u))||t.setVisible(!1),this.player.inputProvider.removeAllInteract();for(const s of this.items)s.setAlpha(.5)},delay:100,loop:!0})}set text(e){this.lootText.text=e}clear(){this.lootMenu.clear(),this.lootText.setVisible(!1)}link(e){var t;this.lootMenu.clear(),e.siblings.forEach(e=>{this.lootMenu.lineStyle(5,16711680);const t=e.getBounds();this.lootMenu.lineBetween(t.centerX-24,t.centerY-24,t.centerX+24,t.centerY+24),this.lootMenu.lineBetween(t.centerX+24,t.centerY-24,t.centerX-24,t.centerY+24),e.siblings.forEach(t=>{this.lootMenu.lineStyle(5,0,.25),this.lootMenu.lineBetween(e.x,e.y,t.x,t.y)})}),null==(t=L(this,d))||t.stroke();const s=200;this.lootMenu.fillStyle(0,1),this.lootMenu.lineStyle(5,16777215),this.lootMenu.fillRect(e.x-175,e.y-s-100,350,s),this.lootMenu.strokeRect(e.x-175,e.y-s-100,350,s),this.lootText.setPosition(e.x,e.y-s),this.lootText.setVisible(!0),e.alpha=1,e.siblings.forEach(e=>{e.alpha=.25,this.items.add(e)}),this.items.add(e)}get lootMenu(){return void 0===L(this,d)&&(Y(this,d,this.player.scene.add.graphics()),this.player.scene.layers.ui.add(L(this,d))),L(this,d)}get lootText(){return void 0===L(this,u)&&(Y(this,u,this.player.scene.add.text(0,0,"",Zn).setOrigin(.5)),this.player.scene.layers.ui.add(L(this,u))),L(this,u)}}d=new WeakMap,u=new WeakMap;let jr=class extends Phaser.Physics.Arcade.Sprite{constructor(e,t,s,i){super(e,t,s,i,0),this.scene=e,this.scene.add.existing(this),this.scene.layers.player.add(this),this.setOrigin(.5)}};const Fr=class e extends Phaser.GameObjects.Container{constructor(t,s,i,n){super(t,t.scale.baseSize.width/2+128*n,t.scale.baseSize.height/2),K(this,"active_weapon"),K(this,"alive",!0),K(this,"damagedAt",0),K(this,"dashing",!1),K(this,"health",{curr:10,max:10}),K(this,"hitbox",{}),X(this,p,0-e.IFRAME_DURATION),X(this,m,!1),K(this,"inventory"),K(this,"level",1),K(this,"num"),K(this,"stats",{accuracy:1,attack:1,attackspeed:1,critChance:0,critDamage:0,range:1,regen:0,speed:1}),X(this,f,new Map),X(this,g),K(this,"weapons",new Map),K(this,"xp",{curr:0,max:5}),K(this,"dashCooldown",e.DASH_COOLDOWN),K(this,"dashStart",-5e3),K(this,"graphics"),K(this,"lastHpUpdate",0),X(this,y),X(this,v),X(this,b,null),K(this,"_inventoryUI"),X(this,w),X(this,x),K(this,"_reticle"),K(this,"_spawnCurves"),K(this,"_curve"),X(this,k),X(this,_),X(this,P),this.scene=t,this.textureKey=s,this.config=i,this.scene instanceof aa&&this.add(this.reticle),this.add(this.player),this.num=n,this.graphics=this.scene.add.graphics(),this.graphics.lineStyle(2,16711680,1),this.add(this.graphics),t instanceof aa&&(this.weapons.set("sword",new Dr(t,"sword",this)),this.weapons.set("arrow",new Dr(t,"arrow",this)));const{inventory:r,upgrades:a}=this.scene.config.load();this.inventory=r.player,this.stats.accuracy=this.stats.accuracy+this.stats.accuracy*a.agility.bonus,this.stats.attack=this.stats.attack+this.stats.attack*a.strength.bonus,this.stats.attackspeed=this.stats.attackspeed+this.stats.attackspeed*a.agility.bonus,this.stats.speed=this.stats.speed+this.stats.speed*a.speed.bonus,this.stats.regen=this.stats.regen+this.stats.regen*a.endurance.bonus,this.health.max=this.health.max+this.health.max*a.charisma.bonus,this.health.curr=this.health.max,this.scene.physics.add.existing(this),this.scene.layers.player.add(this)}get hpbar(){if(!(this.scene instanceof aa))return null;if(!1===this.visible)return null;if(!L(this,y)){const e=26,t=52,s=this.scene.scale.width/3.5-e,i=0===this.num?0:130-this.scene.scale.height,n=(0===this.num?0:this.scene.scale.width-s-2*e)+e,r=i+this.scene.scale.height-2*e-t;Y(this,y,new Tr(this,{color:16711680,height:t,percision:1,width:s,x:n,y:r}))}return L(this,y)}get inputProvider(){return L(this,v)??Y(this,v,new Hn(this.scene,this,this.config)),L(this,v)}get interceptionPoint(){return L(this,b)}get inventoryUI(){return this.scene instanceof aa?(this._inventoryUI??(this._inventoryUI=this.scene.add.container()),this._inventoryUI):null}get lootMenu(){return L(this,w)??Y(this,w,new Nr(this)),L(this,w)}get player(){return L(this,x)??Y(this,x,new jr(this.scene,0,0,"blue_warrior_idle")),L(this,x)}get reticle(){return this._reticle||(this._reticle=this.scene.add.sprite(0,0,"reticle").setOrigin(.5),this.scene.layers.game.add(this._reticle)),this._reticle.setVisible(void 0!==this.active_weapon),this._reticle}get spawnCurves(){return this._spawnCurves??(this._spawnCurves=[new Phaser.Curves.Ellipse(0,0,this.scene.scale.height/2,this.scene.scale.height/2),new Phaser.Curves.Ellipse(0,0,this.scene.scale.height/2+100,this.scene.scale.height/2+100),new Phaser.Curves.Ellipse(0,0,this.scene.scale.height/2+200,this.scene.scale.height/2+200)]),this._spawnCurves}get curve(){return this._curve??(this._curve=new Phaser.Curves.Ellipse(0,20,50,20)),this._curve}get dashbar(){if(!1===this.visible)return null;if(!L(this,k)){const{height:e,width:t}=this.getBounds();Y(this,k,new Tr(this,{attached:!0,color:16777215,height:t/32,text:!1,width:t/4,x:-t/8,y:e/4}))}return L(this,k)}get inventoryVoidGems(){if(0===this.inventory.voidGems)return null;const e=0===this.num?200:-this.scene.scale.height-200,t=0===this.num?48:this.scene.scale.width-48;return L(this,_)||Y(this,_,{sprite:this.scene.add.sprite(t+0,e,"static-void-gem").setScale(.5).setOrigin(.5).setScrollFactor(0),text:this.scene.add.text(t+48,e,this.inventory.voidGems.toString(),Zn).setOrigin(.5).setScrollFactor(0)}),L(this,_)}get xpbar(){if(!(this.scene instanceof aa))return null;if(!1===this.visible)return null;const e=0===this.num?0:130-this.scene.scale.height;if(!L(this,P)){const t=52,s=26,i=26,n=t,r=e+this.scene.scale.height-s-i,a=this.scene.scale.width-2*t;Y(this,P,new Tr(this,{color:16777215,height:i,percision:0,width:a,x:n,y:r}))}return L(this,P)}applyDamage(t,s){this.health.curr-=s,Y(this,p,t),this.flickerSprite(this.player,e.IFRAME_DURATION/2)}destroy(e){var t,s,i,n,r,a;null==(t=L(this,v))||t.destroy(),Y(this,v,void 0),null==(s=L(this,x))||s.destroy(e),null==(i=this._reticle)||i.destroy(e),this._reticle=void 0,Y(this,x,void 0),null==(n=this.hitbox.enemy)||n.destroy(),null==(r=this.hitbox.loot)||r.destroy(),null==(a=this.hitbox.magnet)||a.destroy(),this.hitbox={},Y(this,m,!1),super.destroy(e)}die(){this.scene.config.saveInventory({player:this.inventory}),this.scene.scene.start(Rn),Ir.instance&&(Ir.instance.activeScene=Rn),this.alive&&(this.alive=!1)}getBounds(e){return this.player.getBounds(e)}getInterceptionVector(e,t){if(t<0)throw new Error("this breaks all of physics");const s={x:this.x,y:this.y};if(e<80)return s;const i=Math.min(4,Math.trunc(e/80)-1),n=this.getTargetCurve(80*i).getPointAt(t);return s.x+=n.x,s.y+=n.y,s}getTargetCurve(e){L(this,g)||(Y(this,g,this.scene.add.graphics().lineStyle(1,16711680)),this.add(L(this,g)));let t=L(this,f).get(e);return t||(t=new Phaser.Curves.Ellipse(0,0,e,e),L(this,f).set(e,t)),this.scene.debugging&&t.draw(L(this,g)),t}initialize(){L(this,m)||!1!==this.visible&&(this.scene instanceof aa&&this.scene.lootManager.spawn({x:this.x,y:this.y-128},[{owner:this,type:Ta.SwordPickup}]),Y(this,m,!0))}levelUp(e,t=1){this.xp.curr>=this.xp.max&&(this.xp.curr=this.xp.curr%this.xp.max,this.xp.max=this.xp.max+5,this.level+=1,this.scene instanceof aa&&this.scene.lootManager.spawn({x:this.x,y:this.y-200},[{owner:this,type:Ta.StatDrop}]),gr(this,e,t))}target(e){if(!(this.scene instanceof aa))throw new Error("shouldn't be getting called in this scene");const t=this.inputProvider.target(this,this.scene.enemies);this.scene.debugging&&this.curve.draw(this.graphics,64);const{x:s,y:i}=this.curve.getPoint(t.angle/(2*Math.PI));return this.reticle.setRotation(t.angle).setPosition(s,i),t}update(t,s){var i;if(this.initialize(),this.physics(),this.updateInterceptionPoint(),!1===this.visible?this.inputProvider.refresh():this.inputProvider.update(t,s),this.updateResources(),this.hp(t,s),void 0!==this.active_weapon){const e=this.weapons.get(this.active_weapon);e&&this.visible&&e.update(t,s)}if(!(this.body instanceof Phaser.Physics.Arcade.Body))return;const[n,r]=this.inputProvider.position();this.inputProvider.dashing&&(this.inputProvider.dashing=!1,this.dashStart+this.dashCooldown<t&&(0!==n||0!==r)&&(this.dashStart=t)),null==(i=this.dashbar)||i.update(t-this.dashStart,this.dashCooldown),this.dashing=this.dashStart+200>t,this.body.checkCollision.none=L(this,p)+e.IFRAME_DURATION>t,this.dashing&&!this.body.checkCollision.none&&(this.body.checkCollision.none=!0,Y(this,p,t));let a=fr*this.stats.speed;this.dashing&&(a*=5),n<0?this.player.flipX=!0:n>0&&(this.player.flipX=!1);let o="blue_warrior_idle";o=0===n&&0===r?`${this.textureKey}_${"arrow"===this.active_weapon?"archer":"warrior"}_idle`:`${this.textureKey}_${"arrow"===this.active_weapon?"archer":"warrior"}_run`,this.player.anims.getName().includes("attack")&&this.player.anims.isPlaying||this.player.anims.getName()===o||(this.player.setTexture(o),this.player.play(o,!0));const h=a*n,c=a*r;this.body instanceof Phaser.Physics.Arcade.Body&&this.body.setVelocity(h,c)}updateInventory(e){var t;const s=0===this.num?-150:150-this.scene.scale.height,i=0===this.num?40:this.scene.scale.width-40,n=0===this.num?-1:1,r=0===this.num?1:-1,a=this.scene.add.sprite(i+40*r*(this.inventory.plants.length%30),s+this.scene.scale.height+40*n*Math.floor(this.inventory.plants.length/30),"crops",e).setScale(3).setScrollFactor(0);null==(t=this.inventoryUI)||t.add(a),this.inventory.plants.push(e),this.scene.config.save({lastPlayed:Date.now()})}updateResources(){var e,t;this.inventoryVoidGems&&(this.inventoryVoidGems.text.text=this.inventory.voidGems.toString()),this.scene instanceof aa&&(this.levelUp(),null==(e=this.xpbar)||e.update(this.xp.curr,this.xp.max),null==(t=this.hpbar)||t.update(this.health.curr,this.health.max),this.health.curr<=0&&this.die())}flickerSprite(e,t){let s=0;const i=this.scene.time.addEvent({callback:()=>{e.visible=!e.visible,e.tint=16711680,s+=50,s>=t&&(e.visible=!0,e.tint=16777215,i.remove())},callbackScope:this,delay:50,loop:!0})}hp(e,t){this.health.curr<this.health.max?this.health.curr+=this.stats.regen*(t/1e3):(this.lastHpUpdate+=t,this.lastHpUpdate>1e3&&this.health.curr<this.health.max&&(this.health.curr+=this.stats.regen,this.lastHpUpdate=0))}physics(){if(!(this.body instanceof Phaser.Physics.Arcade.Body))throw new Error;if(this.body.enable!==this.visible&&(this.body.enable=this.visible),!1===this.body.enable)return;if(void 0===this.hitbox.loot){this.body.setOffset(-32,-32),this.body.setCircle(32);const e=this.scene.physics.add.body(this.x-16,this.y-16,32,32).setCircle(16);this.hitbox.loot=e,this.scene instanceof aa&&(console.log(e,this.scene.drops),this.scene.physics.add.overlap(e,this.scene.drops,(e,t)=>{!1!==this.visible&&t instanceof Zr&&t.handleCollision(this)}))}else this.hitbox.loot.x=this.x-16,this.hitbox.loot.y=this.y-16;if(this.scene instanceof aa){if(void 0===this.hitbox.magnet){const e={height:256,width:256},t=this.scene.physics.add.body(this.x-e.width/2,this.y-e.height/2,e.width,e.height).setCircle(e.width/2);this.hitbox.magnet=t,console.log(t,this.scene.drops),this.scene.physics.add.overlap(t,this.scene.drops,(e,t)=>{!1!==this.visible&&t instanceof Zr&&t.moveTo(this)})}this.hitbox.magnet.x=this.x-this.hitbox.magnet.width/2,this.hitbox.magnet.y=this.y-this.hitbox.magnet.height/2}}updateInterceptionPoint(){if(!this.body)return;if(0===this.body.velocity.x&&0===this.body.velocity.y)return void Y(this,b,null);const e=Math.atan2(this.body.velocity.y,this.body.velocity.x);Y(this,b,(e/(2*Math.PI)+1)%1)}};p=new WeakMap,m=new WeakMap,f=new WeakMap,g=new WeakMap,y=new WeakMap,v=new WeakMap,b=new WeakMap,w=new WeakMap,x=new WeakMap,k=new WeakMap,_=new WeakMap,P=new WeakMap,K(Fr,"SPEED",fr),K(Fr,"DASH_COOLDOWN",5e3),K(Fr,"IFRAME_DURATION",500);let Gr=Fr;const Wr=["strength","endurance","agility","critchance","charisma","speed"];class Vr{constructor(e,t,s,i,n,r,a){K(this,"drop"),this.scene=e,this.drop=new Zr({frame:n,handleCollision:a,handleInteraction:void 0,key:i,scene:e,type:r,x:t,y:s})}}S=new WeakMap;let Zr=class e extends Ln{constructor({frame:e,handleCollision:t,handleInteraction:s,key:i,scene:n,type:r,x:a,y:o}){super(n,a,o,i,e),K(this,"handleCollision"),K(this,"handleInteraction"),K(this,"onCancel",e=>{}),K(this,"onInteract",e=>{this.handleInteraction&&this.handleInteraction(e)}),K(this,"onSelect",e=>{}),K(this,"owner"),X(this,S,!1),K(this,"promptKey",this.constructor.name),K(this,"prompts",[{kbm:{color:16711935,frame:"keyboard_e"},text:"Select",xbox:{color:16777215,frame:"xbox_button_color_x"}}]),K(this,"rarity",1),K(this,"scene"),K(this,"siblings",[]),K(this,"subtype"),K(this,"target",null),K(this,"type"),K(this,"onArrival"),K(this,"travelRemaining",2e3),this.subtype=i,this.scene=n,this.type=r,this.handleCollision=e=>{t(e,this)},s&&(this.handleInteraction=e=>{s(e,this)}),this.scene.drops.add(this),this.scene.layers.game.add(this),this.setDepth(this.getBottomCenter().y),this.body,Phaser.Physics.Arcade.Body}static isInstanceOf(t){return t instanceof e}destroy(e=!1){e&&this.siblings.forEach(e=>{e.destroy(!1)}),this.setActive(!1),this.body&&(this.body.enable=!1),this.setVisible(!1),this.target=null,super.destroy()}moveTo(e,t){if(null!==this.target)return;if(void 0!==this.handleInteraction)return;this.onArrival=t,this.target=e;const s=Phaser.Math.Distance.Between(e.x,e.y,this.x,this.y);this.travelRemaining=Math.min(s,2e3)}update(e,t){var s,i,n;if(this.physics(),0!==(null==(s=this.body)?void 0:s.velocity.x)&&(null==(i=this.body)||i.velocity.y),this.target){if(25===this.travelRemaining)return this.scene.physics.moveToObject(this,this.target,0,0),this.target=null,void(null==(n=this.onArrival)||n.call(this,this));this.scene.physics.moveToObject(this,this.target,300,this.travelRemaining),this.travelRemaining=Math.max(25,this.travelRemaining-t)}}physics(){if(L(this,S))return;if(!(this.body instanceof Phaser.Physics.Arcade.Body))return;this.scene instanceof aa?this.body.setDrag(640):(this.body.setDamping(!0),this.body.setDrag(.1),this.body.setBounce(.75));let e=Math.min(this.width,this.height);void 0===this.handleInteraction?e*=.25:e*=.75;const t=this.width/2-e,s=this.height/2-e;this.body.setCircle(e,t,s),Y(this,S,!0)}};class Br{constructor(e){K(this,"getSiblingUsed",()=>0),K(this,"DropClass",Zr),K(this,"group"),K(this,"handleCollision"),K(this,"handleInteraction"),K(this,"keys"),K(this,"metadata"),K(this,"scene"),this.scene=e.scene,this.group=this.scene.physics.add.group({maxSize:e.metadata.maxSize}),this.handleCollision=e.handleCollision,this.handleInteraction=e.handleInteraction,this.keys=e.keys,this.metadata=e.metadata}get items(){const e=[],t=this.group.getMatching();for(const s of t)s instanceof this.DropClass&&e.push(s);return e}get size(){return this.group.getTotalUsed()}clear(){this.group.clear(!0,!0)}spawn(e,t,s,i,n,r){let a=this.getFirstDead(t,s);if(!a){const r=this.group.getTotalUsed()+this.getSiblingUsed();if(!(!0===e&&r<this.metadata.maxSize))return a;a=this.create(t,s,i,n)}return a.setActive(!0),""!==this.keys.play&&a.play(this.keys.play),void 0!==r&&a.play(r),a.setVisible(!0),a}spawnGroup(e,t){const s=[];for(const i of e){const e=this.spawn(!0,i.x,i.y,i.frame,i.type,i.play);e&&s.push(e)}for(const i of s){i.owner=t;for(const e of s)i!==e&&i.siblings.push(e)}return s}create(e,t,s,i){const n=new this.DropClass({frame:s,handleCollision:this.handleCollision,handleInteraction:this.handleInteraction,key:this.keys.sprite,scene:this.scene,type:i,x:e,y:t});return n.setScale(this.metadata.scale),this.group.add(n),this.items.push(n),n}getFirstDead(e,t){const s=this.group.getFirstDead(!1,e,t);if(s instanceof this.DropClass)return s}}class Ur extends Vr{constructor(e,t,s,i){if(!1===Jn.includes(i))throw new Error("invalid xp amount");const n=`${Qn}${i}`;super(e,t,s,n,"",n,(e,t)=>{e.xp.curr+=this.amount,t.destroy()}),this.scene=e,this.amount=i,this.drop.setScale(.5),this.drop.play(`${n}-float`)}collapse(){const e=this.scene.physics.overlapCirc(this.x,this.y,250),t=new Set;for(const s of e){const e=s.gameObject;if(e instanceof Ur&&e.amount===this.amount&&(t.add(e),5===t.size)){const e=5*this.amount;this.drop.setTexture(`${Qn}${e}`),this.drop.play(`${Qn}${e}-float`),this.amount=e;for(const s of t)s!==this&&s.destroy();t.clear(),this.collapse()}}}}const Kr=[{chance:.73375,chanceLoot:0,dmg:1,glow:16777215,health:1,prefxPadding:16,rarity:"common",required:5,size:1},{chance:.195,chanceLoot:.25,dmg:1.2,glow:2031360,health:1.2,prefxPadding:16,rarity:"uncommon",required:10,size:1.5},{chance:.0525,chanceLoot:.5,dmg:1.5,glow:28927,health:1.5,prefxPadding:16,rarity:"rare",required:25,size:1.8},{chance:.014,chanceLoot:.75,dmg:2,glow:10696174,health:2,prefxPadding:16,rarity:"epic",required:100,size:1.8},{chance:.00375,chanceLoot:1,dmg:3,glow:16744448,health:3,prefxPadding:16,rarity:"legendary",required:500,size:2},{chance:.001,chanceLoot:1,dmg:5,glow:16711680,health:5,prefxPadding:16,rarity:"mythic",required:1e3,size:2.5}];let Hr=0;const Lr=new Set(["common","uncommon","rare","epic","legendary"]);for(const Fa of Kr){Lr.delete(Fa.rarity);const e=Math.round(1e5*(Hr+Fa.chance))/1e5;Fa.rand=[Hr,e],Hr=e}if(1!==Hr)throw new Error(`sum ${Hr} is incorrect`);if(0!==Lr.size)throw new Error("missing rarity");var Xr=Object.defineProperty,Yr=Object.getOwnPropertyDescriptor;const qr=(z=class extends Phaser.GameObjects.Container{constructor(e,t,s){if(super(e,0,0),K(this,"applyDamage",null),K(this,"body",null),K(this,"dmg",{max:0,min:0}),K(this,"health",{curr:0,max:0,prev:0}),K(this,"healthBar",null),K(this,"id",crypto.randomUUID().slice(-4)),X(this,I,Math.random()),K(this,"glow",{common:void 0,epic:void 0,legendary:void 0,mythic:void 0,rare:void 0,uncommon:void 0}),K(this,"hp"),K(this,"lastDmgTime",0),K(this,"rarities"),K(this,"rarity"),K(this,"sprite"),K(this,"target",null),K(this,"updated",z.UPDATE_FREQ),this.scene=e,this.info=t,this.manager=s,this.sprite=this.scene.add.sprite(0,0,t.TEXTURE_KEY).setOrigin(.5),this.hp=this.scene.add.graphics(),this.add(this.sprite),this.add(this.hp),this.health={curr:t.stats.health,max:t.stats.health,prev:t.stats.health},this.dmg={max:this.info.stats.damage,min:this.info.stats.damage},this.scene.layers.game.add(this),!Kr[0])throw new Error("RARITIES is not set?");this.rarities=[{...Kr[0]}],this.rarity=Kr[0],this.scene.enemies.add(this)}damage(e){!this.scene.debugging&&this.applyDamage&&(this.lastDmgTime<e-this.info.stats.attackSpeed&&(this.lastDmgTime=e,this.scene[this.applyDamage].applyDamage(e,this.dmg.min)),this.applyDamage=null)}dealDamage(e){this.health.curr-=e;const t=this.scene.damageText.getFirstDead(!0,this.x,this.y-40);t instanceof Phaser.GameObjects.Text&&(t.text=e.toString()),this.healthbar()}die(){this.id;const e=this.x,t=this.y;this.toggle(!1);const s=1-this.rarity.chance,i=(this.rarity.chance,this.rarity.chanceLoot,Math.random()),n=[];i<this.info.loot.loot&&n.push({owner:1===this.info.loot.loot?this.manager.player:void 0,type:Ta.StatDrop}),i<this.info.loot.void&&n.push({type:Ta.VoidDrop}),this.scene.lootManager.spawn(this,n),i>s&&(Math.random(),new Ur(this.scene,e,t+1,this.info.loot.xp))}findPlayer(e,t){this.scene.player2.visible?this.scene.player1.body instanceof Phaser.Physics.Arcade.Body&&this.scene.player2.body instanceof Phaser.Physics.Arcade.Body&&(this.scene.physics.closest(this,[this.scene.player1.body,this.scene.player2.body])===this.scene.player2.body?this.target=this.scene.player2:this.target=this.scene.player1):this.target=this.scene.player1}move(e,t){if(this.updated<z.UPDATE_FREQ)return void(this.updated+=t);if(this.findPlayer(e,t),!this.target)return;const s=Phaser.Math.Distance.BetweenPoints(this,this.target);if(s<this.info.stats.range)return;this.updated=0;const i=this.target.getInterceptionVector(s,L(this,I)),n=Phaser.Math.Clamp(s/(2*Gr.SPEED),1,1.5);this.scene.physics.moveToObject(this,i,this.info.stats.moveSpeed*n),this.body instanceof Phaser.Physics.Arcade.Body&&(this.sprite.flipX=this.body.velocity.x<0)}spawn(e,t,s,i=1){var n,r;this.updateRarityData(),Y(this,I,s),this.target=e;const a=Math.random(),o=this.rarities.find(e=>void 0!==e.rand&&a>e.rand[0]&&a<e.rand[1])??this.rarities[0];if(!o)throw new Error(`${a}`);for(const[c,l]of Object.entries(this.glow))l&&(c===o.rarity?l.setActive(!0):l.setActive(!1));this.glow[o.rarity]||16777215===o.glow||(null==(n=this.sprite.preFX)||n.setPadding(o.prefxPadding),this.glow[o.rarity]=null==(r=this.sprite.preFX)?void 0:r.addGlow(o.glow));const h=this.info.stats.health*1.02**(i-1)*o.health;this.dmg={max:this.info.stats.damage*o.dmg,min:this.info.stats.damage*o.dmg},this.health.curr=h,this.health.max=h,this.sprite.setScale(o.size),this.scene.time.delayedCall(100,()=>{if(!(this.body instanceof Phaser.Physics.Arcade.Body))throw new Error("this makes life hard");{const e=this.sprite.width/3;this.body.setSize(e/2,e/2),this.body.setOffset(-e/4,-e/4),this.hp.setPosition(-e/4,-e/2)}}),this.setPosition(this.target.x+t.x,this.target.y+t.y),this.toggle(!0)}update(e,t){var s;!1!==(null==(s=this.body)?void 0:s.enable)&&(this.move(e,t),this.damage(e),this.sprite.anims.getName()!==this.info.FRAMES.MOVE.key&&this.sprite.play(this.info.FRAMES.MOVE,!0))}healthbar(){if(this.hp.clear(),this.health.curr<=0)return void this.die();if(this.health.curr===this.health.max||this.health.curr<=0)return;this.hp.fillStyle(2236962,1),this.hp.fillRect(this.hp.x,this.hp.y,z.HEALTH_WIDTH,z.HEALTH_HEIGHT);const e=z.HEALTH_WIDTH/this.health.max;this.hp.fillStyle(16711680,.5),this.hp.fillRect(this.hp.x,this.hp.y,Phaser.Math.Clamp(this.health.curr*e,0,z.HEALTH_WIDTH),z.HEALTH_HEIGHT)}toggle(e){this.setActive(e),this.setVisible(e),this.body instanceof Phaser.Physics.Arcade.Body&&(this.body.setVelocity(0,0),this.body.setEnable(e),this.body.debugShowBody=e)}updateRarityData(){const e=this.rarities[this.rarities.length-1];if(!e)throw new Error("");if("mythic"!==e.rarity)if(0===e.required){const e=Kr[this.rarities.length];if(!e)throw new Error("");this.rarities.push({...e})}else e.required--}},I=new WeakMap,K(z,"HEALTH_HEIGHT",10),K(z,"HEALTH_WIDTH",64),K(z,"UPDATE_FREQ",100),z);((e,t,s)=>{for(var i,n=Yr(t,s),r=e.length-1;r>=0;r--)(i=e[r])&&(n=i(t,s,n)||n);n&&Xr(t,s,n)})([(()=>{const e=new WeakMap;return(t,s,i)=>{const n=i.value;if(0==("function"==typeof(r=n)&&2===r.length))throw new Error("you fucked up a decorator dawg");var r;return i.value=function(t,s){const i=e.get(this)??0;t>5e3*i&&(e.set(this,i+1),this.constructor.name),n.call(this,t,s)},i}})()],qr.prototype,"findPlayer");let Jr=qr;class Qr extends Phaser.Physics.Arcade.Group{constructor(e,t){super(e.scene.physics.world,e.scene,t.config),X(this,M),K(this,"info"),K(this,"manager"),K(this,"scene"),K(this,"ROW_SIZE",4),this.manager=e,this.info=t,this.scene=e.scene,this.runChildUpdate=!0}spawn(e,t){let s;s=null!==t.interceptionPoint?(t.interceptionPoint+.1*Math.random())%1:Math.random();const i=Math.PI/256;let n=t.spawnCurves[0];for(let r=0;r<e;r++){r>=this.ROW_SIZE?n=t.spawnCurves[1]:r>=2*this.ROW_SIZE&&(n=t.spawnCurves[2]);const e=q(this,M,T).call(this),a=(s+i*Math.trunc(r/this.ROW_SIZE))%1,o=n.getPoint(a);e.spawn(t,o,a)}return this}}M=new WeakSet,T=function(){const e=this.getFirstDead(!1);if(e instanceof Jr)return e;if(this.isFull())throw new Error("factory fulll");const t=new Jr(this.scene,this.info,this.manager);return this.add(t),t};const ea=[{config:{maxSize:200},frameRate:10,FRAMES:{ATTACK:{config:{end:18,start:13},key:"torch-attack"},IDLE:{config:{end:6,start:0},key:"torch-idle"},MOVE:{config:{end:11,start:7},key:"torch-move"}},loot:{loot:.01,void:.05,xp:1},metadata:{lastSpawn:-5e3,spawn:[{count:[2,2,2,3,3],max:25,rate:5e3,start:5},{count:[1],max:50,rate:2e3,start:5},{count:[3,5,7],max:50,rate:2500,start:20},{count:[3,3,4,5,5,5,6,7,7],max:100,rate:2500,start:40},{count:[1,1,2,3,3],max:100,rate:500,start:60},{count:[4,6,8],max:150,rate:1e3,start:90},{count:[2,3,3,4,5,5,6],max:200,rate:1e3,start:120},{count:[2,2,3,3,3],max:200,rate:2500,start:150},{count:[3],max:200,rate:1e3,start:180},{count:[3],max:200,rate:750,start:240},{count:[3],max:200,rate:500,start:300}]},stats:{attackSpeed:400,damage:5,health:80,level:1,moveSpeed:288,range:100},TEXTURE_KEY:"torch"},{config:{maxSize:50},frameRate:10,FRAMES:{ATTACK:{config:{end:18,start:13},key:"barrel-attack"},IDLE:{config:{frames:[0]},key:"barrel-idle"},MOVE:{config:{frames:[6,7,8,9,10,11,12,18,19,20,21,22,23]},key:"barrel-move"}},loot:{loot:.1,void:.15,xp:5},metadata:{lastSpawn:0,spawn:[{count:[0],max:0,rate:Number.POSITIVE_INFINITY,start:120},{count:[0],max:0,rate:Number.POSITIVE_INFINITY,start:180},{count:[1],max:15,rate:2e3,start:240},{count:[1],max:25,rate:1e3,start:300},{count:[1],max:50,rate:100,start:360},{count:[1],max:75,rate:750,start:420},{count:[1],max:100,rate:500,start:480}]},stats:{attackSpeed:800,damage:20,health:250,level:2,moveSpeed:fr/3,range:100},TEXTURE_KEY:"barrel"},{config:{maxSize:25},frameRate:10,FRAMES:{ATTACK:{config:{end:20,start:14},key:"tnt-attack"},IDLE:{config:{end:5,start:0},key:"tnt-idle"},MOVE:{config:{end:12,start:7},key:"tnt-move"}},loot:{loot:.1,void:.15,xp:25},metadata:{lastSpawn:0,spawn:[{count:[0],max:0,rate:Number.POSITIVE_INFINITY,start:240},{count:[0],max:0,rate:Number.POSITIVE_INFINITY,start:300},{count:[0],max:0,rate:Number.POSITIVE_INFINITY,start:360},{count:[0],max:0,rate:Number.POSITIVE_INFINITY,start:420},{count:[1],max:15,rate:2e3,start:480},{count:[1],max:25,rate:1e3,start:540},{count:[1],max:50,rate:1e3,start:600},{count:[1],max:75,rate:750,start:660},{count:[1],max:100,rate:500,start:720}]},stats:{attackSpeed:200,damage:5,health:50,level:3,moveSpeed:fr,range:250},TEXTURE_KEY:"tnt"}];for(const Fa of ea){let e={};for(const t of Fa.metadata.spawn)e.end=t.start,e=t}const ta=structuredClone(ea[0]),sa={...ta,loot:{...ta.loot,loot:1,void:1,xp:1},metadata:{...ta.metadata,spawn:[{count:[1],max:1,rate:1e3,start:0}]}};class ia{constructor(e,t){K(this,"firstEnemySpawned",!1),K(this,"groups",new Map),K(this,"elapsed",0),this.scene=e,this.player=t;for(const s of ea)this.groups.set(s.TEXTURE_KEY,new Qr(this,structuredClone(s)));this.groups.set("first",new Qr(this,sa)),this.elapsed=0}spawn(e,t){const s=this.groups.get(e);null==s||s.spawn(t,this.player)}update(e,t){if(this.elapsed+=t,!1===this.player.visible)return;const s=Math.floor(this.elapsed/1e3);for(const[i,n]of this.groups){n.preUpdate(e,t);const{info:{metadata:r}}=n,{spawn:a}=r,o=a.find(e=>s>e.start&&(void 0===e.end||s<e.end));if(o&&("first"!==i||!this.firstEnemySpawned)&&r.lastSpawn+o.rate<this.elapsed){const e=o.max-n.countActive(),t=Math.trunc(Math.random()*o.count.length),s=o.count[t]??1,a=Math.min(e,s);n.spawn(a,this.player),r.lastSpawn=this.elapsed,"first"===i&&(this.firstEnemySpawned=!0)}}}}var na=Object.defineProperty,ra=Object.getOwnPropertyDescriptor;class aa extends mr{constructor(){super({key:Cn,plugins:[...Phaser.Plugins.DefaultPlugins.DefaultScene,$a.key]}),K(this,"active",!0),K(this,"enemyManager1"),K(this,"enemyManager2"),K(this,"displayTimeTime",0),K(this,"enemyCollider"),K(this,"p1Collider"),K(this,"p2Collider"),X(this,E),X(this,A),X(this,C)}get damageText(){return L(this,E)||(L(this,E)??Y(this,E,this.add.group({active:!0,classType:Phaser.GameObjects.Text,createCallback:e=>{this.layers.ui.add(e),e instanceof Phaser.GameObjects.Text&&(e.setStyle(Zn),this.time.delayedCall(250,()=>{e.destroy()}))},createMultipleCallback:null,defaultFrame:null,defaultKey:null,maxSize:200,removeCallback:null,runChildUpdate:!1}))),L(this,E)}get displayTime(){return L(this,A)??Y(this,A,this.add.bitmapText(this.scale.width/2,200,"MarcellusSCBitmap","").setFontSize(40).setScrollFactor(0)),L(this,A)}get enemies(){return L(this,C)||console.log("recreate enemies"),L(this,C)??Y(this,C,this.physics.add.group()),L(this,C)}get lootManager(){if(!(Ea.mapping in this))throw new Error("this.load.scenePlugin(LootManager.mapping, LootManager) required in preload()");const e=this[Ea.mapping];if(!(e instanceof Ea))throw new Error;return e}create(){console.log(this.enemies,this.player2,this.player1),console.log(this.physics.world.colliders),this.enemyCollider=this.physics.add.collider(this.enemies,this.enemies),console.log(this.enemyCollider),this.p1Collider=this.physics.add.collider(this.enemies,this.player1,(e,t)=>{t instanceof Jr&&(t.applyDamage="player1")}),console.log(this.p1Collider),this.p2Collider=this.physics.add.collider(this.enemies,this.player2,(e,t)=>{t instanceof Jr&&this.player2.visible&&(t.applyDamage="player2")}),console.log(this.p2Collider),this.enemyManager1=new ia(this,this.player1),this.enemyManager2=new ia(this,this.player2),this.events.once(Phaser.Scenes.Events.SHUTDOWN,()=>{this.shutdown()},this),console.log(this.enemyManager1,this.enemyManager2),console.log(this.physics.world.colliders._toProcess),console.log(this.physics.world.colliders._events),console.log(this.physics.world.colliders._active.length),this.physics.world.colliders.getActive().forEach(e=>{console.log(e)}),this.time.addEvent({callback:()=>{this.physics.world.colliders.getActive().forEach(e=>{console.log(e),e.object1&&e.object2||console.warn(" Collider with missing object:",e)}),this.debugging&&(console.log("Enemies:",this.enemies.countActive(),this.enemies.countActive(!1)),console.log(this.enemies.getChildren().map(e=>({bodyPos:e.body&&{x:e.body.x,y:e.body.y},hasBody:!!e.body,name:e.name,worldPos:{x:e.x,y:e.y}}))),this.enemies.children.entries.forEach(e=>{e.body||console.warn("Enemy missing body:",e)}),console.log("Colliders active:",this.physics.world.colliders))},delay:5e3,loop:!0}),console.log("done create")}preload(){this.load.scenePlugin(Ea.mapping,Ea)}shutdown(){var e,t;super.shutdown(),null==(e=L(this,A))||e.destroy(),Y(this,A,void 0),null==(t=L(this,E))||t.destroy(),Y(this,E,void 0),this.displayTimeTime=0}update(e,t){var s,i;this.active&&(this.player1.update(e,t),this.player2.update(e,t),this.player1.active_weapon?(null==(s=this.enemyManager1)||s.update(e,t),this.player2.visible&&(null==(i=this.enemyManager2)||i.update(e,t)),this.displayTimeTime+=t,this.displayTime.setText(`${Math.round(this.displayTimeTime/1e3)}`)):0===this.drops.countActive(!0)?this.config.save({lastPlayed:Date.now()}):this.config.load().lastPlayed)}}E=new WeakMap,A=new WeakMap,C=new WeakMap,K(aa,"key",""),((e,t,s)=>{for(var i,n=ra(t,s),r=e.length-1;r>=0;r--)(i=e[r])&&(n=i(t,s,n)||n);n&&na(t,s,n)})([ae()],aa.prototype,"update");class oa extends Phaser.Scene{constructor(){super({key:On,plugins:Phaser.Plugins.DefaultPlugins.DefaultScene}),X(this,O)}create(){performance.now();this.createPlayerAnimations(),this.createIncrementalAnimations(),this.createEnemyAnimations(),this.createEffectsAnimations();performance.now();this.scene.stop()}preload(){}createEffectsAnimations(){this.anims.create({frameRate:60,frames:this.anims.generateFrameNumbers("portal-particles",{end:59,start:0}),key:"portal-start",repeat:0}),this.anims.create({frameRate:60,frames:this.anims.generateFrameNumbers("portal-particles",{start:60}),key:"portal-enabled",repeat:-1}),this.anims.create({frameRate:60,frames:this.anims.generateFrameNumbers("portal",{end:0,start:0}),key:"portal",repeat:0})}createEnemyAnimations(){const e=this.anims;for(const{animations:t,key:s}of rr)for(const e of t){const{frameRate:t,repeat:i,yoyo:n}=e;this.anims.create({delay:e.delay,frameRate:t,frames:this.anims.generateFrameNumbers(s,e.config),key:`${s}-${e.key}`,repeat:i,repeatDelay:e.repeatDelay,yoyo:n})}for(const t of ea)for(const{config:s,key:i}of Object.values(t.FRAMES))e.exists(i)||e.create({frameRate:t.frameRate,frames:e.generateFrameNumbers(t.TEXTURE_KEY,s),key:i,repeat:-1})}createIncrementalAnimations(){this.anims.create({frameRate:8,frames:this.anims.generateFrameNumbers("drone",{frames:[4,5]}),key:"move",repeat:-1}),this.anims.create({frameRate:4,frames:this.anims.generateFrameNumbers("drone",{frames:[0,2]}),key:"idle",repeat:-1}),this.anims.create({frameRate:4,frames:this.anims.generateFrameNumbers("drone",{frames:[1,3]}),key:"idle2",repeat:-1}),this.anims.create({frameRate:8,frames:this.anims.generateFrameNumbers("drone",{frames:[0,2]}),key:"mine",repeat:-1}),this.anims.create({frameRate:8,frames:this.anims.generateFrameNumbers("drone",{frames:[8,9]}),key:"deliver",repeat:-1})}createPlayerAnimations(){const e=this.anims;q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("blue_archer_idle",{end:5,start:0}),key:"blue_archer_idle",repeat:-1}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("blue_archer_run",{end:3,start:0}),key:"blue_archer_run",repeat:-1}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("blue_archer_shoot",{end:7,start:0}),key:"blue_archer_attack1",repeat:0}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("blue_archer_shoot",{end:7,start:0}),key:"blue_archer_attack2",repeat:0}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("blue_warrior_idle",{end:7,start:0}),key:"blue_warrior_idle",repeat:-1}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("blue_warrior_run",{end:5,start:0}),key:"blue_warrior_run",repeat:-1}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("blue_warrior_attack1",{end:3,start:0}),key:"blue_warrior_attack1",repeat:0}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("blue_warrior_attack2",{end:3,start:0}),key:"blue_warrior_attack2",repeat:0}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("red_archer_idle",{end:5,start:0}),key:"red_archer_idle",repeat:-1}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("red_archer_run",{end:3,start:0}),key:"red_archer_run",repeat:-1}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("red_archer_shoot",{end:7,start:0}),key:"red_archer_attack1",repeat:-1}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("red_archer_shoot",{end:7,start:0}),key:"red_archer_attack2",repeat:-1}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("red_warrior_idle",{end:7,start:0}),key:"red_warrior_idle",repeat:-1}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("red_warrior_run",{end:5,start:0}),key:"red_warrior_run",repeat:-1}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("red_warrior_attack1",{end:3,start:0}),key:"red_warrior_attack1",repeat:-1}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("red_warrior_attack2",{end:3,start:0}),key:"red_warrior_attack2",repeat:-1}),q(this,O,R).call(this,{frameRate:1,frames:e.generateFrameNumbers("player1",{end:5,start:0}),key:"player1-idle",repeat:-1}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("player1",{end:11,start:6}),key:"player1-move",repeat:-1}),q(this,O,R).call(this,{frameRate:1,frames:e.generateFrameNumbers("player2",{end:5,start:0}),key:"player2-idle",repeat:-1}),q(this,O,R).call(this,{frameRate:10,frames:e.generateFrameNumbers("player2",{end:11,start:6}),key:"player2-move",repeat:-1})}}O=new WeakSet,R=function(e){if(void 0===e.key)return;const t=this.anims;t.exists(e.key)||t.create(e)};var ha=Object.defineProperty,ca=Object.getOwnPropertyDescriptor;class la extends Phaser.Scene{constructor(){super({key:"Boot",plugins:Phaser.Plugins.DefaultPlugins.DefaultScene}),K(this,"gameScene"),K(this,"sceneRunning",null),K(this,"sceneStopped",!0)}preload(){}create(){this.cameras.main.setBackgroundColor("#FFF000"),this.cameras.main.setBackgroundColor("#CDD7E1"),this.launchScene(Nn)}launchScene(e,t){this.scene.launch(e,t),this.gameScene=this.scene.get(e)}updateResize(e){e.scale.on("resize",this.resize,e);const t=e.scale.gameSize.width,s=e.scale.gameSize.height;e.parent=new Phaser.Structs.Size(t,s),e.sizer=new Phaser.Structs.Size(e.width,e.height,Phaser.Structs.Size.FIT,e.parent),e.parent.setSize(t,s),e.sizer.setSize(t,s),this.updateCamera(e)}resize(e){if(!this.sceneStopped){const t=e.width,s=e.height;this.parent.setSize(t,s),this.sizer.setSize(t,s);const i=this.cameras.main,n=this.sizer.width/this.game.screenBaseSize.width,r=this.sizer.height/this.game.screenBaseSize.height;i.setZoom(Math.max(n,r)),i.centerOn(this.game.screenBaseSize.width/2,this.game.screenBaseSize.height/2)}}updateCamera(e){const t=e.cameras.main,s=e.sizer.width/this.game.screenBaseSize.width,i=e.sizer.height/this.game.screenBaseSize.height;t.setZoom(Math.max(s,i)),t.centerOn(this.game.screenBaseSize.width/2,this.game.screenBaseSize.height/2)}update(e,t){}}((e,t,s)=>{for(var i,n=ca(t,s),r=e.length-1;r>=0;r--)(i=e[r])&&(n=i(t,s,n)||n);n&&ha(t,s,n)})([ae()],la.prototype,"update");class da extends Ln{constructor(e,t,s){super(e,s.x,s.y,"pickaxe"),K(this,"amount",0),K(this,"amountText"),K(this,"promptKey","building"),K(this,"prompts",[{kbm:{color:16711935,frame:"keyboard_e"},text:"manage drones",xbox:{color:16777215,frame:"xbox_button_color_x"}}]),K(this,"container"),K(this,"glow"),K(this,"interactionBox"),K(this,"new",!0),K(this,"newTween"),this.scene=e,this.resourceType=t,this.scene.add.existing(this),this.scene.physics.add.existing(this);const{height:i,width:n,x:r,y:a}=this.getBounds();this.interactionBox=new Phaser.Geom.Rectangle(r-20,a-20,n+40,i+40),this.setImmovable(!0).setScale(.5);const{centerX:o,top:h}=this.getBounds();this.amountText=this.scene.add.text(o,h-20,"",Zn).setOrigin(.5),this.container=new Wn(e,s),this.setInteractive(),this.enableNew()}onCancel(){}onInteract(e){this.container.visible?this.container.setVisible(!1):this.container.open(0,0,e)}onSelect(){}setButtons(e){this.container.setButtons(e)}update(e,t){this.container.update(e,t);for(const s of[this.scene.player1,this.scene.player2]){if(!s.visible)continue;const e=s.x,t=s.y;this.interactionBox.contains(e,t)&&s.inputProvider.setOnInteract(this)}}attention(){!1!==this.new&&(this.setRotation(Math.PI/32),this.scene.time.delayedCall(50,()=>{this.setRotation(0)}),Math.random()<.3&&(this.scene.time.delayedCall(100,()=>{this.setRotation(Math.PI/32)}),this.scene.time.delayedCall(150,()=>{this.setRotation(0)})),this.scene.time.delayedCall(1750+500*Math.random(),()=>{this.attention()}))}disableNew(){var e,t,s,i;this.new&&(this.new=!1,this.glow&&(null==(e=this.preFX)||e.remove(this.glow)),null==(t=this.preFX)||t.setPadding(16),this.glow=null==(s=this.preFX)?void 0:s.addGlow(16777215,100),null==(i=this.preFX)||i.addShadow(),this.newTween.stop())}enableNew(){var e,t,s;null==(e=this.preFX)||e.setPadding(32),null==(t=this.preFX)||t.addShadow(),this.glow=null==(s=this.preFX)?void 0:s.addGlow(16762624),this.newTween=this.scene.tweens.add({duration:1e3,ease:"sine.inout",loop:-1,outerStrength:100,targets:this.glow,yoyo:!0})}}class ua{constructor(e,t,s,i=1){var n;K(this,"resourceTarget"),K(this,"sprite"),K(this,"carrying",0),K(this,"debugText"),K(this,"distance",0),K(this,"level"),K(this,"miningElapsed",0),K(this,"miningTime",500),K(this,"resourceContainer"),K(this,"speed",100),K(this,"task","idle"),K(this,"travelElapsed",0),K(this,"travelTime",1e4),K(this,"xp"),K(this,"xpBase",1.2),K(this,"xpRequired"),this.scene=e,this.base=t,this.sprite=this.scene.physics.add.sprite(t.x,t.y,"").setOrigin(.5,.5).setScale(2),null==(n=this.sprite.body)||n.setSize(this.sprite.width/4,this.sprite.height/4,!0),this.sprite.setBounce(.25),this.resourceContainer=s,this.level=i,this.xp=this.xpBase**i,this.xpRequired=this.xpBase**(i+1),this.resourceTarget=void 0,this.debugText=this.scene.add.text(this.sprite.x,this.sprite.y,"",{align:"center",color:"#ffffff",fontFamily:"Arial Black",fontSize:20,stroke:"#000000",strokeThickness:4}),this.sprite.play("idle")}assignResource(e){if(this.resourceTarget=e,e){const t=this.base.x-e.x,s=this.base.y-e.y;this.distance=Math.sqrt(t*t+s*s)}}moveTo(e,t,s){const i=e-this.sprite.x,n=t-this.sprite.y,r=Math.sqrt(i*i+n*n),a=this.travelTime-this.travelElapsed;if(r>10){let e=r/a*1e3;e=Math.max(e,100);const t=Math.atan2(n,i),s=Math.cos(t)*e,o=Math.sin(t)*e;this.sprite.flipX=s<0,this.sprite.body instanceof Phaser.Physics.Arcade.Body&&(this.sprite.body.velocity.x/s<.1||this.sprite.body.velocity.y/o<.1)&&this.sprite.setVelocity(s,o)}else this.sprite.setVelocity(0,0);this.travelElapsed+=s}moveToPosition(e,t,s){const i=e-this.sprite.x,n=t-this.sprite.y,r=Math.sqrt(i*i+n*n),a=this.travelTime-this.travelElapsed;if(r>1){let e=r/a*1e3;e=Math.max(e,100);const t=Math.atan2(n,i),o=Math.cos(t)*e*(s/1e3),h=Math.sin(t)*e*(s/1e3);this.sprite.flipX=o<0,this.sprite.x+=o,this.sprite.y+=h,this.sprite.setVelocity(e,e)}}reached(e){const t=e.x-this.sprite.x,s=e.y-this.sprite.y;return t*t+s*s<100}update(e,t){switch(this.task){case"move":if(void 0===this.resourceTarget){this.task="deliver",this.sprite.play("deliver");break}this.moveTo(this.resourceTarget.x,this.resourceTarget.y,t),this.reached(this.resourceTarget)&&(this.task="mine",this.sprite.play("mine"),this.travelElapsed=0,this.miningElapsed=0);break;case"mine":if(void 0===this.resourceTarget){this.task="deliver",this.sprite.play("deliver");break}if(!this.reached(this.resourceTarget)){this.task="move",this.sprite.play("move");break}if(this.miningElapsed+=t,this.miningElapsed>=this.miningTime){if(this.carrying+=this.resourceTarget.mine(this.level-this.carrying),this.carrying<this.level)return this.resourceTarget=void 0,this.task="move",void this.sprite.play("move");this.task="deliver",this.sprite.play("move")}break;case"celebrate":if("deliver"===this.sprite.anims.getName())break;this.handleXp(),this.sprite.play("deliver"),setTimeout(()=>{this.task="move",this.sprite.play("move")},250);break;case"deliver":if(this.moveTo(this.base.x,this.base.y,t),this.reached(this.base)){if(this.resourceContainer.addResource(this.carrying),this.carrying=0,this.travelElapsed=0,void 0===this.resourceTarget){this.task="idle",this.sprite.play("idle");break}this.task="celebrate"}break;case"idle":void 0!==this.resourceTarget&&(this.task="move",this.sprite.play("move"))}}handleXp(){this.xp+=this.level,this.xp>=this.xpRequired&&(this.level+=1,this.xpRequired=this.xpBase**(this.level+1),this.travelTime=Math.max(Math.trunc(.9*this.travelTime),500),this.miningTime=Math.max(Math.trunc(.9*this.miningTime),100))}}class pa extends Phaser.Physics.Arcade.Image{constructor(e,t,s,i,n=1e3){const r=["00","16","32","48","64"],a=`${t}${r[Math.floor(Math.random()*r.length)]??"00"}`;super(e,s.x,s.y,"ores",a),K(this,"text"),this.scene=e,this.resourceType=t,this.position=s,this.size=i,this.amountLeft=n;const o=this.size/this.width;this.setScale(o),this.scene.physics.add.existing(this),this.text=this.scene.add.text(this.position.x,this.position.y,`${this.amountLeft}`,{fontSize:40}).setOrigin(.5,2),e.add.existing(this)}mine(e){const t=Math.min(e,this.amountLeft);return this.amountLeft-=t,this.text.setText(`${this.amountLeft}`),t}}class ma extends Phaser.GameObjects.Text{constructor(e,t,s,i,n){super(e,t,s,i,n),K(this,"tween"),this.setVisible(!1),this.setAlpha(0)}}class fa{constructor(e,t,s){K(this,"amount",0),K(this,"amountVoidGems"),K(this,"baseCost",10),K(this,"building"),K(this,"costExponent",1.05),K(this,"costMultiplier",1.2),K(this,"droneGroup"),K(this,"drones",[]),K(this,"nodes"),K(this,"notificationText"),K(this,"resourceNodes",[]),K(this,"resourceSize",64),this.scene=e,this.type=t,this.probeBody=s,this.nodes=this.scene.physics.add.group(this.resourceNodes),this.droneGroup=this.scene.physics.add.group();const{inventory:i}=this.scene.config.load();this.amountVoidGems=i.voidGems;const n=this.scene.add.rectangle(0,0,this.scene.scale.baseSize.width,this.scene.scale.baseSize.height,255,255).setInteractive().on("pointerdown",e=>{if(!(e instanceof Phaser.Input.Pointer))throw new ne;e.rightButtonDown()&&this.createNode(e)}).setOrigin(0);for(this.scene.layers.game.add(n),this.building=new da(this.scene,this.type,{x:1920,y:2e3}),this.building.setButtons([{onClick:()=>{this.createDrone()},text:`Spawn Drone\n(${this.amountVoidGems}/${this.cost})`,tooltip:"1"},{onClick:()=>{},text:"I'm a button",tooltip:"1"},{onClick:()=>{},text:"I'm also a button",tooltip:"1"}]),this.notificationText=this.scene.add.group({maxSize:15});15!==this.notificationText.children.size;){const e=new ma(this.scene,this.building.x,this.building.y,"+1",{align:"center",color:ga[this.type].toString(16),fontSize:40,strokeThickness:8});e.tween=this.scene.tweens.add({alpha:[1,.95,.9,.85,.8,.75,.7,.6,.5,0],duration:500,paused:!0,persist:!0,targets:e,x:{from:this.building.x,to:this.building.x+50},y:{from:this.building.y-50,to:this.building.y-150}}),this.notificationText.add(e,!0)}this.createNode({x:this.scene.scale.baseSize.width*(3/4),y:this.scene.scale.baseSize.height*(3/4)})}get cost(){const e=this.droneGroup.countActive(),t=this.costMultiplier*e,s=this.costExponent**e-1;return Math.trunc(this.baseCost*(t+s))}addResource(e){var t;this.amount+=e;const s=this.notificationText.getMatching("alpha",0),i=s[Math.trunc(s.length*Math.random())];let n;i instanceof ma&&(n=i,n.text=`+${e}`,n.setVisible(!0),null==(t=n.tween)||t.restart())}consumeResource(e){return this.amount>=e&&(this.amount-=e,!0)}createDrone(){if(this.amountVoidGems<this.cost)return;const e=new ua(this.scene,this.building,this,1);this.amountVoidGems-=this.cost,this.drones.push(e),this.droneGroup.add(e.sprite),this.building.setButtons([{onClick:()=>{this.createDrone()},text:`Spawn Drone\n(${this.amountVoidGems}/${this.cost})`,tooltip:"1"},{onClick:()=>{alert("button")},text:"I'm a button",tooltip:"1"},{onClick:()=>{alert("also a button")},text:"I'm also a button",tooltip:"1"}])}createNode(e){var t;e??(e={x:600,y:200}),this.probeBody.setEnable(!0).reset(e.x,e.y);const s=this.scene.physics.overlap(this.probeBody,this.nodes);if(this.probeBody.setEnable(!1),s)return;const i=new pa(this.scene,this.type,e,this.resourceSize);return this.resourceNodes.push(i),null==(t=this.scene.ResourceLayer)||t.add(i),this.nodes.add(i),i}update(e,t){var s;for(const i of this.drones){if(0===(null==(s=i.resourceTarget)?void 0:s.amountLeft)&&(i.resourceTarget.text.destroy(),this.nodes.remove(i.resourceTarget,!0,!0),i.assignResource(void 0)),!i.resourceTarget){const e=this.scene.physics.closest({x:i.sprite.x,y:i.sprite.y},this.nodes.getChildren());e&&e instanceof pa&&i.assignResource(e)}i.update(e,t)}this.building.update(e,t),this.building.amountText.setText(`${this.amount}`)}}const ga={copper:13857085,gold:16634896,silver:14869218,stone:5855577};class ya{constructor(e){K(this,"probeBody"),K(this,"resources",new Map),this.scene=e,this.probeBody=this.scene.physics.add.body(0,0,0,0).setEnable(!1)}addResource(e,t){const s=this.resources.get(e);if(!s)throw new Error("meow");s.addResource(t)}consumeResource(e,t){const s=this.resources.get(e);if(!s)throw new Error("meow");return s.consumeResource(t)}createDrone(e){const t=this.resources.get(e);if(!t)throw new Error("meow");t.createDrone()}createNode(e){const t=this.resources.get(e);if(!t)throw new Error("meow");t.createNode()}initialize(e){const t=new fa(this.scene,e,this.probeBody);this.resources.set(e,t)}update(e,t){for(const[,s]of this.resources)s.update(e,t)}}class va{constructor(e){var t,s,i;K(this,"promptKey","portal"),K(this,"prompts",[{kbm:{color:16711935,frame:"keyboard_e"},text:"enter",xbox:{color:16777215,frame:"xbox_button_color_x"}}]),K(this,"ellipse"),K(this,"particles"),K(this,"portal"),this.scene=e;const n=e.scale.baseSize.width/2,r=e.scale.baseSize.height/4;this.portal=this.scene.add.sprite(n,r,"portal").setOrigin(.5),this.particles=this.scene.add.sprite(n,r,"portal-particles").setOrigin(.5).setZ(10),this.particles.play("portal-start"),this.particles.on("animationcomplete",e=>{if(!(e instanceof Phaser.Animations.Animation))throw new Error("not an animation?");"portal-start"===e.key&&this.particles.play("portal-enabled")});const{height:a,width:o,x:h,y:c}=this.portal;if(this.ellipse=new Phaser.Geom.Ellipse(h,c,o-20,a-20),!0===this.scene.physics.config.debug){const e=this.scene.add.ellipse(h,c,o-20,a-20,15790320);null==(t=this.scene.ResourceLayer)||t.add(e)}null==(s=this.scene.ResourceLayer)||s.add(this.portal),null==(i=this.scene.ResourceLayer)||i.add(this.particles)}onCancel(){}onInteract(){this.scene.scene.start(Cn),Ir.instance&&(Ir.instance.activeScene=Cn)}onSelect(){}update(){for(const e of[this.scene.player1,this.scene.player2]){if(!e)continue;const t=e.x,s=e.y;Phaser.Geom.Ellipse.Contains(this.ellipse,t,s)&&e.inputProvider.setOnInteract(this)}}}const ba=[5,10,25,50,100,250,500,1e3];class wa extends Ln{constructor(e,t,s){super(e,t.x,t.y,"drops",s),K(this,"amount",0),K(this,"amountText"),K(this,"player"),K(this,"promptKey"),K(this,"prompts",[{kbm:{color:16711935,frame:"keyboard_q"},text:"refund",xbox:{color:16777215,frame:"xbox_button_color_b"}},{kbm:{color:16711935,frame:"keyboard_e"},text:"upgrade",xbox:{color:16777215,frame:"xbox_button_color_x"}}]),K(this,"scene"),K(this,"upgrade"),K(this,"cost"),K(this,"refund"),X(this,$),this.scene=e,this.upgrade=s,this.promptKey=s,this.scene.buildings.add(this),this.scene.add.existing(this),this.setImmovable(!0);const{centerX:i,top:n}=this.getBounds();this.amountText=this.scene.add.text(i,n-20,"",Zn).setOrigin(.5)}get hitboxes(){return L(this,$)??Y(this,$,{overlap:this.scene.physics.add.body(this.x,this.y).setCircle(this.width)}),L(this,$)}destroy(){console.log("destroyed")}onCancel(e){const{inventory:t,upgrades:s}=this.scene.config.load(),i=ba[s[this.upgrade].level-1];let{voidGems:n}=t.player,{bonus:r,level:a}=s[this.upgrade];if(void 0!==i&&a>0){n+=i,e.inventory.voidGems+=i,a--,r-=.05;for(let t=0;t<i;t++)if(this.scene.loot){const t=.5+.5*Math.random(),s=e.getTargetCurve(256).getPoint(t).add(this).add({x:t,y:t}),i=this.scene.loot.spawn(!0,this.x,this.y,"","void-gem");i&&(i.moveTo(s,()=>{i.moveTo(e,()=>{i.setVisible(!1),i.setActive(!1),i.body&&(i.body.checkCollision.none=!0)})}),i.body&&(i.body.checkCollision.none=!1))}}this.scene.config.save({inventory:{...t,player:{...t.player,voidGems:n}},upgrades:{...s,[this.upgrade]:{bonus:r,level:a}}}),e.inputProvider.removeAllInteract(),e.inputProvider.refreshPrompt(this)}onInteract(e){const{inventory:t,upgrades:s}=this.scene.config.load(),i=ba[s[this.upgrade].level];let{voidGems:n}=t.player,{bonus:r,level:a}=s[this.upgrade];if(void 0!==i&&n>=i){n-=i,e.inventory.voidGems-=i,a++,r+=.05;for(let t=0;t<i;t++)if(this.scene.loot){const t=.5+.5*Math.random(),s=e.getTargetCurve(64).getPoint(t).add(e),i=this.scene.loot.spawn(!0,s.x,s.y,"","void-gem");if(i){const s=e.getTargetCurve(256).getPoint(t).add(e).add({x:t,y:t});i.moveTo(s,()=>{i.moveTo(this,()=>{i.setVisible(!1),i.setActive(!1),i.body&&(i.body.checkCollision.none=!0)})}),i.body&&(i.body.checkCollision.none=!1)}}}console.log(this.upgrade,{bonus:r,level:a}),this.scene.config.save({inventory:{...t,player:{...t.player,voidGems:n}},upgrades:{...s,[this.upgrade]:{bonus:r,level:a}}})}onSelect(){}refreshCosts(){const{upgrades:e}=this.scene.config.load(),t=ba[e[this.upgrade].level],s=ba[e[this.upgrade].level-1];if(t!==this.cost||s!==this.refund){if(this.cost=t,this.refund=s,void 0===t&&void 0!==s)this.prompts=[{kbm:{color:16711935,frame:"keyboard_q"},text:`refund (${s} gems)`,xbox:{color:16777215,frame:"xbox_button_color_b"}}];else if(void 0!==t&&void 0===s)this.prompts=[{kbm:{color:16711935,frame:"keyboard_e"},text:`upgrade ${this.upgrade} (${t} gems)`,xbox:{color:16777215,frame:"xbox_button_color_x"}}];else{if(void 0===t||void 0===s)throw new Error;this.prompts=[{kbm:{color:16711935,frame:"keyboard_q"},text:`refund (${s} gems)`,xbox:{color:16777215,frame:"xbox_button_color_b"}},{kbm:{color:16711935,frame:"keyboard_e"},text:`upgrade  ${this.upgrade} (${t} gems)`,xbox:{color:16777215,frame:"xbox_button_color_x"}}]}this.scene.player1.inputProvider.refreshPrompt(this),this.scene.player2.inputProvider.refreshPrompt(this)}}update(e,t){this.refreshCosts()}}$=new WeakMap,D=new WeakMap,N=new WeakMap;const xa=pn({bonus:en(),level:en()}),ka=new gn({type:"record",keyType:vn(Wr),valueType:xa,...Te(undefined)});const _a=pn({base:pn({voidGems:en()}),player:pn({plants:dn(Ci()),voidGems:en()})}),Pa=pn({difficulty:en(),email:Ci().optional(),inventory:_a,lastPlayed:en(),music:rn(),soundEffects:rn(),time:en(),upgrades:ka}),Sa={difficulty:1,inventory:{base:{voidGems:0},player:{plants:[],voidGems:0}},lastPlayed:0,music:!0,soundEffects:!0,time:0,upgrades:{agility:{bonus:0,level:0},charisma:{bonus:0,level:0},critchance:{bonus:0,level:0},endurance:{bonus:0,level:0},speed:{bonus:0,level:0},strength:{bonus:0,level:0}}},za=class e extends Phaser.Plugins.BasePlugin{constructor(e){super(e),this.pluginManager=e}load(){const t=localStorage.getItem(e.key);if(null===t)return Sa;try{return Pa.parse(JSON.parse(t))}catch(s){return Sa}}save(t){const s=this.load(),i=se(s,t),n=JSON.stringify(i);return localStorage.setItem(e.key,n),JSON.stringify(this.load())===JSON.stringify(i)}saveInventory(t){const s=this.load(),i=s.inventory,n={...s,inventory:{...i,...t}},r=JSON.stringify(n);return localStorage.setItem(e.key,r),JSON.stringify(this.load())===JSON.stringify(n)}};K(za,"key","ConfigManager"),K(za,"mapping","_config");let Ia=za;const Ma={key:Ia.key,mapping:Ia.mapping,plugin:Ia,start:!0};var Ta=(e=>(e.VoidDrop="void-gem",e.StatDrop="stat-drop",e.SwordPickup="sword-pickup",e.ArrowPickup="arrow-pickup",e))(Ta||{});class Ea extends Phaser.Plugins.ScenePlugin{constructor(e,t,s){if(super(e,t,s),X(this,V),K(this,"scene"),X(this,j),X(this,F),X(this,G),X(this,W),!(e instanceof aa)){if("Scene2"===e.constructor.name)throw new Error("what is 'Scene2'");throw new Error}this.scene=e}get lootGemGroup(){return L(this,j)||(Y(this,j,new Br({handleCollision:(e,t)=>{let s=125,i=Math.sqrt(62500-s**2);s*=2,i/=2;const n=[...Wr].sort(()=>Math.random()-.5).slice(0,3),r=[{x:e.x,y:e.y-i},{x:e.x+s,y:e.y},{x:e.x-s,y:e.y}],a=n.map((e,t)=>{if(!r[t])throw new Error;return{frame:e,type:e,...r[t]}});this.statUpgrade.spawnGroup(a,t.owner).forEach(e=>{var t,s;e.alpha=.5;let i=16777215,n=16777215;0===(null==(t=e.owner)?void 0:t.num)&&(i=255),1===(null==(s=e.owner)?void 0:s.num)&&(n=16711680),e.setTint(i,n,16777215,16777215)}),t.destroy()},handleInteraction:void 0,keys:{play:"stat-drop-float",sprite:"stat-drop"},metadata:{maxSize:3,scale:1},scene:this.scene})),L(this,j).getSiblingUsed=()=>this.statUpgrade.size/3),L(this,j)}get statUpgrade(){return L(this,F)??Y(this,F,new Br({handleCollision:(e,t)=>{void 0!==t.owner&&t.owner!==e||(e.lootMenu.link(t),e.lootMenu.text=((e,t,s)=>"strength"===t?`+${5*s}% attack\n(current: ${e.stats.attack.toFixed(2)})`:"agility"===t?`+${5*s}% attack speed\n(current: ${e.stats.attackspeed.toFixed(2)})`:"charisma"===t?`+${20*s} health\n(current: ${e.health.max.toFixed(0)})`:"critchance"===t?"crit chance + 1%\n(for now increases magnet)":"endurance"===t?`${.2*s} regen\n(current: ${e.stats.regen.toFixed(1)})`:"speed"===t?`+${10*s}% movespeed\n(max is 100%)\n(current: ${e.stats.speed.toFixed(2)})`:"N/A")(e,t.type,t.rarity),e.inputProvider.setOnInteract(t))},handleInteraction:(e,t)=>{gr(e,t.type,t.rarity),e.inputProvider.removeAllInteract(),t.destroy(!0),e.lootMenu.clear()},keys:{play:"",sprite:"drops"},metadata:{maxSize:9,scale:.5},scene:this.scene})),L(this,F)}get voidGemGroup(){return L(this,G)??Y(this,G,new Br({handleCollision:(e,t)=>{e.inventory.voidGems+=1,t.destroy()},handleInteraction:void 0,keys:{play:"void-gem-float",sprite:"void-gem"},metadata:{maxSize:100,scale:.5},scene:this.scene})),L(this,G)}get weaponPickup(){return L(this,W)??Y(this,W,new Br({handleCollision:(e,t)=>{void 0!==t.owner&&t.owner!==e||(e.lootMenu.link(t),e.lootMenu.text=t.type.slice(0,t.type.indexOf("-")),e.inputProvider.setOnInteract(t))},handleInteraction:(e,t)=>{const s=t.type.slice(0,t.type.indexOf("-")).toLowerCase();e.active_weapon="sword"===s||"arrow"===s?s:"arrow",e.inputProvider.removeAllInteract(),t.destroy(!0),e.lootMenu.clear()},keys:{play:"sword-pickup-float",sprite:"weapon-pickup"},metadata:{maxSize:9,scale:1},scene:this.scene})),L(this,W)}spawn(e,t){const s={curr:0},i={curr:0};for(const n of t){const t=e.x+10*s.curr,r=e.y+10*i.curr;q(this,V,Z).call(this,t,r,n.type,n.owner),i.curr<s.curr?i.curr+=2:s.curr+=2}}}j=new WeakMap,F=new WeakMap,G=new WeakMap,W=new WeakMap,V=new WeakSet,Z=function(e,t,s,i){switch(s){case Ta.VoidDrop:this.voidGemGroup.spawnGroup([{frame:"",type:"void-gem",x:e,y:t}],i);break;case Ta.StatDrop:this.lootGemGroup.spawnGroup([{frame:"",type:"stat-drop",x:e,y:t}],i);break;case Ta.SwordPickup:1===(null==i?void 0:i.num)&&(t+=512),this.weaponPickup.spawnGroup([{frame:"",play:"sword-pickup-float",type:"sword-pickup",x:e-128,y:t},{frame:"",play:"arrow-pickup-float",type:"arrow-pickup",x:e+128,y:t}],i),this.weaponPickup.items.forEach(e=>e.alpha=.5)}},K(Ea,"key","LootManager"),K(Ea,"mapping","_lootManager");class Aa extends Phaser.Plugins.BasePlugin{constructor(e){super(e),K(this,"alive"),this.alive=!0}isAlive(){return this.alive}}K(Aa,"key","PlayerManager"),K(Aa,"mapping","_playerplugin");const Ca={key:Aa.key,mapping:Aa.mapping,plugin:Aa,start:!1},Oa=class e extends Phaser.Plugins.ScenePlugin{constructor(t,s,i){if(super(t,s,i),K(this,"_bounds"),this.scene=t,console.log("input plugin",t.constructor.name),"Scene2"===t.constructor.name)return;if(!(t instanceof dr))return;if(!e.config){const t=s.get(Ia.key);t instanceof Ia&&(e.config=t)}const n=t.input.keyboard;if(n){n.addKey(Phaser.Input.Keyboard.KeyCodes.H).on("up",(e,t)=>{if(!(e instanceof Phaser.Input.Keyboard.Key))throw new ne;if(!(t instanceof KeyboardEvent))throw new ne});const e=n.createCombo([Phaser.Input.Keyboard.KeyCodes.ALT,Phaser.Input.Keyboard.KeyCodes.H],{resetOnMatch:!0}),t=n.createCombo([Phaser.Input.Keyboard.KeyCodes.ALT,Phaser.Input.Keyboard.KeyCodes.K],{resetOnMatch:!0});n.addKey(Phaser.Input.Keyboard.KeyCodes.BACKTICK).on("up",(e,t)=>{if(!(e instanceof Phaser.Input.Keyboard.Key))throw new ne;if(!(t instanceof KeyboardEvent))throw new ne;if(t.altKey){const e=!this.scene.physics.world.drawDebug;if(console.log("toggling debug to",e),console.log(this.scene),!(this.scene instanceof dr))return;this.scene.debugging=e,e||this.scene.physics.world.debugGraphic.clear(),this.scene.physics.world.drawDebug=e}}),n.on("keycombomatch",(s,i)=>{if(!(s instanceof Phaser.Input.Keyboard.KeyCombo))throw new ne;if(!(i instanceof KeyboardEvent))throw new ne;s===e&&console.log(this.scene),s===t&&console.log("combo!")})}}static get alpha(){return e._alpha??(e._alpha=!1),e._alpha}updateMapping(){var t;null==(t=e.config)||t.save({time:performance.now()})}};K(Oa,"beta",!0),K(Oa,"config",null),K(Oa,"key","SceneInput"),K(Oa,"mapping","_inputPlugin"),K(Oa,"_alpha");let Ra=Oa;const $a={key:Ra.key,mapping:Ra.mapping,plugin:Ra,start:!1},Da=[la,ar,oa,aa,class extends mr{constructor(){super({key:Rn,plugins:[...Phaser.Plugins.DefaultPlugins.DefaultScene,$a.key]}),K(this,"GameLayer",null),X(this,D,!1),K(this,"loot"),K(this,"MenuLayer",null),K(this,"portal"),K(this,"portalEnabled",!1),K(this,"ResourceLayer",null),K(this,"shouldSpawn",!1),K(this,"UILayer",null),K(this,"inventory",{base:{voidGems:0},player:{plants:[],voidGems:0}}),K(this,"resourceManager"),X(this,N)}get upgradeBuilding(){if(!L(this,N)){const e={agility:void 0,charisma:void 0,critchance:void 0,endurance:void 0,speed:void 0,strength:void 0},t=this.player1.getTargetCurve(512);let s=0;for(const i of Wr){const n=t.getPoint(s).add(this.player1).add({x:0,y:-512}),r=new wa(this,n,i);s+=1/6,e[i]=r}Y(this,N,e)}return L(this,N)}create(){var e;this.ResourceLayer=this.add.layer(),this.GameLayer=this.add.layer(),this.UILayer=this.add.layer(),this.MenuLayer=this.add.layer(),null==(e=this.input.mouse)||e.disableContextMenu(),this.resourceManager=new ya(this);const{inventory:t}=this.config.load();this.inventory=t,this.loot=new Br({handleCollision:(e,t)=>{t.target=null},handleInteraction:void 0,keys:{play:"void-gem-float",sprite:"void-gem"},metadata:{maxSize:1048576,scale:.25},scene:this}),this.player1.body instanceof Phaser.Physics.Arcade.Body&&this.physics.add.collider(this.player1.body,this.drops),this.player2.body instanceof Phaser.Physics.Arcade.Body&&this.physics.add.collider(this.player2.body,this.drops),this.physics.add.collider(this.drops,this.drops),this.portal=new va(this),this.resourceManager.initialize("stone"),this.events.once(Phaser.Scenes.Events.SHUTDOWN,()=>{this.shutdown()},this)}shutdown(){if(L(this,N)){for(const[,e]of Object.entries(L(this,N)))null==e||e.destroy();Y(this,N,void 0)}super.shutdown()}update(e,t){var s,i,n;null==(s=this.resourceManager)||s.update(e,t),this.player1.update(e,t),this.player2.update(e,t),null==(i=this.portal)||i.update();for(const r of Wr)null==(n=this.upgradeBuilding[r])||n.update(e,t);this.runAfterInit(()=>{this.spawnGems()})}initialize(){L(this,D)||Y(this,D,!0)}runAfterInit(e){L(this,D)?e():this.initialize()}spawnGems(){var e,t;if(this.shouldSpawn){for(let e=0;e<this.inventory.player.voidGems/10;e++)if(this.loot&&this.loot.size<this.inventory.player.voidGems){const e=Math.random(),t=this.player1.getTargetCurve(64).getPoint(e).add(this.player1),s=this.loot.spawn(!0,t.x,t.y,"","void-gem");if(s){const t=this.player1.getTargetCurve(256).getPoint(e).add(this.player1).add({x:e,y:e});s.moveTo(t),s.body&&(s.body.checkCollision.none=!1)}}(null==(e=this.loot)?void 0:e.size)!==this.inventory.player.voidGems&&1024!==(null==(t=this.loot)?void 0:t.size)||(this.shouldSpawn=!1)}}},_r,Ir],Na=ee.Scale.FIT,ja={fps:{forceSetTimeOut:!0,limit:120},height:2160,input:{gamepad:!0},min:{height:480,width:720},parent:"game-container",physics:{arcade:{debug:!1,gravity:{x:0,y:0}},default:"arcade"},plugins:{global:[Ca,Ma],scene:[$a]},scale:{autoCenter:ee.Scale.CENTER_BOTH,mode:Na},scene:Da,type:ee.AUTO,width:3840};document.addEventListener("DOMContentLoaded",()=>{console.log("devicePixelRatio",window.devicePixelRatio),new ee.Game({...ja,parent:"game-container"})}),document.addEventListener("fullscreenchange",()=>{var e;"keyboard"in(e=navigator)&&null!==e.keyboard&&"object"==typeof e.keyboard&&"lock"in e.keyboard&&"function"==typeof e.keyboard.lock&&navigator.keyboard.lock(["Escape"])});
